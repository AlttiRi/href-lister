{"version":3,"file":"index.js","sources":["../src/core/settings.ts","../src/core/filters.ts","../src/core/url-parser.ts","../src/core/url-info-entry.ts","../src/core/core.ts","../src/core/util.ts","../src/components/InputControls.vue","../src/core/relative-time-trigger.ts","../src/components/UrlListItemTags.vue","../src/components/UrlListItem.vue","../src/components/MessageEditPopup.vue","../src/core/tags.ts","../src/components/tags/InputTags.vue","../src/components/tags/SelectedTags.vue","../src/components/UrlListItemTagsEditPopup.vue","../src/main.ts"],"sourcesContent":["export const defaultFilterSettings = {\n    input_only: \"\",\n    input_only_disabled: false,\n    input_ignore: \"\",\n    input_ignore_disabled: false,\n    reverse_input_only: false,\n    case_sensitive: false,\n}\n// export const defaultCommonSettings = {\n//     unique: true,\n//     sort: true,\n//     reverse: false,\n//     hide_prefix: true,\n//     https: true,\n// }\n//\n// export const defaultSettings = {\n//     ...defaultFilterSettings,\n//     ...defaultCommonSettings,\n// }\n","import {computed, ComputedRef, Ref, ref} from \"vue\";\nimport {defaultFilterSettings as settings} from \"./settings\";\n\n\nexport const input_only:   Ref<string> = ref(settings.input_only);\nexport const input_ignore: Ref<string> = ref(settings.input_ignore);\n\nconst matcher = computed(() => {\n    let onlyParts   =   input_only.value.trim().split(/\\s+/g).filter(o => o);\n    let ignoreParts = input_ignore.value.trim().split(/\\s+/g).filter(o => o);\n    if (!settings.case_sensitive) {\n        onlyParts   =   onlyParts.map(text => text.toLowerCase());\n        ignoreParts = ignoreParts.map(text => text.toLowerCase());\n    }\n\n    let matchOnly:   (url: string) => boolean;\n    let matchIgnore: (url: string) => boolean;\n    if (!settings.case_sensitive) {\n        matchOnly   = (url: string) =>   onlyParts.some(text => url.toLowerCase().includes(text));\n        matchIgnore = (url: string) => ignoreParts.some(text => url.toLowerCase().includes(text));\n    } else {\n        matchOnly   = (url: string) =>   onlyParts.some(text => url.includes(text));\n        matchIgnore = (url: string) => ignoreParts.some(text => url.includes(text));\n    }\n    return {matchOnly, matchIgnore, onlyParts, ignoreParts};\n});\n\ntype FilterPredicate = (url: string) => boolean;\nexport const urlFilter: ComputedRef<FilterPredicate> = computed(() => {\n    const {matchOnly, matchIgnore, onlyParts} = matcher.value;\n\n    if (!settings.input_only_disabled && onlyParts.length) {\n        if (!settings.reverse_input_only) {\n            return (url: string) => matchOnly(url);\n        } else {\n            return (url: string) => !matchOnly(url);\n        }\n    }\n    if (!settings.input_ignore_disabled) {\n        return (url: string) => !matchIgnore(url);\n    }\n\n    return (url: string) => Boolean(url);\n});\n","export type InputUrlEntry = {\n    url: string,\n    inputComment?: string,\n}\n\n// todo add tests\nexport function parseUrlEntries(text: string): InputUrlEntry[] {\n    const lines = text.split(\"\\n\").map(line => line.trim()).filter(line => line);\n    const urls: InputUrlEntry[] = [];\n    for (const line of lines) {\n        const [main, ...comments] = line.split(/\\s+(#|\\/\\/)/);\n        const [firstWord, ...words] = main.trim().split(/\\s+/);\n\n        if (firstWord.startsWith(\"http\")) {\n            const url = matchUrl(firstWord);\n            if (url && words.every(word => !matchUrl(word))) {\n                urls.push({\n                    url,\n                    inputComment: [...words, ...comments].join(\" \")\n                });\n                continue;\n            }\n            if (url) {\n                urls.push({url});\n            }\n        } else {\n            words.unshift(firstWord);\n        }\n\n        for (const word of words) {\n            const url = matchUrl(word);\n            if (url) {\n                urls.push({url});\n            }\n        }\n    }\n    return urls;\n}\n\nfunction matchUrl(word: string) {\n    const match = word.match(/(['\"]?)(?<url>https?:\\/\\/[^\\s\"]+)(\\1)/);\n    console.log(match);\n    if (match?.groups) {\n        return match.groups.url;\n    }\n}\n","import {createStore, del, get, set, entries} from \"idb-keyval\";\nimport {InputUrlEntry} from \"./url-parser\";\nimport {toRaw} from \"vue\";\n\n\nconst urlInfoStore = createStore(\"HrefListerUrlInfo\", \"UrlInfo\");\n\nexport type UrlInfoState = {\n    comment?: string,\n    visited?: number,\n    tags?: string[],\n}\n\nexport class UrlInfo {\n    static stateMap = new Map<string, UrlInfoState>();\n    private readonly state: UrlInfoState;\n    readonly url: string;\n    readonly inputComment?: string;\n    readonly initialVisited?: number;\n    constructor(url: string, state: UrlInfoState, inputComment?: string) {\n        this.url = url;\n        this.state = state;\n        if (inputComment) {\n            this.inputComment = inputComment;\n        }\n        if (state.visited) {\n            this.initialVisited = state.visited;\n        }\n    }\n    static async getInstance({url, inputComment}: InputUrlEntry): Promise<UrlInfo> {\n        let state = UrlInfo.stateMap.get(url);\n        if (state) {\n            return new UrlInfo(url, state, inputComment);\n        }\n        state = await get(url, urlInfoStore);\n        if (state === undefined) {\n            state = {};\n        }\n        UrlInfo.stateMap.set(url, state);\n        return new UrlInfo(url, state, inputComment);\n    }\n    get comment() { return this.state.comment; }\n    get visited() { return this.state.visited; }\n    get tags()    { return this.state.tags;    }\n    async setComment(comment: string) {\n        this.state.comment = comment;\n        await this.update();\n    }\n    async delComment() {\n        delete this.state.comment;\n        await this.update();\n    }\n    async setVisited(visited: number) {\n        this.state.visited = visited;\n        await this.update();\n    }\n    async delVisited() {\n        delete this.state.visited;\n        await this.update();\n    }\n    async addTag(tag: string) {\n        if (!this.state.tags) {\n            this.state.tags = [];\n        }\n        if (this.state.tags.includes(tag)) {\n            return;\n        }\n        this.state.tags.push(tag);\n        await this.update();\n    }\n    async delTag(tag: string) {\n        if (!this.state.tags) {\n            return;\n        }\n        const index = this.state.tags.indexOf(tag);\n        if (index == -1) {\n            return;\n        }\n        this.state.tags.splice(index, 1);\n        if (this.state.tags.length === 0) {\n            delete this.state.tags;\n        }\n        await this.update();\n    }\n    private update() {\n        if (!Object.keys(this.state).length) {\n            return del(this.url, urlInfoStore);\n        }\n        return set(this.url, toRaw(this.state), urlInfoStore);\n    }\n}\n\n\n// The old stores\nconst commentsStore = createStore(\"HrefListerComments\", \"Comments\");\nconst visitsStore = createStore(\"HrefLister\", \"Visits\");\nObject.assign(globalThis, {\n    idb: {\n        createStore, del, get, set, entries,\n        commentsStore, // await idb.entries(idb.commentsStore)\n        visitsStore,   // await idb.entries(idb.visitsStore)\n        urlInfoStore,  // await idb.get(\"http://localhost:5173/\")\n    },\n    UrlInfo,\n});\n\n","import {computed, ref, Ref, ComputedRef, watchEffect} from \"vue\";\nimport {urlFilter} from \"./filters\";\nimport {InputUrlEntry, parseUrlEntries} from \"./url-parser\";\nimport {UrlInfo} from \"./url-info-entry\";\n\n\nexport const NEVER_VISITED_TIME = -1;\n\nexport const inputText: Ref<string> = ref(\"\");\nexport const messagePopupEntry: Ref<UrlInfo | null> = ref(null);\nexport const tagsPopupEntry:    Ref<UrlInfo | null> = ref(null);\nexport const lastClickedEntry:  Ref<UrlInfo | null> = ref(null);\nexport const clickedUrls = ref(new Set<string>());\n\nexport const urlEntryList: Ref<UrlInfo[]> = ref([]);\nwatchEffect(async () => {\n    const urlEntries: InputUrlEntry[] = parseUrlEntries(inputText.value);\n    const urlInfos: UrlInfo[] = [];\n    for (const urlEntry of urlEntries) {\n        urlInfos.push(await UrlInfo.getInstance(urlEntry));\n    }\n    urlEntryList.value = urlInfos;\n});\n\nexport const urlEntryListFiltered: ComputedRef<UrlInfo[]> = computed(() => {\n    return urlEntryList.value.filter(ue => urlFilter.value(ue.url));\n});\n\nexport const urlsFiltered: ComputedRef<string[]> = computed(() => {\n    return urlEntryListFiltered.value.map(ue => ue.url);\n});\n\n\nif (location.href === \"http://localhost:5173/\") {\n    inputText.value =\n          \"http://localhost:5173/ asdf\\n\"\n        + \"http://localhost:5173/#qqq\\n\"\n        + \"http://localhost:5173/#qqq\\n\"\n        + \"http://localhost:5173/#www\\n\"\n     // + \"http://localhost:5173/#qwe #qwerty1qwerty2qwerty3qwerty4qwerty5qwerty6\\n\"\n}\n","export function throttle<A extends any[]>(runnable: (...args: A) => any, time = 50): (...args: A) => void {\n    let waiting = false;\n    let queued  = false;\n    let context: any;\n    let args: A;\n\n    function cb() {\n        if (queued) {\n            setTimeout(cb, time);\n            runnable.apply(context, args);\n        } else {\n            waiting = false;\n        }\n        queued = false;\n    }\n\n    return function(this: any, ...current_args: A) {\n        if (!waiting) {\n            waiting = true;\n            setTimeout(cb, time);\n            runnable.apply(this, current_args);\n        } else {\n            context = this;\n            args = current_args;\n            queued = true;\n        }\n    }\n}\n\nexport function getCodeArrays(items: string[], size = 100) {\n    const jsonArray = (a: string[]) => `${a.length ? \"[\\\"\" + a.join(`\", \"`) + \"\\\"]\" : \"[]\"}`;\n    if (items.length <= size) {\n        return `/* ${items.length.toString().padStart(3)} */ ${jsonArray(items)},`;\n    }\n    const len = (num: number) => num.toString().length;\n    const count = Math.trunc(items.length / size);\n    const comment = items.length.toString().padStart(1 + len(items.length)) + \" \".repeat(3 + len(count));\n    const parts = [`/* ${comment} */`];\n    for (let i = 0; i <= count; i++) {\n        const part = items.slice(size * i, size + size * i);\n        const page = `(${i + 1})`.padStart(2 + len(count));\n        const pageCount = part.length.toString().padStart(1 + len(items.length));\n        parts.push(`/* ${pageCount} ${page} */ ${jsonArray(part)},`);\n    }\n    return parts.join(\"\\n\");\n}\n\nexport function timeAgo(ms: number) {\n    const now = Date.now();\n    const secs = Math.trunc((now - ms) / 1000);\n    if (secs < 60) {\n        return `${secs} second${secs > 1 ? \"s\" : \"\"} ago`;\n    }\n\n    if (secs < 60 * 60) {\n        const m = Math.trunc(secs / 60);\n        return `${m} minute${m > 1 ? \"s\" : \"\"} ago`;\n    }\n    if (secs < 60 * 60 * 24) {\n        const m = Math.trunc(secs / 60 % 60).toString().padStart(2, \"0\");\n        const h = Math.trunc(secs / 60 / 60);\n        return `${h}:${m} ago`;\n    }\n    return Math.trunc(secs / 60 / 60 / 24) + \" days ago\";\n}\n\n","<template>\n  <div class=\"row row-cols-lg-3 g-3 align-items-end\">\n    <div class=\"input col-12\">\n      <label for=\"urls-textarea\" class=\"fuck-off-lighthouse\"></label>\n      <textarea id=\"urls-textarea\" spellcheck=\"false\"\n                v-model=\"inputText\"\n                ref=\"textareaEl\"\n      ></textarea>\n    </div>\n    <div class=\"input col-12\">\n      <span  class=\"row\">\n        <span class=\".col m-1\">\n          <span class=\"btn-group\">\n            <span class=\"input-group-text me-2\">Clipboard</span>\n          </span>\n          <button class=\"btn btn-outline-primary me-1\"\n                  @click=\"onReplaceClipboardText\"\n          >Replace</button>\n          <button class=\"btn btn-outline-primary me-1\"\n                  @click=\"onAppendClipboardText\"\n          >Append</button>\n        </span>\n        <span class=\".col m-1\">\n          <span class=\"btn-group\">\n            <span class=\"input-group-text me-2 text-center\">Controls</span>\n          </span>\n          <button class=\"btn btn-outline-primary me-1\"\n                  @click=\"onClearTextInput\"\n          >Clear</button>\n          <button class=\"btn btn-primary me-1\" title=\"Copy URLs\"\n                  @click=\"onCopyUrlsAsList\"\n                  @contextmenu=\"onCopyUrlsAsColumn\"\n                  @pointerdown=\"onCopyUrlsAsCodeArrays\"\n          >Copy</button>\n        </span>\n      </span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {Ref, ref} from \"vue\";\nimport {sleep} from \"@alttiri/util-js\";\nimport {inputText, urlsFiltered} from \"../core/core\";\nimport {getCodeArrays} from \"../core/util\";\n\n\nconst blinkButtonMap = new WeakMap();\nasync function blink(elem: HTMLElement) {\n  elem.classList.add(\"btn-active\");\n  const sleep_time = sleep(150);\n  blinkButtonMap.set(elem, sleep_time);\n  await sleep_time;\n  if (blinkButtonMap.get(elem) === sleep_time) {\n    elem.classList.remove(\"btn-active\");\n  }\n}\n\n\nconst textareaEl: Ref<HTMLTextAreaElement | null> = ref(null);\n\nfunction onClearTextInput(event: MouseEvent) {\n  inputText.value = \"\";\n  textareaEl.value?.focus();\n  void blink(event.currentTarget as HTMLElement);\n}\n\n\nfunction onCopyUrlsAsList(event: MouseEvent) {\n  void navigator.clipboard.writeText(urlsFiltered.value.join(\" \"));\n  void blink(event.currentTarget as HTMLElement);\n}\nfunction onCopyUrlsAsColumn(event: MouseEvent) {\n  event.preventDefault();\n  void navigator.clipboard.writeText(urlsFiltered.value.join(\"\\n\"));\n  void blink(event.currentTarget as HTMLElement);\n}\nfunction onCopyUrlsAsCodeArrays(event: PointerEvent) {\n  const MIDDLE_BUTTON = 1;\n  if (event.button === MIDDLE_BUTTON) {\n    event.preventDefault();\n    void navigator.clipboard.writeText(getCodeArrays(urlsFiltered.value));\n    void blink(event.currentTarget as HTMLElement);\n  }\n}\n\nasync function onAppendClipboardText(event: MouseEvent) {\n  const {currentTarget} = event;\n  const text = await navigator.clipboard.readText();\n  console.log(\"[clipboard] readText:\", text);\n  if (inputText.value && !inputText.value.endsWith(\"\\n\")) {\n    inputText.value += \"\\n\";\n  }\n  inputText.value += text;\n  void blink(currentTarget as HTMLElement);\n}\nasync function onReplaceClipboardText(event: MouseEvent) {\n  const {currentTarget} = event;\n  const text = await navigator.clipboard.readText();\n  console.log(\"[clipboard] readText:\", text);\n  inputText.value = text;\n  void blink(currentTarget as HTMLElement);\n}\n\n</script>\n\n\n<style scoped>\n.btn-group > .input-group-text {\n  width: 100px;\n  justify-content: center;\n}\n.btn-active,\n.btn-active:active {\n  background-color: black;\n  color: white;\n}\n\ntextarea {\n  width: 100%;\n  height: 82px;\n  resize: none;\n}\ntextarea:focus {\n  outline: none;\n}\n\n.fuck-off-lighthouse {\n  position: absolute;\n  top: -1000px;\n  left: -1000px;\n  height: 0;\n  width: 0;\n}\n</style>\n","import {onUnmounted, Ref, triggerRef, watch} from \"vue\";\n\nconst MINUTE = 1000 * 60;\nconst TEN_MINUTES = MINUTE * 10;\nconst HOUR = MINUTE * 60;\nconst DAY = HOUR * 24;\n\nexport class RefTriggerTimer {\n    private readonly timeRef: Ref<number>;\n    private timerId?: number;\n    constructor(timeRef: Ref<number>) {\n        this.timeRef = timeRef;\n        watch(timeRef,(value) => { // Ignores `triggerRef` in comparison with `watchEffect`, watches only direct `.value` changing\n            if (value > 0) {\n                this.setTimer();\n            }\n        });\n        onUnmounted(() => {\n            this.clearTimer()\n        });\n    }\n    setTimer() {\n        this.clearTimer();\n        const diff = Date.now() - this.timeRef.value;\n        let time: number;\n        if (diff < TEN_MINUTES) {\n            time = MINUTE;\n        } else if (diff < HOUR) {\n            time = TEN_MINUTES;\n        } else if (diff < DAY) {\n            time = HOUR;\n        } else {\n            return;\n        }\n        this.timerId = setTimeout(() => {\n            triggerRef(this.timeRef);\n            this.setTimer();\n        }, time);\n    }\n    clearTimer() {\n        clearTimeout(this.timerId);\n    }\n    forceTrigger() {\n        triggerRef(this.timeRef);\n        this.setTimer();\n    }\n}\n\n\n// import {Ref, watchEffect} from \"vue\";\n//\n// const less_minute_refs: Ref<number>[] = [];\n// const less_hour_refs: Ref<number>[] = [];\n// const less_day_refs: Ref<number>[] = [];\n// const other_refs: Ref<number>[] = [];\n// export function addTimeRef(timeRef: Ref<number>) {\n//     const now = Date.now();\n//     watchEffect(() => {\n//         if (timeRef.value > 0 && !refs.includes(timeRef)) {\n//             refs.push(timeRef);\n//         }\n//     });\n// }\n","<template>\n<div class=\"tags-wrapper\" @click=\"toggleTagsEditPopup\">\n    <div class=\"tags\">\n        <EntryTags :entry=\"ue\"/>\n    </div>\n    <div v-if=\"!ue.tags?.length\" class=\"tag add-tag\"><span class=\"plus\">+</span></div>\n</div>\n</template>\n\n<script setup lang=\"ts\">\nimport {toRaw} from \"vue\";\nimport {UrlInfo} from \"../core/url-info-entry\";\nimport {tagsPopupEntry} from \"../core/core\";\nimport EntryTags from \"./tags/EntryTags.vue\";\n\n\nconst props = defineProps<{ue: UrlInfo}>();\n\nfunction toggleTagsEditPopup() { // <.tags-wrapper> @click\n    if (toRaw(tagsPopupEntry.value) === toRaw(props.ue)) {\n        tagsPopupEntry.value = null;\n    } else {\n        tagsPopupEntry.value = props.ue;\n    }\n    console.log(tagsPopupEntry.value);\n}\n</script>\n\n<style scoped lang=\"scss\">\n.tags-wrapper {\n  position: absolute;\n  right: 0;\n  display: flex;\n  .plus {\n    display: inline-flex;\n    justify-content: center;\n  }\n}\n</style>\n","<template>\n  <tr @pointerenter=\"triggerVisitedMs\"\n      :class=\"{\n        'clicked': isClicked,\n        'last-clicked': isLastClicked,\n      }\"\n      class=\"list-item-row\"\n  >\n    <td class=\"col-9 nowrap-text-ceil url url-cell\">\n      <span class=\"nowrap-text-ceil-content\">\n        <span class=\"info-dot\"\n              :class=\"{\n                ['has-comment']: ue.inputComment,\n                visited: visitedMs > 0,\n                [timePassedClass]: true,\n              }\"\n              :title=\"visitedText\"\n              @contextmenu.prevent=\"unmarkUrlAsClicked\"\n              @pointerdown=\"removeVisitOnMMB\"\n        ></span>\n        <a class=\"url link-primary\" target=\"_blank\" rel=\"noreferrer noopener\"\n           :href=\"ue.url\"\n           :title=\"ue.inputComment\"\n           @click=\"markUrlAsClicked\"\n           @pointerup=\"markUrlAsClickedOnMMBClick\"\n        >{{ue.url}}</a>\n      </span>\n      <UrlListItemTags class=\"tags\" :ue=\"ue\"/>\n    </td>\n    <td class=\"col-3 comment nowrap-text-ceil\"\n        @dblclick=\"toggleMessageEditPopup\"\n        :class=\"{\n          [commentCssClass]: commentCssClass\n        }\"\n    >\n      <span class=\"comment-content nowrap-text-ceil-content no-dbl-click-select\">{{comment || \"&nbsp;\"}}</span>\n    </td>\n  </tr>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, toRaw, ComputedRef} from \"vue\";\nimport {formatDate} from \"@alttiri/util-js\";\nimport {clickedUrls, lastClickedEntry, NEVER_VISITED_TIME, messagePopupEntry} from \"../core/core\";\nimport {throttle, timeAgo} from \"../core/util\";\nimport {RefTriggerTimer} from \"../core/relative-time-trigger\";\nimport {UrlInfo} from \"../core/url-info-entry\";\nimport UrlListItemTags from \"./UrlListItemTags.vue\";\n\nconst props = defineProps<{ue: UrlInfo}>();\n\n\nconst visitedMs: ComputedRef<number> = computed(() => props.ue.visited || NEVER_VISITED_TIME);\n\nfunction removeUrlVisit() {\n  void props.ue.delVisited();\n}\n\nfunction visitUrl() {\n  const msNow = Date.now();\n  void props.ue.setVisited(msNow);\n}\n\nfunction removeVisitOnMMB(event: PointerEvent) { // <.info-dot> @pointerdown\n  const MIDDLE_BUTTON = 1;\n  if (event.button === MIDDLE_BUTTON) {\n    event.preventDefault();\n    removeUrlVisit();\n  }\n}\n\nconst commentCssClass = computed(() => {\n  if (props.ue.comment !== undefined) {\n    if (!props.ue.inputComment) {\n      return \"comment-from-store\";\n    }\n    if (props.ue.comment !== props.ue.inputComment) {\n      return \"comment-from-store-over\";\n    }\n  }\n  return \"\";\n});\n\nconst comment = computed(() => {\n  if (props.ue.comment !== undefined) {\n    return props.ue.comment.trim();\n  }\n  return props.ue.inputComment;\n});\n\n\nfunction toggleMessageEditPopup() { // <td> @dblclick\n  if (toRaw(messagePopupEntry.value) === toRaw(props.ue)) {\n    messagePopupEntry.value = null;\n  } else {\n    messagePopupEntry.value = props.ue;\n  }\n}\n\n\nconst isClicked = computed(() => {\n  return clickedUrls.value.has(props.ue.url);\n});\nfunction markUrlAsClicked() { // <a.url> @click\n  clickedUrls.value.add(props.ue.url);\n  visitUrl();\n  lastClickedEntry.value = toRaw(props.ue);\n}\nfunction markUrlAsClickedOnMMBClick(event: PointerEvent) { // <a.url> @pointerup\n  const MIDDLE_BUTTON = 1;\n  if (event.button !== MIDDLE_BUTTON) {\n    return;\n  }\n  const activeElement = (document.getRootNode() as Document).activeElement;\n  if (activeElement !== event.currentTarget) {\n    return;\n  }\n  markUrlAsClicked();\n}\nfunction unmarkUrlAsClicked() { // <.info-dot> @contextmenu.prevent\n  clickedUrls.value.delete(props.ue.url);\n}\nconst isLastClicked = computed(() => {\n  return toRaw(lastClickedEntry.value) === toRaw(props.ue);\n});\n\n\n\n// Recalculates `timePassedClass`, `visitedText` based on `visitedMs`\nconst refTrigger = new RefTriggerTimer(visitedMs);\nfunction recalculateComponentState() {\n  refTrigger.forceTrigger();\n}\nconst triggerVisitedMs = throttle(recalculateComponentState, 2000); // <tr> @pointerenter\n\nconst visitedText = computed(() => {\n  let text = \"\";\n  if (visitedMs.value < 0) {\n    text = \"never clicked\";\n  } else {\n    text = formatVisitedMs(visitedMs.value);\n  }\n  if (props.ue.initialVisited && props.ue.initialVisited !== visitedMs.value) {\n    return `${text}\\n${formatVisitedMs(props.ue.initialVisited)}`;\n  }\n  return text;\n});\nfunction formatVisitedMs(value: number) {\n  return timeAgo(value) + \" â€” \" + formatDate(value, \"YYYY.MM.DD HH:mm:SS\", false);\n}\n\nconst timePassedClass = computed(() => getTimePassedClass(visitedMs.value));\nfunction getTimePassedClass(ms: number) {\n  if (ms < 0) { return \"never-clicked\"; }\n  const now = Date.now();\n  const diff = Math.trunc((now - ms) / 1000);\n  if (diff < 60)       { return \"minute-1\";  }\n  if (diff < 60 *  2)  { return \"minute-2\";  }\n  if (diff < 60 *  5)  { return \"minute-5\";  }\n  if (diff < 60 * 10)  { return \"minute-10\"; }\n  if (diff < 60 * 30)  { return \"minute-30\"; }\n  if (diff < 60 * 45)  { return \"minute-45\"; }\n  if (diff < 60 * 60)  { return \"minute-60\"; }\n  if (diff < 3600 * 2)  { return \"hour-2\";  }\n  if (diff < 3600 * 4)  { return \"hour-4\";  }\n  if (diff < 3600 * 8)  { return \"hour-8\";  }\n  if (diff < 3600 * 14) { return \"hour-14\"; }\n  if (diff < 3600 * 24) { return \"day-1\";   }\n  if (diff < 86400 * 7) { return \"day-7\";   }\n  if (diff < 86400 * 30)  { return \"month-1\"; }\n  if (diff < 2592000 * 3) { return \"month-3\"; }\n  if (diff < 2592000 * 6) { return \"month-6\"; }\n  return \"long-ago\";\n}\n</script>\n\n<style scoped>\n.url-cell {\n  position: relative;\n}\ntd {\n  align-items: center;\n}\n\n.nowrap-text-ceil {\n  display: inline-flex;\n}\n.nowrap-text-ceil-content {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\na {\n  margin-left: 4px;\n  text-decoration: none;\n}\na:visited {\n  color: #6f42c1 !important;\n}\n.clicked {\n  background-color: #0000000a;\n}\n.clicked.last-clicked {\n  background-color: #0000000e;\n}\n.info-dot {\n  height: 16px;\n  width: 16px;\n  background-color: #0000000f;\n  margin-bottom: -3px;\n  display: inline-block;\n  border-radius: 8px;\n  border: 1px solid white;\n}\n/*.has-comment {*/\n/*  border: 1px solid gray;*/\n/*}*/\n.visited {\n  background-color: #dee2e6;\n}\n\n/*.never-clicked { background-color: #0000000f; }*/\n.minute-1  { background-color: #46c142; }\n.minute-2  { background-color: #6bc841; }\n.minute-5  { background-color: #88cf3f; }\n.minute-10 { background-color: #a3d53e; }\n.minute-30 { background-color: #bcdb3c; }\n.minute-45 { background-color: #d4e139; }\n.minute-60 { background-color: #ece737; }\n.hour-2  { background-color: #42c1b2; }\n.hour-4  { background-color: #4ba4b6; }\n.hour-8  { background-color: #4b88b9; }\n.hour-14 { background-color: #487abb; }\n.day-1   { background-color: #446cbc; }\n.day-7   { background-color: #5b5cb6; }\n.month-1 { background-color: #6a49b1; }\n.month-3 { background-color: #703fae; }\n.month-6 { background-color: #7633ab; }\n.long-ago { background-color: gray; }\n\ntr:hover {\n  box-shadow: 0 0 1px gray;\n}\n\n.no-dbl-click-select:active {\n  user-select: none;\n}\n\n.comment {\n  border-right: 2px solid transparent;\n}\n.comment-from-store {\n  border-right: 2px solid rgb(230, 244, 255);\n}\n.comment-from-store-over {\n  border-right: 2px solid #6f42c1;\n}\n\n.url {\n  border-left: 2px solid transparent;\n}\n.last-clicked > td.url {\n  border-left: 2px solid #b3bfff;\n}\n</style>\n","<template>\n  <Teleport to=\"body\">\n    <div class=\"modal message-edit-popup\" v-if=\"messagePopupEntry\" @pointerdown=\"closePopup\">\n      <div class=\"popup-content\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">{{messagePopupEntry.url}}</h5>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" @click=\"closePopup\"></button>\n          </div>\n          <div class=\"modal-body\">\n            <textarea rows=\"5\"\n                      :value=\"comment\"\n                      @input=\"onInputSaveComment\"\n                      ref=\"textareaElem\"\n                      @keydown=\"closePopupOnEnter\"\n            ></textarea>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"removeComment\">Reset</button>\n<!--            <button type=\"button\" class=\"btn btn-primary\">Select</button>-->\n          </div>\n        </div>\n      </div>\n    </div>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, onMounted, Ref, ref} from \"vue\";\nimport {messagePopupEntry} from \"../core/core\";\nimport {UrlInfo} from \"../core/url-info-entry\";\n\nconst comment = computed(() => {\n  const urlEntry = messagePopupEntry.value as UrlInfo;\n  return urlEntry.comment === undefined ? urlEntry.inputComment : urlEntry.comment;\n});\n\nfunction closePopup(event: MouseEvent) {\n  if (event.currentTarget === event.target) {\n    messagePopupEntry.value = null;\n  }\n}\n\nfunction closePopupOnEnter(event: KeyboardEvent) {\n  if (event.key === \"Enter\" && !event.shiftKey) {\n    event.preventDefault();\n    messagePopupEntry.value = null;\n  }\n}\n\nconst textareaElem: Ref<HTMLInputElement | null> = ref(null);\nconst focusTextarea = () => {\n  textareaElem.value?.focus();\n};\nonMounted(focusTextarea);\n\nfunction onInputSaveComment(event: InputEvent) {\n  const newValue = (event.currentTarget as HTMLInputElement).value;\n  void messagePopupEntry.value?.setComment(newValue);\n}\n\nfunction removeComment() {\n  messagePopupEntry.value?.delComment();\n}\n\n</script>\n\n<style scoped>\n.modal {\n  min-width: 100vw;\n  min-height: 100vh;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgba(255, 255, 255, 0.5);\n}\n.popup-content {\n  min-width: 420px;\n  max-width: min(520px, 80%);\n}\n.modal-content {\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);\n}\n\ntextarea {\n  width: 100%;\n  height: 100%;\n  resize: none;\n}\ntextarea:focus {\n  outline: none;\n}\n\n.modal-title {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n</style>\n","import {ref} from \"vue\";\n\n\nfunction loadTags(): string[] {\n    return JSON.parse(localStorage.getItem(\"href_lister_all_tags\") || \"[]\");\n}\n\n\nexport const allTags = ref(loadTags());\nexport function addTag(tag: string) {\n    if (!allTags.value.includes(tag)) {\n        allTags.value.push(tag);\n    }\n}\nexport function removeTag(tag: string) {\n    const index = allTags.value.indexOf(tag);\n    if (index !== -1) {\n        allTags.value.splice(index, 1);\n    }\n}\n\nexport type TagProp = {\n    tag: string,\n    selected: boolean,\n};\n","<script setup lang=\"ts\">\nimport {UrlInfo} from \"../../core/url-info-entry\";\nimport InputTagsItem from \"./InputTagsItem.vue\";\nimport {TagProp} from \"../../core/tags\";\n\nconst props = defineProps<{\n    entry: UrlInfo,\n    tagProps: TagProp[],\n}>();\n\nfunction toggleTag(event: MouseEvent) {\n    const tagElem = event.target as HTMLDivElement;\n    const tag = tagElem.dataset.tag;\n    if (!tag) {\n        return;\n    }\n    if (isSelected(tag))  {\n        props.entry.delTag(tag);\n    } else {\n        props.entry.addTag(tag);\n    }\n}\n\nfunction isSelected(tag: string) {\n    return props.entry.tags?.includes(tag);\n}\n\n</script>\n\n<template>\n    <div class=\"tag-master\" @click=\"toggleTag\">\n        <InputTagsItem v-for=\"tagProp of tagProps\" :tag=\"tagProp.tag\" :selected=\"isSelected(tagProp.tag)\"/>\n    </div>\n</template>\n\n<style scoped>\n\n</style>\n","<script setup lang=\"ts\">\nimport {UrlInfo} from \"../../core/url-info-entry\";\nimport {onMounted, Ref, ref} from \"vue\";\n\nconst props = defineProps<{\n    entry: UrlInfo,\n    modelValue: string\n}>();\n\nconst emit = defineEmits([\"update:modelValue\", \"tabPressed\"]);\n\nfunction removeTag(event: MouseEvent) {\n    const tagElem = event.target as HTMLDivElement;\n    const tag = tagElem.dataset.tag;\n    if (!tag) {\n        return;\n    }\n    props.entry?.delTag(tag);\n}\n\nconst tagInput: Ref<HTMLInputElement | null> = ref(null);\nconst canvas = document.createElement(\"canvas\");\nconst context = canvas.getContext(\"2d\")!;\nonMounted(() => {\n    if (tagInput.value) {\n        context.font = window.getComputedStyle(tagInput.value).font;\n    }\n});\nfunction resizeInput() {\n    if (!tagInput.value) {\n        return;\n    }\n    const textWidth = context.measureText(tagInput.value.value).width;\n    tagInput.value.style.width = textWidth + 6 + \"px\";\n}\nfunction focusInput() {\n    if (!tagInput.value) {\n        return;\n    }\n    tagInput.value.selectionStart = tagInput.value.selectionEnd;\n    tagInput.value.focus();\n}\nfunction selectInput() {\n    tagInput.value?.select();\n}\n\n\nfunction emitModelValueUpdate(event: InputEvent) {\n    emit(\"update:modelValue\", (event.target as HTMLInputElement).value);\n}\n\nfunction onTab(event: KeyboardEvent) {console.log(event);\n    if (event.code === \"Tab\") {\n        event.preventDefault();\n        emit(\"tabPressed\");\n    }\n}\n\n</script>\n\n<template>\n    <div class=\"selected-tags\">\n        <div class=\"tag-master\" @click=\"removeTag\">\n            <div class=\"tag\" v-for=\"tag of entry.tags\" :data-tag=\"tag\">{{tag}}</div>\n        </div>\n        <span\n                class=\"label\"\n                @dblclick=\"selectInput\"\n                @click=\"focusInput\"\n        >\n            <span class=\"input-wrapper\">\n                <input type=\"text\"\n                       ref=\"tagInput\"\n                       :value=\"modelValue\"\n                       v-on=\"{\n                           input: [resizeInput, emitModelValueUpdate]\n                       }\"\n                       @keydown=\"onTab\"\n                >\n            </span>\n        </span>\n    </div>\n</template>\n\n<style scoped>\n.selected-tags {\n    display: flex;\n    flex-wrap: wrap;\n}\n\ninput {\n    border: none;\n    outline: none;\n    width: 16px;\n    min-height: 31px;\n    padding-bottom: 2px;\n}\ninput:before {\n    position: absolute;\n    content: \"+\";\n}\n.input-wrapper {\n    min-width: 38px;\n    display: flex;\n    justify-content: center;\n}\n.label {\n    display: flex;\n    width: auto;\n    flex-grow: 2;\n    margin-left: 3px;\n    margin-bottom: 2px;\n\n    border-image: linear-gradient(to right, transparent 0, #4b88b9 6px, transparent) 1;\n    border-width: 1px;\n    border-style: solid;\n    border-top: 0;\n    border-left: 0;\n    border-right: 0;\n}\n\n</style>\n","<template>\n    <Teleport to=\"body\">\n        <div class=\"modal tags-edit-popup\" v-if=\"tagsPopupEntry\" @pointerdown=\"closePopup\">\n            <div class=\"popup-content\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <h5 class=\"modal-title\">{{tagsPopupEntry.url}}</h5>\n                    </div>\n                    <div class=\"modal-body\">\n                        <div class=\"tags selected-tags-group\">\n                            <SelectedTags :entry=\"tagsPopupEntry\" v-model=\"inputTagText\" @tabPressed=\"selectTag\"/>\n                        </div>\n                        <div class=\"tags all-tags-group\">\n                            <InputTags :entry=\"tagsPopupEntry\" :tagProps=\"filterTags\"/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {tagsPopupEntry} from \"../core/core\";\nimport {allTags, TagProp} from \"../core/tags\";\nimport InputTags from \"./tags/InputTags.vue\";\nimport SelectedTags from \"./tags/SelectedTags.vue\";\nimport {computed, ComputedRef, ref} from \"vue\";\n\nconst inputTagText = ref(\"\");\nfunction closePopup(event: MouseEvent) {\n    if (event.currentTarget === event.target) {\n        tagsPopupEntry.value = null;\n    }\n}\n\nconst tagProps: ComputedRef<TagProp[]> = computed(() => {\n    return allTags.value.map(tag => ({\n        tag,\n        selected: false,\n    }));\n});\n\nconst filterTags: ComputedRef<TagProp[]> = computed(() => {\n    const starts:   TagProp[] = [];\n    const contains: TagProp[] = [];\n    for (const tagProp of tagProps.value) {\n        const index = tagProp.tag.indexOf(inputTagText.value);\n        if (index === -1) {\n            continue;\n        }\n        if (index === 0) {\n            starts.push(tagProp);\n        } else {\n            contains.push(tagProp);\n        }\n    }\n    return [starts, contains].flat();\n});\n\nfunction selectTag() { // @tabPressed\n    // todo ...\n    inputTagText.value = \"\";\n}\n\n</script>\n\n<style scoped lang=\"scss\">\n.modal {\n  min-width: 100vw;\n  min-height: 100vh;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgba(255, 255, 255, 0.5);\n}\n.popup-content {\n  min-width: 420px;\n  max-width: min(520px, 80%);\n}\n.modal-content {\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);\n}\n\n.selected-tags-group {\n  min-height: 33px;\n  margin-bottom: 2px;\n}\n</style>\n","import {createApp} from \"vue\";\nimport App from \"./App.vue\";\n\ncreateApp(App).mount(\"#app\");\n"],"names":["defaultFilterSettings","input_only","ref","settings","input_ignore","matcher","computed","onlyParts","o","ignoreParts","text","matchOnly","matchIgnore","url","urlFilter","parseUrlEntries","lines","line","urls","main","comments","firstWord","words","matchUrl","word","match","urlInfoStore","createStore","_UrlInfo","state","inputComment","get","comment","visited","tag","index","set","toRaw","del","UrlInfo","commentsStore","visitsStore","entries","NEVER_VISITED_TIME","inputText","messagePopupEntry","tagsPopupEntry","lastClickedEntry","clickedUrls","urlEntryList","watchEffect","urlEntries","urlInfos","urlEntry","urlEntryListFiltered","ue","urlsFiltered","throttle","runnable","time","waiting","queued","context","args","cb","current_args","getCodeArrays","items","size","jsonArray","a","len","num","count","parts","i","part","page","pageCount","timeAgo","ms","now","secs","m","blinkButtonMap","blink","elem","sleep_time","sleep","textareaEl","onClearTextInput","event","_a","onCopyUrlsAsList","onCopyUrlsAsColumn","onCopyUrlsAsCodeArrays","onAppendClipboardText","currentTarget","onReplaceClipboardText","MINUTE","TEN_MINUTES","HOUR","DAY","RefTriggerTimer","timeRef","watch","value","onUnmounted","diff","triggerRef","toggleTagsEditPopup","props","visitedMs","removeUrlVisit","visitUrl","msNow","removeVisitOnMMB","commentCssClass","toggleMessageEditPopup","isClicked","markUrlAsClicked","markUrlAsClickedOnMMBClick","unmarkUrlAsClicked","isLastClicked","refTrigger","recalculateComponentState","triggerVisitedMs","visitedText","formatVisitedMs","formatDate","timePassedClass","getTimePassedClass","closePopup","closePopupOnEnter","textareaElem","onMounted","onInputSaveComment","newValue","removeComment","loadTags","allTags","toggleTag","isSelected","removeTag","tagInput","resizeInput","textWidth","focusInput","selectInput","emitModelValueUpdate","emit","onTab","inputTagText","tagProps","filterTags","starts","contains","tagProp","selectTag","createApp","App"],"mappings":"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"}