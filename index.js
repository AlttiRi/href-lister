import{ref as g,computed as w,defineComponent as k,openBlock as m,createElementBlock as y,createBaseVNode as o,withDirectives as N,vModelText as J,unref as d,isRef as et,pushScopeId as H,popScopeId as X,createBlock as O,renderSlot as Mt,Teleport as St,toRaw as W,toRefs as ft,watch as q,watchEffect as mt,reactive as ee,withModifiers as nt,normalizeClass as D,toDisplayString as S,createCommentVNode as P,onUnmounted as ne,triggerRef as It,Fragment as st,renderList as vt,onBeforeUnmount as se,createVNode as U,onMounted as At,vShow as oe,withCtx as Z,mergeProps as ae,toHandlers as re,createApp as le}from"./vue.js";import{UrlCleaner as B,sleep as gt,hashString as Dt,formatDate as ie,throttle as ue,debounce as ce,isString as de,isUCRuleStringArray as pe,sleepEx as fe}from"./util.js";import{createStore as Vt,del as Nt,get as qt,set as Bt,entries as jt}from"./idb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();const Ft={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},ot=g(Ft.input_only),at=g(Ft.input_ignore),me=w(()=>{let e=ot.value.trim().split(/\s+/g).filter(a=>a),t=at.value.trim().split(/\s+/g).filter(a=>a);e=e.map(a=>a.toLowerCase()),t=t.map(a=>a.toLowerCase());let n,s;return n=a=>e.some(r=>a.toLowerCase().includes(r)),s=a=>t.some(r=>a.toLowerCase().includes(r)),{matchOnly:n,matchIgnore:s,onlyParts:e,ignoreParts:t}}),ve=w(()=>{const{matchOnly:e,matchIgnore:t,onlyParts:n}=me.value;return n.length?s=>e(s):s=>!t(s)}),Wt=e=>(H("data-v-9c460a67"),e=e(),X(),e),ge={class:"row row-cols-lg-3 g-3 align-items-center","data-component":"Filters"},_e={class:"col-12"},he={class:"input-group"},be=Wt(()=>o("span",{class:"input-group-text"},"Only",-1)),ye={class:"col-12"},Ce={class:"input-group"},$e=Wt(()=>o("span",{class:"input-group-text"},"Ignore",-1)),we=k({__name:"Filters",setup(e){return(t,n)=>(m(),y("div",ge,[o("div",_e,[o("label",null,[o("span",he,[be,N(o("input",{type:"text",class:"form-control","onUpdate:modelValue":n[0]||(n[0]=s=>et(ot)?ot.value=s:null)},null,512),[[J,d(ot)]])])])]),o("div",ye,[o("label",null,[o("span",Ce,[$e,N(o("input",{type:"text",class:"form-control","onUpdate:modelValue":n[1]||(n[1]=s=>et(at)?at.value=s:null)},null,512),[[J,d(at)]])])])])]))}}),E=(e,t)=>{const n=e.__vccOpts||e;for(const[s,a]of t)n[s]=a;return n},Se=E(we,[["__scopeId","data-v-9c460a67"]]),ke={};function Te(e,t){return m(),O(St,{to:"body"},[Mt(e.$slots,"default")])}const bt=E(ke,[["render",Te]]);function Ie(e){const t=e.split(`
`).map(s=>s.trim()).filter(s=>s),n=[];for(const s of t){const[a,...r]=s.split(/\s+(#|\/\/)/),[u,...i]=a.trim().split(/\s+/);if(u.startsWith("http")){const l=yt(u);if(l&&i.every(p=>!yt(p))){n.push({url:l,inputComment:[...i,...r].join(" ")});continue}l&&n.push({url:l})}else i.unshift(u);for(const l of i){const p=yt(l);p&&n.push({url:p})}}return n}function yt(e){const t=e.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t?.groups)return t.groups.url}const rt={createStore:Vt,del:Nt,get:qt,set:Bt,entries:jt},lt=rt.createStore("HrefListerUrlInfo","UrlInfo"),Yt=class G{constructor({url:t,inputComment:n,urlOrigin:s},a){this.url=t,this.state=a,n&&(this.inputComment=n),a.visited&&(this.initialVisited=a.visited),s&&(this.urlOrigin=s)}static async getInstance(t){const n=t.urlOrigin||t.url;let s=G.stateMap.get(n);return s?new G(t,s):(s=await rt.get(n,lt),s===void 0&&(s={}),G.stateMap.set(n,s),new G(t,s))}isEquals(t){return t?this.state===t.state&&this.inputComment===t.inputComment:!1}get comment(){return this.state.comment}get visited(){return this.state.visited}get tags(){return this.state.tags}async setComment(t){this.state.comment=t,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(t){this.state.visited=t,await this.update()}async delVisited(){delete this.state.visited,await this.update()}async addTag(t){this.state.tags||(this.state.tags=[]),!this.state.tags.includes(t)&&(this.state.tags.push(t),await this.update())}async delTag(t){if(!this.state.tags)return;const n=this.state.tags.indexOf(t);n!=-1&&(this.state.tags.splice(n,1),this.state.tags.length===0&&delete this.state.tags,await this.update())}update(){return Object.keys(this.state).length?rt.set(this.urlOrigin||this.url,W(this.state),lt):rt.del(this.urlOrigin||this.url,lt)}};Yt.stateMap=new Map;let Jt=Yt;Object.assign(globalThis,{idb:{createStore:Vt,del:Nt,get:qt,set:Bt,entries:jt,urlInfoStore:lt},UrlEntry:Jt});const xe=-1,L=g(""),R=g(null),M=g(null),it=g(new Set),Ct=g(!1),$t=g(!1),kt={};function xt(){kt["auto-clicker"]?.()}function Et(){kt["url-cleaner"]?.()}const F=g(!0),ut=g(!0),x=g(null);function _t(e,t){const n=localStorage.getItem(e),s=ee(n===null?typeof t=="function"?t():t:JSON.parse(n));return q(s,()=>{localStorage.setItem(e,JSON.stringify(s))}),s}const Ee=ft(_t("href-lister-clicker-settings",{delay:1,count:0})),ct=ft(_t("href-lister-url-cleaner-settings",()=>{const e=["site:youtube.com","trim-search-params:feature t si","site:t.umblr.com","filter-start:https://t.umblr.com/redirect","search-param:z","recursive","site:deviantart.com","trim-start:https://www.deviantart.com/users/outgoing?","decode-url","recursive"];return{ucRuleStrings:e,ucCompiledRules:B.compileRuleStrings(e)}})),Ht=g(B.fromRuleRecords(ct.ucCompiledRules.value));q(ct.ucCompiledRules,()=>{Ht.value=B.fromRuleRecords(ct.ucCompiledRules.value)});const dt=ft(_t("href-lister-url-origin-settings",()=>{const e=["site:cdn.discordapp.com","trim-search-params:ex is hm"];return{ucRuleStrings:e,ucCompiledRules:B.compileRuleStrings(e)}})),Xt=g(B.fromRuleRecords(dt.ucCompiledRules.value));q(dt.ucCompiledRules,()=>{Xt.value=B.fromRuleRecords(dt.ucCompiledRules.value)});const tt=ft(_t("href-lister-common-settings",{useCleaner:!0,useOriginer:!0})),{useCleaner:Le,useOriginer:Ue}=tt,zt=g([]);mt(async()=>{const e=Ie(L.value),t=[];for(const n of e){n.url=Le.value?Ht.value.clean(n.url):n.url;const s=Ue.value?Xt.value.clean(n.url):n.url;s!==n.url&&(n.urlOrigin=s),t.push(await Jt.getInstance(n))}zt.value=t});const Kt=w(()=>zt.value.filter(e=>ve.value(e.url))),Y=w(()=>{const e=Kt.value.map(t=>t.url);return globalThis.__urls=e,e});location.href==="http://localhost:5173/"&&(L.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
http://localhost:5173/#www
https://www.youtube.com/watch?feature=player_embedded&v=Qwert123`);function Pe(e,t=100){const n=i=>`${i.length?'["'+i.join('", "')+'"]':"[]"}`;if(e.length<=t)return`/* ${e.length.toString().padStart(3)} */ ${n(e)},`;const s=i=>i.toString().length,a=Math.trunc(e.length/t),u=[`/* ${e.length.toString().padStart(1+s(e.length))+" ".repeat(3+s(a))} */`];for(let i=0;i<=a;i++){const l=e.slice(t*i,t+t*i),p=`(${i+1})`.padStart(2+s(a)),C=l.length.toString().padStart(1+s(e.length));u.push(`/* ${C} ${p} */ ${n(l)},`)}return u.join(`
`)}function Re(e){const t=Date.now(),n=Math.trunc((t-e)/1e3);if(n<60)return`${n} second${n>1?"s":""} ago`;if(n<60*60){const s=Math.trunc(n/60);return`${s} minute${s>1?"s":""} ago`}if(n<60*60*24){const s=Math.trunc(n/60%60).toString().padStart(2,"0");return`${Math.trunc(n/60/60)}:${s} ago`}return Math.trunc(n/60/60/24)+" days ago"}const Lt=["1st","2nd","3rd"];function Oe(e){return e=Number(e),Lt[e]?Lt[e]:e+1+"th"}function Me(e,t,n){const s=document.createElement("a");s.setAttribute("download",t||"");const a=URL.createObjectURL(e);s.href=a+(n?"#"+n:""),s.click(),setTimeout(()=>URL.revokeObjectURL(a),15e3)}Object.assign(globalThis,{downloadBlob:Me});const ht=e=>(H("data-v-5a515753"),e=e(),X(),e),Ae={class:"row row-cols-lg-3 g-3 align-items-end","data-component":"InputControls"},De={class:"input col-12"},Ve=ht(()=>o("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),Ne=["disabled"],qe={class:"input col-12"},Be={class:"row"},je={class:"line m-1"},Fe=ht(()=>o("span",{class:"btn-group"},[o("span",{class:"input-group-text me-1"},"Clipboard")],-1)),We=["disabled"],Ye=["disabled"],Je={class:"line m-1"},He=ht(()=>o("span",{class:"btn-group"},[o("span",{class:"input-group-text me-1 text-center"},"Controls")],-1)),Xe=["disabled"],ze={class:"input col-12",style:{"align-self":"end"}},Ke={class:"row"},Qe={class:"line m-1"},Ge=ht(()=>o("span",{class:"btn-group"},[o("span",{class:"input-group-text me-1 text-center"},"Popups")],-1)),Ze=k({__name:"InputControls",setup(e){const t=new WeakMap;async function n(c,{klass:v="btn-active",time:b=180}={}){c.classList.add(v);const A=gt(b);t.set(c,A),await A,t.get(c)===A&&c.classList.remove(v)}const s=g(null);function a(c){L.value="",s.value?.focus(),p(),n(c.currentTarget)}function r(c){navigator.clipboard.writeText(Y.value.join(" ")),n(c.currentTarget)}function u(c){c.preventDefault(),navigator.clipboard.writeText(Y.value.join(`
`)),n(c.currentTarget)}function i(c){c.button===1&&(c.preventDefault(),navigator.clipboard.writeText(Pe(Y.value)),n(c.currentTarget))}let l=null;function p(){l=null}function C(c,v){const b=l,{hash:A,size:K}={hash:Dt(c),size:c.length};return l={hash:A,size:K,type:v},b?b.type==="append"&&v==="replace"?L.value===c:K===b.size&&A===b.hash:!1}async function T(c){const{currentTarget:v}=c,b=await navigator.clipboard.readText();if(C(b,"append")){n(v,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",b),L.value&&!L.value.endsWith(`
`)&&(L.value+=`
`),L.value+=b,n(v)}async function I(c){const{currentTarget:v}=c,b=await navigator.clipboard.readText();if(C(b,"replace")){n(v,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",b),L.value=b,n(v)}const{useCleaner:f,useOriginer:h}=tt;return(c,v)=>(m(),y("div",Ae,[o("div",De,[Ve,N(o("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":v[0]||(v[0]=b=>et(L)?L.value=b:null),ref_key:"textareaEl",ref:s,onInput:p,disabled:!d(F)},null,40,Ne),[[J,d(L)]])]),o("div",qe,[o("span",Be,[o("span",je,[Fe,o("button",{class:"btn btn-outline-primary",onClick:I,disabled:!d(F)},"Replace",8,We),o("button",{class:"btn btn-outline-primary",onClick:T,disabled:!(d(F)||d(ut))},"Append",8,Ye)]),o("span",Je,[He,o("button",{class:"btn btn-outline-danger",onClick:a,disabled:!d(F)},"Clear",8,Xe),o("button",{class:"btn btn-primary",title:"Copy URLs",onClick:r,onContextmenu:u,onPointerdown:i},"Copy",32)])])]),o("div",ze,[o("span",Ke,[o("span",Qe,[Ge,o("button",{class:"btn btn-outline-primary",title:"Toggle Auto Clicker Popup",onClick:v[1]||(v[1]=b=>Ct.value=!d(Ct)),onContextmenu:v[2]||(v[2]=nt((...b)=>d(xt)&&d(xt)(...b),["prevent"]))},"Auto Clicker",32),o("button",{class:D(["btn btn-outline-primary",{"turned-off":!d(f)&&!d(h)}]),title:"Toggle Url Cleaner Popup",onClick:v[3]||(v[3]=b=>$t.value=!d($t)),onContextmenu:v[4]||(v[4]=nt((...b)=>d(Et)&&d(Et)(...b),["prevent"]))},"Url Magic",34)])])])]))}}),tn=E(Ze,[["__scopeId","data-v-5a515753"]]),Ut=w(()=>{const e=[...new Set(Y.value)].sort().join(" ");return Math.abs(Dt(e)).toString(16).slice(-8).padStart(8,"0").toUpperCase()}),Q=w(()=>{const e=Y.value,t=e.length,n=new Set(e).size;return{count:t,uniqueCount:n}}),V=w(()=>{let e=0;const t=new Set;for(const n of Y.value)it.value.has(n)&&(e++,t.add(n));return{count:e,uniqueCount:t.size}}),z=e=>(H("data-v-fd34ce57"),e=e(),X(),e),en={"data-component":"URLsInfoLine"},nn={title:"URLs count"},sn={key:0,title:"URLs count (unique)"},on=z(()=>o("span",{class:"grey"}," — ",-1)),an={title:"URLs hash"},rn=z(()=>o("span",{class:"grey"},"#",-1)),ln={class:"urls-hash"},un={key:0},cn=z(()=>o("span",{class:"grey"}," — ",-1)),dn=z(()=>o("span",{class:"grey"},"[",-1)),pn={class:"clicked-count"},fn={title:"Clicked URLs count"},mn={key:0,title:"Clicked URLs count (unique)"},vn=z(()=>o("span",{class:"grey"},"]",-1)),gn=z(()=>o("span",{class:"grey"}," — ",-1)),_n=["title"],hn=k({__name:"URLsInfoLine",setup(e){mt(()=>{const{count:r,uniqueCount:u}=Q.value;if(!r){document.title="HrefLister";return}if(document.title=`HrefLister — ${t(r,u)} — #${Ut.value}`,V.value.count){const{count:i,uniqueCount:l}=V.value;document.title=`${document.title} — [ ${t(i,l)} ]`}});function t(r,u){let i=r.toString();return r!==u&&(i=`${i} (${u})`),i}async function n(){if(!x.value)return;const r=x.value.elem;r.scrollIntoView({block:"center"}),r.classList.add("highlighted-2"),await gt(800),r.classList.remove("highlighted-2")}function s(){x.value&&x.value.elem.classList.add("highlighted-1")}function a(){x.value&&x.value.elem.classList.remove("highlighted-1")}return(r,u)=>(m(),y("div",en,[o("span",null,[o("span",nn,S(d(Q).count),1),d(Q).count!==d(Q).uniqueCount?(m(),y("span",sn," ("+S(d(Q).uniqueCount)+")",1)):P("",!0)]),on,o("span",an,[rn,o("span",ln,S(d(Ut)),1)]),d(V).count?(m(),y("span",un,[cn,o("span",null,[dn,o("span",pn,[o("span",fn,S(d(V).count),1),d(V).count!==d(V).uniqueCount?(m(),y("span",mn," ("+S(d(V).uniqueCount)+")",1)):P("",!0)]),vn])])):P("",!0),d(x)?(m(),y("span",{key:1,onClick:n,onPointerenter:s,onPointerleave:a},[gn,o("span",{class:"grey",title:`Last clicked URL index
`+d(x).entry.url},S(d(Oe)(d(x).index)),9,_n)],32)):P("",!0)]))}}),bn=E(hn,[["__scopeId","data-v-fd34ce57"]]),Tt=1e3*60,Pt=Tt*10,wt=Tt*60,yn=wt*24;class Cn{constructor(t){this.timeRef=t,q(t,n=>{n>0&&this.setTimer()}),ne(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let n;if(t<Pt)n=Tt;else if(t<wt)n=Pt;else if(t<yn)n=wt;else return;this.timerId=window.setTimeout(()=>{It(this.timeRef),this.setTimer()},n)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){It(this.timeRef),this.setTimer()}}const $n=e=>(H("data-v-c5b164a1"),e=e(),X(),e),wn={class:"tags"},Sn={class:"tag-master","data-component":"EntryTags"},kn=["data-tag"],Tn={key:0,class:"tag add-tag"},In=$n(()=>o("span",{class:"plus"},"+",-1)),xn=[In],En=k({__name:"UrlListItemTags",props:{ue:{}},setup(e){const t=e;function n(){W(M.value)===W(t.ue)?M.value=null:M.value=t.ue,console.log(W(M.value))}return(s,a)=>(m(),y("div",{class:"tags-wrapper",onClick:n,"data-component":"UrlListItemTags"},[o("div",wn,[o("div",Sn,[(m(!0),y(st,null,vt(s.ue.tags,r=>(m(),y("div",{class:"tag","data-tag":r},S(r),9,kn))),256))])]),s.ue.tags?.length?P("",!0):(m(),y("div",Tn,xn))]))}}),Ln=E(En,[["__scopeId","data-v-c5b164a1"]]),Un=["data-index"],Pn={class:"col-9 nowrap-text-ceil url url-cell"},Rn={class:"nowrap-text-ceil-content"},On=["title"],Mn=["href","title","data-url-origin"],An={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},Dn=k({__name:"UrlListItem",props:{ue:{},index:{}},setup(e){const t=e,n=w(()=>t.ue.visited||xe);function s(){t.ue.delVisited()}function a(){const _=Date.now();t.ue.setVisited(_)}function r(_){_.button===1&&(_.preventDefault(),s())}const u=w(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),i=w(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function l(){W(R.value)===W(t.ue)?R.value=null:R.value=t.ue}const p=g(),C=w(()=>it.value.has(t.ue.url));function T(){it.value.add(t.ue.url),a(),x.value={entry:t.ue,index:t.index,elem:p.value}}function I(_){_.button!==1||document.getRootNode().activeElement!==_.currentTarget||T()}function f(){it.value.delete(t.ue.url)}const h=w(()=>{const _=x.value;return _?t.index===_.index&&t.ue.isEquals(_.entry):!1});se(()=>{h.value&&(x.value=null)});const c=new Cn(n);function v(){c.forceTrigger()}const b=ue(v,2e3),A=w(()=>{let _=`№ ${t.index+1}.
`;return n.value<0?_+="never clicked":_+=K(n.value),t.ue.initialVisited&&t.ue.initialVisited!==n.value?`${_}
${K(t.ue.initialVisited)}`:_});function K(_){return Re(_)+" — "+ie(_,"YYYY.MM.DD HH:mm:SS",!1)}const Zt=w(()=>te(n.value));function te(_){if(_<0)return"never-clicked";const j=Date.now(),$=Math.trunc((j-_)/1e3);return $<60?"minute-1":$<60*2?"minute-2":$<60*5?"minute-5":$<60*10?"minute-10":$<60*30?"minute-30":$<60*45?"minute-45":$<60*60?"minute-60":$<3600*2?"hour-2":$<3600*4?"hour-4":$<3600*8?"hour-8":$<3600*14?"hour-14":$<3600*24?"day-1":$<86400*7?"day-7":$<86400*30?"month-1":$<2592e3*3?"month-3":$<2592e3*6?"month-6":"long-ago"}return(_,j)=>(m(),y("tr",{onPointerenter:j[0]||(j[0]=(...$)=>d(b)&&d(b)(...$)),"data-index":_.index+1,class:D([{clicked:C.value,"last-clicked":h.value},"list-item-row"]),"data-component":"UrlListItem",ref_key:"htmlCompRef",ref:p},[o("td",Pn,[o("span",Rn,[o("span",{class:D(["info-dot",{"has-comment":_.ue.inputComment,visited:n.value>0,[Zt.value]:!0}]),title:A.value,onContextmenu:nt(f,["prevent"]),onPointerdown:r},null,42,On),o("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:_.ue.url,title:_.ue.inputComment||_.ue.urlOrigin,"data-url-origin":_.ue.urlOrigin,onClick:T,onPointerup:I},S(_.ue.url),41,Mn)]),U(Ln,{class:"tags",ue:_.ue},null,8,["ue"])]),o("td",{class:D(["col-3 comment nowrap-text-ceil",{[u.value]:u.value}]),onDblclick:l},[o("span",An,S(i.value||" "),1)],34)],42,Un))}}),Vn=E(Dn,[["__scopeId","data-v-132a8e8c"]]),Nn={"data-component":"UrlList"},qn={class:"table table-borderless"},Bn=k({__name:"UrlList",setup(e){return(t,n)=>(m(),y("div",Nn,[o("table",qn,[o("tbody",null,[(m(!0),y(st,null,vt(d(Kt),(s,a)=>(m(),O(Vn,{ue:s,index:a,key:a+s.url},null,8,["ue","index"]))),128))])])]))}}),jn={class:"popup-content"},Fn={class:"modal-content"},Wn={class:"modal-header"},Yn={class:"modal-title"},Jn={class:"modal-body"},Hn=["value"],Xn=k({__name:"MessageEditPopup",setup(e){const t=w(()=>{const l=R.value;return l.comment===void 0?l.inputComment:l.comment});function n(l){l.currentTarget===l.target&&(R.value=null)}function s(l){l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),R.value=null)}const a=g(null);At(()=>{a.value?.focus()});function u(l){const p=l.currentTarget.value;R.value?.setComment(p)}function i(){R.value?.delComment()}return(l,p)=>d(R)?(m(),y("div",{key:0,class:"modal message-edit-popup","data-component":"MessageEditPopup",onPointerdown:n},[o("div",jn,[o("div",Fn,[o("div",Wn,[o("h5",Yn,S(d(R).url),1),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:n})]),o("div",Jn,[o("textarea",{rows:"5",value:t.value,onInput:u,ref_key:"textareaElem",ref:a,onKeydown:s},null,40,Hn)]),o("div",{class:"modal-footer"},[o("button",{type:"button",class:"btn btn-secondary",onClick:i},"Reset")])])])],32)):P("",!0)}}),zn=E(Xn,[["__scopeId","data-v-a287ee09"]]);function pt(e,t){for(const[n,s]of Object.entries(t))e.style[n]=s}function Qt(e,t){Object.keys(t).forEach(n=>e.style[n]="")}function Kn(e,{handle:t,onMove:n,onStop:s,state:a,reset:r,position:u="absolute"}={}){a&&pt(e,a);const i=t||e;return i.style.userSelect="none",i.style.touchAction="none",e.style.position=u,i.addEventListener("pointerdown",l=>{l.preventDefault();const p=l.clientY-parseInt(getComputedStyle(e).top),C=l.clientX-parseInt(getComputedStyle(e).left);function T(f){i.hasPointerCapture(f.pointerId)||i.setPointerCapture(f.pointerId),a={top:`${f.clientY-p}px`,left:`${f.clientX-C}px`},pt(e,a),n?.(a)}function I(){removeEventListener("pointermove",T),a&&s?.(a)}addEventListener("pointermove",T,{passive:!0}),addEventListener("pointerup",I,{once:!0})}),{reset:()=>{a&&Qt(e,a),r?.()}}}function Qn(e,{minW:t=64,minH:n=64,size:s=16,onMove:a,onStop:r,state:u,reset:i}={}){u&&pt(e,u);const l=document.createElement("div");return l.style.cssText=`width: ${s}px; height: ${s}px; border-radius: ${s/2}px; bottom: ${-(s/2)}px; right: ${-(s/2)}px; position: absolute; background-color: transparent; cursor: se-resize; touch-action: none;`,e.append(l),l.addEventListener("pointerdown",p=>{p.preventDefault(),l.setPointerCapture(p.pointerId);const C=p.clientX-e.offsetLeft-parseInt(getComputedStyle(e).width),T=p.clientY-e.offsetTop-parseInt(getComputedStyle(e).height);function I(h){let c=h.clientX-e.offsetLeft-C,v=h.clientY-e.offsetTop-T;c<t&&(c=t),v<n&&(v=n),u={width:`${c}px`,height:`${v}px`},pt(e,u),a?.(u)}function f(){l.removeEventListener("pointermove",I),u&&r?.(u)}l.addEventListener("pointermove",I,{passive:!0}),l.addEventListener("lostpointercapture",f,{once:!0})}),{reset:()=>{u&&Qt(e,u),i?.()}}}function Rt({id:e,onMove:t,onStop:n}){const s=localStorage.getItem(e);let a;s&&(a=JSON.parse(s));const r=l=>localStorage.setItem(e,JSON.stringify(l)),u=()=>localStorage.removeItem(e);let i;return n?i=function(l){n(l),r(l)}:i=r,{onMove:t,onStop:i,state:a,reset:u}}function Gn(e){return{makeMovableEx(t,n,s={}){return Kn(t,{...s,...Rt({id:`${e}--${n}--move-state`,...s})})},makeResizableEx(t,n,s={}){return Qn(t,{...s,...Rt({id:`${e}--${n}--resize-state`,...s})})}}}function Zn(e,t){e.setAttribute("tabindex","-1"),e.addEventListener("focusin",s),e.addEventListener("focusout",a);let n=0;function s(){e.classList.add("focus"),clearTimeout(n)}function a(){n=window.setTimeout(()=>{e.classList.remove("focus")},250)}(t||e).addEventListener("pointerdown",r=>{e.focus()},{passive:!0})}const ts={"data-component":"FancyPopup",class:"popup-root"},es=k({__name:"FancyPopup",props:{id:{},header:{}},setup(e){const{makeMovableEx:t}=Gn("href-lister"),n=e,s=g(),a=mt(()=>{if(!s.value||!n.header)return;const r=s.value,u=n.header,{reset:i}=t(r,n.id,{handle:u});kt[n.id]=i,Zn(r,u),a()});return(r,u)=>(m(),y("div",ts,[o("div",{class:"popup",ref_key:"popupElem",ref:s},[Mt(r.$slots,"default",{},void 0,!0)],512)]))}}),Gt=E(es,[["__scopeId","data-v-643dc050"]]),ns={"data-component":"UrlCleanerConfig",class:"url-cleaner"},ss={class:"warning"},os=k({__name:"UrlCleanerConfig",props:{ucSettings:{},btnInsertPlace:{}},setup(e){const t=e,{ucRuleStrings:n,ucCompiledRules:s}=t.ucSettings,a=g(null),r=g(!0),u=g(!0),i=g(""),l=g("");let p="";const C=ce(I,220);q(n,()=>{l.value=f(n.value),p=l.value,q(l,C)},{immediate:!0});async function T(){const h=a.value;h.blur(),n.value=JSON.parse(l.value),s.value=B.compileRuleStrings(n.value),p=l.value,h.classList.add("btn-outline-success"),await gt(800),r.value=!0,h.classList.remove("btn-outline-success")}function I(){if(a.value){if(l.value===p){r.value=!0,u.value=!0,i.value="";return}u.value=!1,r.value=!1;try{const c=JSON.parse(l.value);if(!Array.isArray(c)){i.value="Not an array";return}if(c.length!==c.flat().length){i.value="Array is not flat";return}if(!c.every(de)){i.value="Array is not string one";return}if(!pe(c)){i.value="Wrong data in the rule string array";return}u.value=!0,i.value=""}catch{i.value="Incorrect JSON"}}}function f(h){let c=JSON.stringify(h,null,4);return c=c.replaceAll('    "site','"site'),c}return(h,c)=>(m(),y("div",ns,[N(o("textarea",{spellcheck:"false",id:"editor",class:"form-control","onUpdate:modelValue":c[0]||(c[0]=v=>l.value=v)},null,512),[[J,l.value]]),(m(),O(St,{to:h.btnInsertPlace},[o("button",{ref_key:"saveBtn",ref:a,id:"save",class:D(["btn btn-outline-primary",{disabled:r.value||!u.value}]),onClick:T},"Save",2)],8,["to"])),o("span",ss,S(i.value),1)]))}}),Ot=E(os,[["__scopeId","data-v-15078068"]]),as=e=>(H("data-v-b968c8ad"),e=e(),X(),e),rs={class:"popup-content"},ls={class:"p-1 flex"},is=as(()=>o("span",{class:"btn-group"},[o("span",{class:"input-group-text me-1 text-center"},"Configs")],-1)),us={class:"btn-group"},cs={key:0,class:"ready-required"},ds={key:0},ps={key:1},fs=k({__name:"PopupUrlCleaner",setup(e){const t=g(null),n=g("cleaner"),s=g(null),a=g(!1);mt(()=>{s.value&&(a.value=!0)});const{useCleaner:r,useOriginer:u}=tt;function i(l){tt[l].value=!tt[l].value}return(l,p)=>N((m(),O(Gt,{"data-slot-component":"PopupUrlCleaner",id:"url-cleaner",header:t.value},{default:Z(()=>[o("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Url Magic Transforms",512),o("div",rs,[o("div",ls,[is,o("span",us,[o("button",{title:"Rule String Array based config",class:D(["btn btn-outline-primary",{active:n.value==="cleaner","turned-off":!d(r)}]),onClick:p[0]||(p[0]=C=>n.value="cleaner"),onContextmenu:p[1]||(p[1]=nt(()=>i("useCleaner"),["prevent"]))},"Url Cleaner",34),o("button",{title:"Rule String Array based config",class:D(["btn btn-outline-primary",{active:n.value==="originer","turned-off":!d(u)}]),onClick:p[2]||(p[2]=C=>n.value="originer"),onContextmenu:p[3]||(p[3]=nt(()=>i("useOriginer"),["prevent"]))},"Url Origin",34)]),o("span",{style:{"margin-left":"auto"},class:"btn-insert-place",ref_key:"btnInsertPlace",ref:s},null,512)]),a.value?(m(),y("div",cs,[n.value==="cleaner"?(m(),y("div",ds,[U(Ot,{ucSettings:d(ct),btnInsertPlace:s.value},null,8,["ucSettings","btnInsertPlace"])])):(m(),y("div",ps,[U(Ot,{ucSettings:d(dt),btnInsertPlace:s.value},null,8,["ucSettings","btnInsertPlace"])]))])):P("",!0)])]),_:1},8,["header"])),[[oe,a.value]])}}),ms=E(fs,[["__scopeId","data-v-b968c8ad"]]),vs={class:"popup-content"},gs={class:"btn-group p-1 container"},_s=["disabled"],hs=["disabled"],bs=["disabled"],ys={class:"div-wrap"},Cs={class:"p-1 pt-0 col-12"},$s={class:"input-group"},ws=o("span",{class:"input-group-text col-3"},"Delay",-1),Ss={class:"div-wrap"},ks={class:"p-1 pt-0 col-12"},Ts={class:"input-group"},Is=o("span",{class:"input-group-text col-3"},"Count",-1),xs=k({__name:"PopupAutoClicker",setup(e){const t=g(null),{delay:n,count:s}=Ee,a=g("ready"),r=g(0);let u=new AbortController;q(a,()=>{a.value==="ready"?ut.value=F.value=!0:a.value==="started"?ut.value=F.value=!1:a.value==="paused"&&(ut.value=!0)});async function i(){console.log("startClicking");const f=[...document.querySelectorAll("a.url")],h=s.value===0?f.length:Math.min(f.length,s.value+r.value),c=h<f.length;for(a.value="started";r.value<h;){const v=f[r.value],b=v.closest('[data-component="UrlListItem"]');if(b.classList.add("hover"),await fe(n.value*1e3,u.signal),b.classList.remove("hover"),a.value==="started")r.value++,v.dispatchEvent(new MouseEvent("click")),await gt();else if(a.value==="paused"){a.value="paused";return}else if(a.value==="stopped"){r.value=0,a.value="ready";return}}c?a.value="paused":(r.value=0,a.value="ready")}function l(f){r.value===0&&(f="stopped"),a.value=f,u.abort(f),u=new AbortController}function p(){if(a.value==="started"){l("stopped");return}r.value=0,a.value="ready"}let C;function T(){if(x.value&&a.value!=="ready"){const f=x.value.elem.nextElementSibling;f&&(f.classList.add("highlighted-1"),C=f)}else{const f=document.querySelector('[data-component="UrlListItem"]');f&&(f.classList.add("highlighted-1"),C=f)}}function I(){C&&(C.classList.remove("highlighted-1"),C=null)}return(f,h)=>(m(),O(Gt,{"data-slot-component":"PopupAutoClicker",id:"auto-clicker",header:t.value},{default:Z(()=>[o("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Auto Clicker",512),o("div",vs,[o("div",gs,[o("button",{class:"btn btn-primary col-4",onClick:i,onPointerenter:T,onPointerleave:I,disabled:!(a.value==="ready"||a.value==="paused")},S(a.value==="ready"||!r.value?"Start":"Next"),41,_s),o("button",{class:"btn btn-secondary col-4",disabled:a.value!=="started",onClick:h[0]||(h[0]=c=>l("paused"))},"Pause",8,hs),o("button",{class:"btn btn-secondary col-4",disabled:!r.value,onClick:p},S(a.value==="paused"?"Reset":"Stop"),9,bs)]),o("div",ys,[o("label",Cs,[o("span",$s,[ws,N(o("input",{title:"Click delay (seconds)",class:"form-control",type:"number","onUpdate:modelValue":h[1]||(h[1]=c=>et(n)?n.value=c:null)},null,512),[[J,d(n)]])])])]),o("div",Ss,[o("label",ks,[o("span",Ts,[Is,N(o("input",{title:"Count",class:"form-control",type:"number","onUpdate:modelValue":h[2]||(h[2]=c=>et(s)?s.value=c:null)},null,512),[[J,d(s)]])])])])])]),_:1},8,["header"]))}}),Es={class:"selected-tags","data-component":"SelectedTags"},Ls=["data-tag"],Us={class:"input-wrapper"},Ps=["value"],Rs=k({__name:"SelectedTags",props:{entry:{},modelValue:{}},emits:["update:modelValue","tabPressed"],setup(e,{emit:t}){const n=e,s=t;function a(f){const c=f.target.dataset.tag;c&&n.entry?.delTag(c)}const r=g(null),i=document.createElement("canvas").getContext("2d");At(()=>{r.value&&(i.font=window.getComputedStyle(r.value).font)});function l(){if(!r.value)return;const f=i.measureText(r.value.value).width;r.value.style.width=f+6+"px"}function p(){r.value&&(r.value.selectionStart=r.value.selectionEnd,r.value.focus())}function C(){r.value?.select()}function T(f){s("update:modelValue",f.target.value)}function I(f){console.log(f),f.code==="Tab"&&(f.preventDefault(),s("tabPressed"))}return(f,h)=>(m(),y("div",Es,[o("div",{class:"tag-master",onClick:a},[(m(!0),y(st,null,vt(f.entry.tags,c=>(m(),y("div",{class:"tag","data-tag":c},S(c),9,Ls))),256))]),o("span",{class:"label",onDblclick:C,onClick:p},[o("span",Us,[o("input",ae({type:"text",ref_key:"tagInput",ref:r,value:f.modelValue},re({input:[l,T]}),{onKeydown:I}),null,16,Ps)])],32)]))}}),Os=E(Rs,[["__scopeId","data-v-40fab9e9"]]),Ms=["data-tag"],As=k({__name:"SuggestedTag",props:{tagWrap:{}},setup(e){const t=e,{entry:n,tag:s}=t.tagWrap,a=w(()=>!!n.tags?.includes(s));function r(){a.value?n.delTag(s):n.addTag(s)}return(u,i)=>(m(),y("div",{class:D(["tag",{selected:a.value}]),onClick:r,"data-tag":u.tagWrap.tag,"data-component":"SuggestedTag"},S(u.tagWrap.tag),11,Ms))}}),Ds=E(As,[["__scopeId","data-v-5d66b337"]]);function Vs(){return JSON.parse(localStorage.getItem("href_lister_all_tags")||"[]")}const Ns=g(Vs()),qs={class:"popup-content"},Bs={class:"modal-content"},js={class:"modal-header"},Fs={class:"modal-title"},Ws={class:"modal-body"},Ys={class:"tags selected-tags-group"},Js={class:"tags all-tags-group"},Hs={class:"tag-master"},Xs=k({__name:"UrlEntryTagsEditPopup",setup(e){const t=g(""),n=M,s=w(()=>Ns.value.map(i=>({tag:i,entry:n.value}))),a=w(()=>{const i=[],l=[];for(const p of s.value){const C=p.tag.indexOf(t.value);C!==-1&&(C===0?i.push(p):l.push(p))}return[i,l].flat()});function r(){t.value=""}function u(i){i.currentTarget===i.target&&(M.value=null)}return(i,l)=>(m(),O(St,{to:"body"},[d(M)?(m(),y("div",{key:0,class:"modal tags-edit-popup",onPointerdown:u,"data-component":"URLsInfoLine"},[o("div",qs,[o("div",Bs,[o("div",js,[o("h5",Fs,S(d(M).url),1)]),o("div",Ws,[o("div",Ys,[U(Os,{entry:d(M),modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=p=>t.value=p),onTabPressed:r},null,8,["entry","modelValue"])]),o("div",Js,[o("div",Hs,[(m(!0),y(st,null,vt(a.value,p=>(m(),O(Ds,{"tag-wrap":p},null,8,["tag-wrap"]))),256))])])])])])],32)):P("",!0)]))}}),zs=E(Xs,[["__scopeId","data-v-7874f8fe"]]),Ks={"data-component":"Main"},Qs=o("hr",null,null,-1),Gs=o("hr",null,null,-1),Zs=o("hr",null,null,-1),to=o("hr",null,null,-1),eo=k({__name:"Main",setup(e){return(t,n)=>(m(),y("div",Ks,[Qs,U(Se),Gs,U(tn),Zs,U(bn),to,U(Bn),d(M)?(m(),O(zs,{key:0})):P("",!0),d(R)?(m(),O(bt,{key:1},{default:Z(()=>[U(zn)]),_:1})):P("",!0),d(Ct)?(m(),O(bt,{key:2},{default:Z(()=>[U(xs)]),_:1})):P("",!0),d($t)?(m(),O(bt,{key:3},{default:Z(()=>[U(ms)]),_:1})):P("",!0)]))}}),no=e=>(H("data-v-679e969c"),e=e(),X(),e),so=no(()=>o("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister",target:"_blank"},[o("i",null,"i")],-1)),oo=k({__name:"App",setup(e){return(t,n)=>(m(),y(st,null,[U(eo),so],64))}}),ao=E(oo,[["__scopeId","data-v-679e969c"]]);le(ao).mount("#app");
//# sourceMappingURL=index.js.map
