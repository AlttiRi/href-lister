import{ref as m,computed as S,defineComponent as k,openBlock as f,createElementBlock as h,createBaseVNode as s,withDirectives as N,vModelText as z,unref as p,isRef as ot,pushScopeId as K,popScopeId as X,createBlock as A,renderSlot as Rt,Teleport as St,toRaw as W,toRefs as gt,watch as q,watchEffect as at,reactive as Gt,withModifiers as lt,normalizeClass as D,toDisplayString as T,createCommentVNode as E,onUnmounted as Zt,triggerRef as kt,Fragment as rt,renderList as _t,onBeforeUnmount as te,createVNode as U,onMounted as Ot,vShow as ee,withCtx as et,mergeProps as ne,toHandlers as se,createApp as oe}from"./vue.js";import{UrlCleaner as B,sleep as Q,hashString as Mt,sleepEx as ae,formatDate as le,throttle as re,debounce as ie,isString as ue,isUCRuleStringArray as ce}from"./util.js";import{createStore as At,del as Dt,get as Vt,set as Nt,entries as qt}from"./idb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function e(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=e(l);fetch(l.href,a)}})();const Bt={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},it=m(Bt.input_only),ut=m(Bt.input_ignore),de=S(()=>{let n=it.value.trim().split(/\s+/g).filter(l=>l),t=ut.value.trim().split(/\s+/g).filter(l=>l);n=n.map(l=>l.toLowerCase()),t=t.map(l=>l.toLowerCase());let e,o;return e=l=>n.some(a=>l.toLowerCase().includes(a)),o=l=>t.some(a=>l.toLowerCase().includes(a)),{matchOnly:e,matchIgnore:o,onlyParts:n,ignoreParts:t}}),pe=S(()=>{const{matchOnly:n,matchIgnore:t,onlyParts:e}=de.value;return e.length?o=>n(o):o=>!t(o)}),jt=n=>(K("data-v-534dce17"),n=n(),X(),n),fe={class:"row row-cols-lg-3 g-3 align-items-center","data-component":"Filters"},me={class:"col-12"},ve={class:"input-group"},ge=jt(()=>s("span",{class:"input-group-text"},"Only",-1)),_e={class:"col-12"},he={class:"input-group"},ye=jt(()=>s("span",{class:"input-group-text"},"Ignore",-1)),be=k({__name:"Filters",setup(n){return(t,e)=>(f(),h("div",fe,[s("div",me,[s("label",null,[s("span",ve,[ge,N(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=o=>ot(it)?it.value=o:null)},null,512),[[z,p(it)]])])])]),s("div",_e,[s("label",null,[s("span",he,[ye,N(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=o=>ot(ut)?ut.value=o:null)},null,512),[[z,p(ut)]])])])])]))}}),x=(n,t)=>{const e=n.__vccOpts||n;for(const[o,l]of t)e[o]=l;return e},Ce=x(be,[["__scopeId","data-v-534dce17"]]),$e={};function we(n,t){return f(),A(St,{to:"body"},[Rt(n.$slots,"default")])}const bt=x($e,[["render",we]]);function Se(n){const t=n.split(`
`).map(o=>o.trim()).filter(o=>o),e=[];for(const o of t){const[l,...a]=o.split(/\s+(#|\/\/)/),[u,...r]=l.trim().split(/\s+/);if(u.startsWith("http")){const i=Ct(u);if(i&&r.every(d=>!Ct(d))){e.push({url:i,inputComment:[...r,...a].join(" ")});continue}i&&e.push({url:i})}else r.unshift(u);for(const i of r){const d=Ct(i);d&&e.push({url:d})}}return e}function Ct(n){const t=n.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t?.groups)return t.groups.url}const ct={createStore:At,del:Dt,get:Vt,set:Nt,entries:qt},dt=ct.createStore("HrefListerUrlInfo","UrlInfo"),Ft=class nt{constructor({url:t,inputComment:e,urlOrigin:o},l){this.url=t,this.state=l,e&&(this.inputComment=e),l.visited&&(this.initialVisited=l.visited),o&&(this.urlOrigin=o)}static async getInstance(t){const e=t.urlOrigin||t.url;let o=nt.stateMap.get(e);return o?new nt(t,o):(o=await ct.get(e,dt),o===void 0&&(o={}),nt.stateMap.set(e,o),new nt(t,o))}isEquals(t){return t?this.state===t.state&&this.inputComment===t.inputComment:!1}get comment(){return this.state.comment}get visited(){return this.state.visited}get tags(){return this.state.tags}async setComment(t){this.state.comment=t,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(t){this.state.visited=t,await this.update()}async delVisited(){delete this.state.visited,await this.update()}async addTag(t){this.state.tags||(this.state.tags=[]),!this.state.tags.includes(t)&&(this.state.tags.push(t),await this.update())}async delTag(t){if(!this.state.tags)return;const e=this.state.tags.indexOf(t);e!=-1&&(this.state.tags.splice(e,1),this.state.tags.length===0&&delete this.state.tags,await this.update())}update(){return Object.keys(this.state).length?ct.set(this.urlOrigin||this.url,W(this.state),dt):ct.del(this.urlOrigin||this.url,dt)}};Ft.stateMap=new Map;let Wt=Ft;Object.assign(globalThis,{idb:{createStore:At,del:Dt,get:Vt,set:Nt,entries:qt,urlInfoStore:dt},UrlEntry:Wt});const Te=-1,P=m(""),O=m(null),M=m(null),pt=m(new Set),J=m(!1),Y=m(!1),$t=m(!1),ke=m(!1);async function It(){$t.value=!0,J.value&&(J.value=!1,await Q(),J.value=!0)}async function Ut(){ke.value=!0,Y.value&&(Y.value=!1,await Q(),Y.value=!0)}const F=m(!0),ft=m(!0),I=m(null);function ht(n,t){const e=localStorage.getItem(n),o=Gt(e===null?typeof t=="function"?t():t:JSON.parse(e));return q(o,()=>{localStorage.setItem(n,JSON.stringify(o))}),o}const Ie=gt(ht("href-lister-clicker-settings",{delay:1,count:0})),mt=gt(ht("href-lister-url-cleaner-settings",()=>{const n=["site:youtube.com","trim-search-params:feature t si","site:t.umblr.com","filter-start:https://t.umblr.com/redirect","search-param:z","recursive","site:deviantart.com","trim-start:https://www.deviantart.com/users/outgoing?","decode-url","recursive"];return{ucRuleStrings:n,ucCompiledRules:B.compileRuleStrings(n)}})),Jt=m(B.fromRuleRecords(mt.ucCompiledRules.value));q(mt.ucCompiledRules,()=>{Jt.value=B.fromRuleRecords(mt.ucCompiledRules.value)});const vt=gt(ht("href-lister-url-origin-settings",()=>{const n=["site:cdn.discordapp.com","trim-search-params:ex is hm"];return{ucRuleStrings:n,ucCompiledRules:B.compileRuleStrings(n)}})),Yt=m(B.fromRuleRecords(vt.ucCompiledRules.value));q(vt.ucCompiledRules,()=>{Yt.value=B.fromRuleRecords(vt.ucCompiledRules.value)});const st=gt(ht("href-lister-common-settings",{useCleaner:!0,useOriginer:!0})),{useCleaner:Ue,useOriginer:xe}=st,Ht=m([]);at(async()=>{const n=Se(P.value),t=[];for(const e of n){e.url=Ue.value?Jt.value.clean(e.url):e.url;const o=xe.value?Yt.value.clean(e.url):e.url;o!==e.url&&(e.urlOrigin=o),t.push(await Wt.getInstance(e))}Ht.value=t});const zt=S(()=>Ht.value.filter(n=>pe.value(n.url))),H=S(()=>{const n=zt.value.map(t=>t.url);return globalThis.__urls=n,n});location.href==="http://localhost:5173/"&&(P.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
http://localhost:5173/#www
https://www.youtube.com/watch?feature=player_embedded&v=Qwert123`);function Le(n,t=100){const e=r=>`${r.length?'["'+r.join('", "')+'"]':"[]"}`;if(n.length<=t)return`/* ${n.length.toString().padStart(3)} */ ${e(n)},`;const o=r=>r.toString().length,l=Math.trunc(n.length/t),u=[`/* ${n.length.toString().padStart(1+o(n.length))+" ".repeat(3+o(l))} */`];for(let r=0;r<=l;r++){const i=n.slice(t*r,t+t*r),d=`(${r+1})`.padStart(2+o(l)),b=i.length.toString().padStart(1+o(n.length));u.push(`/* ${b} ${d} */ ${e(i)},`)}return u.join(`
`)}function Pe(n){const t=Date.now(),e=Math.trunc((t-n)/1e3);if(e<60)return`${e} second${e>1?"s":""} ago`;if(e<60*60){const o=Math.trunc(e/60);return`${o} minute${o>1?"s":""} ago`}if(e<60*60*24){const o=Math.trunc(e/60%60).toString().padStart(2,"0");return`${Math.trunc(e/60/60)}:${o} ago`}return Math.trunc(e/60/60/24)+" days ago"}const xt=["1st","2nd","3rd"];function Ee(n){return n=Number(n),xt[n]?xt[n]:n+1+"th"}function Re(n,t,e){const o=document.createElement("a");o.setAttribute("download",t||"");const l=URL.createObjectURL(n);o.href=l+(e?"#"+e:""),o.click(),setTimeout(()=>URL.revokeObjectURL(l),15e3)}Object.assign(globalThis,{downloadBlob:Re});const yt=n=>(K("data-v-79a16a9a"),n=n(),X(),n),Oe={class:"row row-cols-lg-3 g-3 align-items-end","data-component":"InputControls"},Me={class:"input col-12"},Ae=yt(()=>s("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),De=["disabled"],Ve={class:"input col-12"},Ne={class:"row"},qe={class:"line m-1"},Be=yt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1"},"Clipboard")],-1)),je=["disabled"],Fe=["disabled"],We={class:"line m-1"},Je=yt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Controls")],-1)),Ye=["disabled"],He={class:"input col-12",style:{"align-self":"end"}},ze={class:"row"},Ke={class:"line m-1"},Xe=yt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Popups")],-1)),Qe=k({__name:"InputControls",setup(n){const t=new WeakMap;async function e(c,{klass:v="btn-active",time:y=180}={}){c.classList.add(v);const R=Q(y);t.set(c,R),await R,t.get(c)===R&&c.classList.remove(v)}const o=m(null);function l(c){P.value="",o.value?.focus(),d(),e(c.currentTarget)}function a(c){navigator.clipboard.writeText(H.value.join(" ")),e(c.currentTarget)}function u(c){c.preventDefault(),navigator.clipboard.writeText(H.value.join(`
`)),e(c.currentTarget)}function r(c){c.button===1&&(c.preventDefault(),navigator.clipboard.writeText(Le(H.value)),e(c.currentTarget))}let i=null;function d(){i=null}function b(c,v){const y=i,{hash:R,size:Z}={hash:Mt(c),size:c.length};return i={hash:R,size:Z,type:v},y?y.type==="append"&&v==="replace"?P.value===c:Z===y.size&&R===y.hash:!1}async function $(c){const{currentTarget:v}=c,y=await navigator.clipboard.readText();if(b(y,"append")){e(v,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",y),P.value&&!P.value.endsWith(`
`)&&(P.value+=`
`),P.value+=y,e(v)}async function L(c){const{currentTarget:v}=c,y=await navigator.clipboard.readText();if(b(y,"replace")){e(v,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",y),P.value=y,e(v)}const{useCleaner:C,useOriginer:g}=st;return(c,v)=>(f(),h("div",Oe,[s("div",Me,[Ae,N(s("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":v[0]||(v[0]=y=>ot(P)?P.value=y:null),ref_key:"textareaEl",ref:o,onInput:d,disabled:!p(F)},null,40,De),[[z,p(P)]])]),s("div",Ve,[s("span",Ne,[s("span",qe,[Be,s("button",{class:"btn btn-outline-primary",onClick:L,disabled:!p(F)},"Replace",8,je),s("button",{class:"btn btn-outline-primary",onClick:$,disabled:!(p(F)||p(ft))},"Append",8,Fe)]),s("span",We,[Je,s("button",{class:"btn btn-outline-danger",onClick:l,disabled:!p(F)},"Clear",8,Ye),s("button",{class:"btn btn-primary",title:"Copy URLs",onClick:a,onContextmenu:u,onPointerdown:r},"Copy",32)])])]),s("div",He,[s("span",ze,[s("span",Ke,[Xe,s("button",{class:"btn btn-outline-primary",title:"Toggle Auto Clicker Popup",onClick:v[1]||(v[1]=y=>J.value=!p(J)),onContextmenu:v[2]||(v[2]=lt((...y)=>p(It)&&p(It)(...y),["prevent"]))},"Auto Clicker",32),s("button",{class:D(["btn btn-outline-primary",{"turned-off":!p(C)&&!p(g)}]),title:"Toggle Url Cleaner Popup",onClick:v[3]||(v[3]=y=>Y.value=!p(Y)),onContextmenu:v[4]||(v[4]=lt((...y)=>p(Ut)&&p(Ut)(...y),["prevent"]))},"Url Magic",34)])])])]))}}),Ge=x(Qe,[["__scopeId","data-v-79a16a9a"]]),Lt=S(()=>{const n=[...new Set(H.value)].sort().join(" ");return Math.abs(Mt(n)).toString(16).slice(-8).padStart(8,"0").toUpperCase()}),tt=S(()=>{const n=H.value,t=n.length,e=new Set(n).size;return{count:t,uniqueCount:e}}),V=S(()=>{let n=0;const t=new Set;for(const e of H.value)pt.value.has(e)&&(n++,t.add(e));return{count:n,uniqueCount:t.size}}),G=n=>(K("data-v-5a4c63d0"),n=n(),X(),n),Ze={"data-component":"URLsInfoLine"},tn={title:"URLs count"},en={key:0,title:"URLs count (unique)"},nn=G(()=>s("span",{class:"grey"}," — ",-1)),sn={title:"URLs hash"},on=G(()=>s("span",{class:"grey"},"#",-1)),an={class:"urls-hash"},ln={key:0},rn=G(()=>s("span",{class:"grey"}," — ",-1)),un=G(()=>s("span",{class:"grey"},"[",-1)),cn={class:"clicked-count"},dn={title:"Clicked URLs count"},pn={key:0,title:"Clicked URLs count (unique)"},fn=G(()=>s("span",{class:"grey"},"]",-1)),mn=G(()=>s("span",{class:"grey"}," — ",-1)),vn=["title"],gn=k({__name:"URLsInfoLine",setup(n){at(()=>{const{count:a,uniqueCount:u}=tt.value;if(!a){document.title="HrefLister";return}if(document.title=`HrefLister — ${t(a,u)} — #${Lt.value}`,V.value.count){const{count:r,uniqueCount:i}=V.value;document.title=`${document.title} — [ ${t(r,i)} ]`}});function t(a,u){let r=a.toString();return a!==u&&(r=`${r} (${u})`),r}async function e(){if(!I.value)return;const a=I.value.elem;a.scrollIntoView({block:"center"}),a.classList.add("highlighted-2"),await Q(800),a.classList.remove("highlighted-2")}function o(){I.value&&I.value.elem.classList.add("highlighted-1")}function l(){I.value&&I.value.elem.classList.remove("highlighted-1")}return(a,u)=>(f(),h("div",Ze,[s("span",null,[s("span",tn,T(p(tt).count),1),p(tt).count!==p(tt).uniqueCount?(f(),h("span",en," ("+T(p(tt).uniqueCount)+")",1)):E("",!0)]),nn,s("span",sn,[on,s("span",an,T(p(Lt)),1)]),p(V).count?(f(),h("span",ln,[rn,s("span",null,[un,s("span",cn,[s("span",dn,T(p(V).count),1),p(V).count!==p(V).uniqueCount?(f(),h("span",pn," ("+T(p(V).uniqueCount)+")",1)):E("",!0)]),fn])])):E("",!0),p(I)?(f(),h("span",{key:1,onClick:e,onPointerenter:o,onPointerleave:l},[mn,s("span",{class:"grey",title:`Last clicked URL index
`+p(I).entry.url},T(p(Ee)(p(I).index)),9,vn)],32)):E("",!0)]))}}),_n=x(gn,[["__scopeId","data-v-5a4c63d0"]]),hn={"data-component":"AutoClickPopup"},yn={class:"popup-content"},bn={class:"btn-group p-1 container"},Cn=["disabled"],$n=["disabled"],wn=["disabled"],Sn={class:"div-wrap"},Tn={class:"p-1 pt-0 col-12"},kn={class:"input-group"},In=s("span",{class:"input-group-text col-3"},"Delay",-1),Un={class:"div-wrap"},xn={class:"p-1 pt-0 col-12"},Ln={class:"input-group"},Pn=s("span",{class:"input-group-text col-3"},"Count",-1),En=k({__name:"AutoClickPopup",props:["fancyPopupSlotProps"],setup(n){const t=n,{headerElem:e}=t.fancyPopupSlotProps,{delay:o,count:l}=Ie,a=m("ready"),u=m(0);let r=new AbortController;q(a,()=>{a.value==="ready"?ft.value=F.value=!0:a.value==="started"?ft.value=F.value=!1:a.value==="paused"&&(ft.value=!0)});async function i(){console.log("startClicking");const g=[...document.querySelectorAll("a.url")],c=l.value===0?g.length:Math.min(g.length,l.value+u.value),v=c<g.length;for(a.value="started";u.value<c;){const y=g[u.value],R=y.closest('[data-comp="UrlListItem"]');if(R.classList.add("hover"),await ae(o.value*1e3,r.signal),R.classList.remove("hover"),a.value==="started")u.value++,y.dispatchEvent(new MouseEvent("click")),await Q();else if(a.value==="paused"){a.value="paused";return}else if(a.value==="stopped"){u.value=0,a.value="ready";return}}v?a.value="paused":(u.value=0,a.value="ready")}function d(g){u.value===0&&(g="stopped"),a.value=g,r.abort(g),r=new AbortController}function b(){if(a.value==="started"){d("stopped");return}u.value=0,a.value="ready"}let $;function L(){if(I.value&&a.value!=="ready"){const g=I.value.elem.nextElementSibling;g&&(g.classList.add("highlighted-1"),$=g)}else{const g=document.querySelector('[data-comp="UrlListItem"]');g&&(g.classList.add("highlighted-1"),$=g)}}function C(){$&&($.classList.remove("highlighted-1"),$=null)}return(g,c)=>(f(),h("div",hn,[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:e},"Auto Clicker",512),s("div",yn,[s("div",bn,[s("button",{class:"btn btn-primary col-4",onClick:i,onPointerenter:L,onPointerleave:C,disabled:!(a.value==="ready"||a.value==="paused")},T(a.value==="ready"||!u.value?"Start":"Next"),41,Cn),s("button",{class:"btn btn-secondary col-4",disabled:a.value!=="started",onClick:c[0]||(c[0]=v=>d("paused"))},"Pause",8,$n),s("button",{class:"btn btn-secondary col-4",disabled:!u.value,onClick:b},T(a.value==="paused"?"Reset":"Stop"),9,wn)]),s("div",Sn,[s("label",Tn,[s("span",kn,[In,N(s("input",{title:"Click delay (seconds)",class:"form-control",type:"number","onUpdate:modelValue":c[1]||(c[1]=v=>ot(o)?o.value=v:null)},null,512),[[z,p(o)]])])])]),s("div",Un,[s("label",xn,[s("span",Ln,[Pn,N(s("input",{title:"Count",class:"form-control",type:"number","onUpdate:modelValue":c[2]||(c[2]=v=>ot(l)?l.value=v:null)},null,512),[[z,p(l)]])])])])])]))}}),Tt=1e3*60,Pt=Tt*10,wt=Tt*60,Rn=wt*24;class On{constructor(t){this.timeRef=t,q(t,e=>{e>0&&this.setTimer()}),Zt(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let e;if(t<Pt)e=Tt;else if(t<wt)e=Pt;else if(t<Rn)e=wt;else return;this.timerId=setTimeout(()=>{kt(this.timeRef),this.setTimer()},e)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){kt(this.timeRef),this.setTimer()}}const Mn=n=>(K("data-v-4e3c64e7"),n=n(),X(),n),An={class:"tags"},Dn={class:"tag-master","data-comp":"EntryTags"},Vn=["data-tag"],Nn={key:0,class:"tag add-tag"},qn=Mn(()=>s("span",{class:"plus"},"+",-1)),Bn=[qn],jn=k({__name:"UrlListItemTags",props:{ue:{}},setup(n){const t=n;function e(){W(M.value)===W(t.ue)?M.value=null:M.value=t.ue,console.log(W(M.value))}return(o,l)=>(f(),h("div",{class:"tags-wrapper",onClick:e,"data-component":"UrlListItemTags"},[s("div",An,[s("div",Dn,[(f(!0),h(rt,null,_t(o.ue.tags,a=>(f(),h("div",{class:"tag","data-tag":a},T(a),9,Vn))),256))])]),o.ue.tags?.length?E("",!0):(f(),h("div",Nn,Bn))]))}}),Fn=x(jn,[["__scopeId","data-v-4e3c64e7"]]),Wn=["data-index"],Jn={class:"col-9 nowrap-text-ceil url url-cell"},Yn={class:"nowrap-text-ceil-content"},Hn=["title"],zn=["href","title","data-url-origin"],Kn={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},Xn=k({__name:"UrlListItem",props:{ue:{},index:{}},setup(n){const t=n,e=S(()=>t.ue.visited||Te);function o(){t.ue.delVisited()}function l(){const _=Date.now();t.ue.setVisited(_)}function a(_){_.button===1&&(_.preventDefault(),o())}const u=S(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),r=S(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function i(){W(O.value)===W(t.ue)?O.value=null:O.value=t.ue}const d=m(),b=S(()=>pt.value.has(t.ue.url));function $(){pt.value.add(t.ue.url),l(),I.value={entry:t.ue,index:t.index,elem:d.value}}function L(_){_.button!==1||document.getRootNode().activeElement!==_.currentTarget||$()}function C(){pt.value.delete(t.ue.url)}const g=S(()=>{const _=I.value;return _?t.index===_.index&&t.ue.isEquals(_.entry):!1});te(()=>{g.value&&(I.value=null)});const c=new On(e);function v(){c.forceTrigger()}const y=re(v,2e3),R=S(()=>{let _=`№ ${t.index+1}.
`;return e.value<0?_+="never clicked":_+=Z(e.value),t.ue.initialVisited&&t.ue.initialVisited!==e.value?`${_}
${Z(t.ue.initialVisited)}`:_});function Z(_){return Pe(_)+" — "+le(_,"YYYY.MM.DD HH:mm:SS",!1)}const Xt=S(()=>Qt(e.value));function Qt(_){if(_<0)return"never-clicked";const j=Date.now(),w=Math.trunc((j-_)/1e3);return w<60?"minute-1":w<60*2?"minute-2":w<60*5?"minute-5":w<60*10?"minute-10":w<60*30?"minute-30":w<60*45?"minute-45":w<60*60?"minute-60":w<3600*2?"hour-2":w<3600*4?"hour-4":w<3600*8?"hour-8":w<3600*14?"hour-14":w<3600*24?"day-1":w<86400*7?"day-7":w<86400*30?"month-1":w<2592e3*3?"month-3":w<2592e3*6?"month-6":"long-ago"}return(_,j)=>(f(),h("tr",{onPointerenter:j[0]||(j[0]=(...w)=>p(y)&&p(y)(...w)),"data-index":_.index+1,class:D([{clicked:b.value,"last-clicked":g.value},"list-item-row"]),"data-component":"UrlListItem",ref_key:"htmlCompRef",ref:d},[s("td",Jn,[s("span",Yn,[s("span",{class:D(["info-dot",{"has-comment":_.ue.inputComment,visited:e.value>0,[Xt.value]:!0}]),title:R.value,onContextmenu:lt(C,["prevent"]),onPointerdown:a},null,42,Hn),s("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:_.ue.url,title:_.ue.inputComment||_.ue.urlOrigin,"data-url-origin":_.ue.urlOrigin,onClick:$,onPointerup:L},T(_.ue.url),41,zn)]),U(Fn,{class:"tags",ue:_.ue},null,8,["ue"])]),s("td",{class:D(["col-3 comment nowrap-text-ceil",{[u.value]:u.value}]),onDblclick:i},[s("span",Kn,T(r.value||" "),1)],34)],42,Wn))}}),Qn=x(Xn,[["__scopeId","data-v-c707c6b2"]]),Gn={"data-component":"UrlList"},Zn={class:"table table-borderless"},ts=k({__name:"UrlList",setup(n){return(t,e)=>(f(),h("div",Gn,[s("table",Zn,[s("tbody",null,[(f(!0),h(rt,null,_t(p(zt),(o,l)=>(f(),A(Qn,{ue:o,index:l,key:l+o.url},null,8,["ue","index"]))),128))])])]))}}),es={class:"popup-content"},ns={class:"modal-content"},ss={class:"modal-header"},os={class:"modal-title"},as={class:"modal-body"},ls=["value"],rs=k({__name:"MessageEditPopup",setup(n){const t=S(()=>{const i=O.value;return i.comment===void 0?i.inputComment:i.comment});function e(i){i.currentTarget===i.target&&(O.value=null)}function o(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),O.value=null)}const l=m(null);Ot(()=>{l.value?.focus()});function u(i){const d=i.currentTarget.value;O.value?.setComment(d)}function r(){O.value?.delComment()}return(i,d)=>p(O)?(f(),h("div",{key:0,class:"modal message-edit-popup","data-component":"MessageEditPopup",onPointerdown:e},[s("div",es,[s("div",ns,[s("div",ss,[s("h5",os,T(p(O).url),1),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e})]),s("div",as,[s("textarea",{rows:"5",value:t.value,onInput:u,ref_key:"textareaElem",ref:l,onKeydown:o},null,40,ls)]),s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary",onClick:r},"Reset")])])])],32)):E("",!0)}}),is=x(rs,[["__scopeId","data-v-df3d2981"]]);function us(n,t){for(const[e,o]of Object.entries(t))n.style[e]=o}function cs(n,{handle:t,onStop:e,onMove:o,state:l}={}){const a=r=>{o?.(r),us(n,r)};l&&(a(l),e?.(l));const u=t||n;u.style.userSelect="none",u.style.touchAction="none",n.style.position="absolute",u.addEventListener("pointerdown",r=>{r.preventDefault();const i=r.clientY-parseInt(getComputedStyle(n).top),d=r.clientX-parseInt(getComputedStyle(n).left);let b;function $(C){!u.hasPointerCapture(C.pointerId)&&u.setPointerCapture(C.pointerId),b={top:C.clientY-i+"px",left:C.clientX-d+"px"},a(b)}function L(){removeEventListener("pointermove",$),b&&e?.(b)}addEventListener("pointermove",$,{passive:!0}),addEventListener("pointerup",L,{once:!0})})}function ds({id:n,onMove:t,onStop:e,reset:o,restore:l}){if(o&&n&&localStorage.removeItem(n),!l||!n)return{onMove:t,onStop:e};const a=localStorage.getItem(n);let u;a&&(u=JSON.parse(a));function r(d){localStorage.setItem(n,JSON.stringify(d))}let i;return e?i=function(d){e(d),r(d)}:i=r,{onMove:t,onStop:i,state:u}}const ps={"data-component":"FancyPopup",class:"popup-root"},Kt=k({__name:"FancyPopup",props:{id:{},header:{}},setup(n){const t=n,e=m(),o=m(),l={headerElem:o};at(()=>{t.header&&(o.value=t.header)});const a=at(()=>{if(!e.value||!o.value)return;const b=e.value,$=o.value;cs(e.value,{handle:$,...ds({restore:!0,id:`href-lister-${t.id}-popup-move-state`,reset:$t.value})}),$.addEventListener("pointerdown",L=>{b.focus()},{passive:!0}),$t.value=!1,a()}),u=m(!1);let r=0;function i(){u.value=!0,setTimeout(()=>clearTimeout(r))}function d(){r=setTimeout(()=>{u.value=!1},250)}return(b,$)=>(f(),h("div",ps,[s("div",{class:D(["popup",{focus:u.value}]),tabindex:"-1",ref_key:"popupElem",ref:e,onFocusin:i,onFocusout:d},[Rt(b.$slots,"default",{fancyPopupSlotProps:l})],34)]))}}),fs={"data-component":"UrlCleanerConfig",class:"url-cleaner"},ms={class:"warning"},vs=k({__name:"UrlCleanerConfig",props:{ucSettings:{},btnInsertPlace:{}},setup(n){const t=n,{ucRuleStrings:e,ucCompiledRules:o}=t.ucSettings,l=m(null),a=m(!0),u=m(!0),r=m(""),i=m("");let d="";const b=ie(L,220);q(e,()=>{i.value=C(e.value),d=i.value,q(i,b)},{immediate:!0});async function $(){const g=l.value;g.blur(),e.value=JSON.parse(i.value),o.value=B.compileRuleStrings(e.value),d=i.value,g.classList.add("btn-outline-success"),await Q(800),a.value=!0,g.classList.remove("btn-outline-success")}function L(){if(l.value){if(i.value===d){a.value=!0,u.value=!0,r.value="";return}u.value=!1,a.value=!1;try{const c=JSON.parse(i.value);if(!Array.isArray(c)){r.value="Not an array";return}if(c.length!==c.flat().length){r.value="Array is not flat";return}if(!c.every(ue)){r.value="Array is not string one";return}if(!ce(c)){r.value="Wrong data in the rule string array";return}u.value=!0,r.value=""}catch{r.value="Incorrect JSON"}}}function C(g){let c=JSON.stringify(g,null,4);return c=c.replaceAll('    "site','"site'),c}return(g,c)=>(f(),h("div",fs,[N(s("textarea",{spellcheck:"false",id:"editor",class:"form-control","onUpdate:modelValue":c[0]||(c[0]=v=>i.value=v)},null,512),[[z,i.value]]),(f(),A(St,{to:g.btnInsertPlace},[s("button",{ref_key:"saveBtn",ref:l,id:"save",class:D(["btn btn-outline-primary",{disabled:a.value||!u.value}]),onClick:$},"Save",2)],8,["to"])),s("span",ms,T(r.value),1)]))}}),Et=x(vs,[["__scopeId","data-v-3a85e8c2"]]),gs=n=>(K("data-v-3131c85d"),n=n(),X(),n),_s={class:"popup-content"},hs={class:"p-1 flex"},ys=gs(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Configs")],-1)),bs={class:"btn-group"},Cs={key:0,class:"ready-required"},$s={key:0},ws={key:1},Ss=k({__name:"UrlMagicPopup",setup(n){const t=m(null),e=m("cleaner"),o=m(null),l=m(!1);at(()=>{o.value&&(l.value=!0)});const{useCleaner:a,useOriginer:u}=st;function r(i){st[i].value=!st[i].value}return(i,d)=>N((f(),A(Kt,{"data-slot-component":"UrlCleanerPopup",id:"url-cleaner",header:t.value},{default:et(()=>[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Url Magic Transforms",512),s("div",_s,[s("div",hs,[ys,s("span",bs,[s("button",{title:"Rule String Array based config",class:D(["btn btn-outline-primary",{active:e.value==="cleaner","turned-off":!p(a)}]),onClick:d[0]||(d[0]=b=>e.value="cleaner"),onContextmenu:d[1]||(d[1]=lt(()=>r("useCleaner"),["prevent"]))},"Url Cleaner",34),s("button",{title:"Rule String Array based config",class:D(["btn btn-outline-primary",{active:e.value==="originer","turned-off":!p(u)}]),onClick:d[2]||(d[2]=b=>e.value="originer"),onContextmenu:d[3]||(d[3]=lt(()=>r("useOriginer"),["prevent"]))},"Url Origin",34)]),s("span",{style:{"margin-left":"auto"},class:"btn-insert-place",ref_key:"btnInsertPlace",ref:o},null,512)]),l.value?(f(),h("div",Cs,[e.value==="cleaner"?(f(),h("div",$s,[U(Et,{ucSettings:p(mt),btnInsertPlace:o.value},null,8,["ucSettings","btnInsertPlace"])])):(f(),h("div",ws,[U(Et,{ucSettings:p(vt),btnInsertPlace:o.value},null,8,["ucSettings","btnInsertPlace"])]))])):E("",!0)])]),_:1},8,["header"])),[[ee,l.value]])}}),Ts=x(Ss,[["__scopeId","data-v-3131c85d"]]),ks={class:"selected-tags","data-component":"SelectedTags"},Is=["data-tag"],Us={class:"input-wrapper"},xs=["value"],Ls=k({__name:"SelectedTags",props:{entry:{},modelValue:{}},emits:["update:modelValue","tabPressed"],setup(n,{emit:t}){const e=n,o=t;function l(C){const c=C.target.dataset.tag;c&&e.entry?.delTag(c)}const a=m(null),r=document.createElement("canvas").getContext("2d");Ot(()=>{a.value&&(r.font=window.getComputedStyle(a.value).font)});function i(){if(!a.value)return;const C=r.measureText(a.value.value).width;a.value.style.width=C+6+"px"}function d(){a.value&&(a.value.selectionStart=a.value.selectionEnd,a.value.focus())}function b(){a.value?.select()}function $(C){o("update:modelValue",C.target.value)}function L(C){console.log(C),C.code==="Tab"&&(C.preventDefault(),o("tabPressed"))}return(C,g)=>(f(),h("div",ks,[s("div",{class:"tag-master",onClick:l},[(f(!0),h(rt,null,_t(C.entry.tags,c=>(f(),h("div",{class:"tag","data-tag":c},T(c),9,Is))),256))]),s("span",{class:"label",onDblclick:b,onClick:d},[s("span",Us,[s("input",ne({type:"text",ref_key:"tagInput",ref:a,value:C.modelValue},se({input:[i,$]}),{onKeydown:L}),null,16,xs)])],32)]))}}),Ps=x(Ls,[["__scopeId","data-v-e7123225"]]),Es=["data-tag"],Rs=k({__name:"SuggestedTag",props:{tagWrap:{}},setup(n){const t=n,{entry:e,tag:o}=t.tagWrap,l=S(()=>!!e.tags?.includes(o));function a(){l.value?e.delTag(o):e.addTag(o)}return(u,r)=>(f(),h("div",{class:D(["tag",{selected:l.value}]),onClick:a,"data-tag":u.tagWrap.tag,"data-component":"SuggestedTag"},T(u.tagWrap.tag),11,Es))}}),Os=x(Rs,[["__scopeId","data-v-6a5a5388"]]);function Ms(){return JSON.parse(localStorage.getItem("href_lister_all_tags")||"[]")}const As=m(Ms()),Ds={class:"popup-content"},Vs={class:"modal-content"},Ns={class:"modal-header"},qs={class:"modal-title"},Bs={class:"modal-body"},js={class:"tags selected-tags-group"},Fs={class:"tags all-tags-group"},Ws={class:"tag-master"},Js=k({__name:"UrlEntryTagsEditPopup",setup(n){const t=m(""),e=M,o=S(()=>As.value.map(r=>({tag:r,entry:e.value}))),l=S(()=>{const r=[],i=[];for(const d of o.value){const b=d.tag.indexOf(t.value);b!==-1&&(b===0?r.push(d):i.push(d))}return[r,i].flat()});function a(){t.value=""}function u(r){r.currentTarget===r.target&&(M.value=null)}return(r,i)=>(f(),A(St,{to:"body"},[p(M)?(f(),h("div",{key:0,class:"modal tags-edit-popup",onPointerdown:u,"data-component":"URLsInfoLine"},[s("div",Ds,[s("div",Vs,[s("div",Ns,[s("h5",qs,T(p(M).url),1)]),s("div",Bs,[s("div",js,[U(Ps,{entry:p(M),modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=d=>t.value=d),onTabPressed:a},null,8,["entry","modelValue"])]),s("div",Fs,[s("div",Ws,[(f(!0),h(rt,null,_t(l.value,d=>(f(),A(Os,{"tag-wrap":d},null,8,["tag-wrap"]))),256))])])])])])],32)):E("",!0)]))}}),Ys=x(Js,[["__scopeId","data-v-da70caf4"]]),Hs={"data-component":"Main"},zs=s("hr",null,null,-1),Ks=s("hr",null,null,-1),Xs=s("hr",null,null,-1),Qs=s("hr",null,null,-1),Gs=k({__name:"Main",setup(n){return(t,e)=>(f(),h("div",Hs,[zs,U(Ce),Ks,U(Ge),Xs,U(_n),Qs,U(ts),p(M)?(f(),A(Ys,{key:0})):E("",!0),p(O)?(f(),A(bt,{key:1},{default:et(()=>[U(is)]),_:1})):E("",!0),p(J)?(f(),A(bt,{key:2},{default:et(()=>[U(Kt,{id:"auto-clicker"},{default:et(({fancyPopupSlotProps:o})=>[U(En,{fancyPopupSlotProps:o},null,8,["fancyPopupSlotProps"])]),_:1})]),_:1})):E("",!0),p(Y)?(f(),A(bt,{key:3},{default:et(()=>[U(Ts)]),_:1})):E("",!0)]))}}),Zs=n=>(K("data-v-679e969c"),n=n(),X(),n),to=Zs(()=>s("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister",target:"_blank"},[s("i",null,"i")],-1)),eo=k({__name:"App",setup(n){return(t,e)=>(f(),h(rt,null,[U(Gs),to],64))}}),no=x(eo,[["__scopeId","data-v-679e969c"]]);oe(no).mount("#app");
//# sourceMappingURL=index.js.map
