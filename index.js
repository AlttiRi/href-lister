import{ref as v,computed as w,defineComponent as k,openBlock as m,createElementBlock as b,createBaseVNode as n,withDirectives as N,vModelText as J,unref as c,isRef as et,pushScopeId as Y,popScopeId as z,createBlock as P,renderSlot as Rt,Teleport as wt,toRaw as W,toRefs as pt,watch as q,watchEffect as mt,reactive as Xt,withModifiers as nt,normalizeClass as D,toDisplayString as T,createCommentVNode as E,onUnmounted as Zt,triggerRef as It,Fragment as st,renderList as ft,onBeforeUnmount as te,createVNode as x,onMounted as Ot,vShow as ee,withCtx as Z,mergeProps as ne,toHandlers as se,createApp as oe}from"./vue.js";import{UrlCleaner as B,sleep as vt,hashString as Mt,formatDate as ae,throttle as le,makeFocusable as re,getPopupEnh as ie,debounce as ue,isString as ce,isUCRuleStringArray as de,sleepEx as pe}from"./util.js";import{createStore as At,del as Dt,get as Vt,set as Nt,entries as qt}from"./idb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function e(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=e(o);fetch(o.href,l)}})();const Bt={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},ot=v(Bt.input_only),at=v(Bt.input_ignore),me=w(()=>{let s=ot.value.trim().split(/\s+/g).filter(o=>o),t=at.value.trim().split(/\s+/g).filter(o=>o);s=s.map(o=>o.toLowerCase()),t=t.map(o=>o.toLowerCase());let e,a;return e=o=>s.some(l=>o.toLowerCase().includes(l)),a=o=>t.some(l=>o.toLowerCase().includes(l)),{matchOnly:e,matchIgnore:a,onlyParts:s,ignoreParts:t}}),fe=w(()=>{const{matchOnly:s,matchIgnore:t,onlyParts:e}=me.value;return e.length?a=>s(a):a=>!t(a)}),jt=s=>(Y("data-v-9c460a67"),s=s(),z(),s),ve={class:"row row-cols-lg-3 g-3 align-items-center","data-component":"Filters"},_e={class:"col-12"},ge={class:"input-group"},he=jt(()=>n("span",{class:"input-group-text"},"Only",-1)),be={class:"col-12"},ye={class:"input-group"},Ce=jt(()=>n("span",{class:"input-group-text"},"Ignore",-1)),$e=k({__name:"Filters",setup(s){return(t,e)=>(m(),b("div",ve,[n("div",_e,[n("label",null,[n("span",ge,[he,N(n("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=a=>et(ot)?ot.value=a:null)},null,512),[[J,c(ot)]])])])]),n("div",be,[n("label",null,[n("span",ye,[Ce,N(n("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=a=>et(at)?at.value=a:null)},null,512),[[J,c(at)]])])])])]))}}),S=(s,t)=>{const e=s.__vccOpts||s;for(const[a,o]of t)e[a]=o;return e},we=S($e,[["__scopeId","data-v-9c460a67"]]),Te={};function ke(s,t){return m(),P(wt,{to:"body"},[Rt(s.$slots,"default")])}const ht=S(Te,[["render",ke]]);function Ie(s){const t=s.split(`
`).map(a=>a.trim()).filter(a=>a),e=[];for(const a of t){const[o,...l]=a.split(/\s+(#|\/\/)/),[d,...i]=o.trim().split(/\s+/);if(d.startsWith("http")){const r=bt(d);if(r&&i.every(p=>!bt(p))){e.push({url:r,inputComment:[...i,...l].join(" ")});continue}r&&e.push({url:r})}else i.unshift(d);for(const r of i){const p=bt(r);p&&e.push({url:p})}}return e}function bt(s){const t=s.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t?.groups)return t.groups.url}const lt={createStore:At,del:Dt,get:Vt,set:Nt,entries:qt},rt=lt.createStore("HrefListerUrlInfo","UrlInfo"),Ft=class X{constructor({url:t,inputComment:e,urlOrigin:a},o){this.url=t,this.state=o,e&&(this.inputComment=e),o.visited&&(this.initialVisited=o.visited),a&&(this.urlOrigin=a)}static async getInstance(t){const e=t.urlOrigin||t.url;let a=X.stateMap.get(e);return a?new X(t,a):(a=await lt.get(e,rt),a===void 0&&(a={}),X.stateMap.set(e,a),new X(t,a))}isEquals(t){return t?this.state===t.state&&this.inputComment===t.inputComment:!1}get comment(){return this.state.comment}get visited(){return this.state.visited}get tags(){return this.state.tags}async setComment(t){this.state.comment=t,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(t){this.state.visited=t,await this.update()}async delVisited(){delete this.state.visited,await this.update()}async addTag(t){this.state.tags||(this.state.tags=[]),!this.state.tags.includes(t)&&(this.state.tags.push(t),await this.update())}async delTag(t){if(!this.state.tags)return;const e=this.state.tags.indexOf(t);e!=-1&&(this.state.tags.splice(e,1),this.state.tags.length===0&&delete this.state.tags,await this.update())}update(){return Object.keys(this.state).length?lt.set(this.urlOrigin||this.url,W(this.state),rt):lt.del(this.urlOrigin||this.url,rt)}};Ft.stateMap=new Map;let Wt=Ft;Object.assign(globalThis,{idb:{createStore:At,del:Dt,get:Vt,set:Nt,entries:qt,urlInfoStore:rt},UrlEntry:Wt});const Se=-1,U=v(""),L=v(null),O=v(null),it=v(new Set),yt=v(!1),Ct=v(!1),Tt={};function St(){Tt["auto-clicker"]?.()}function Ut(){Tt["url-cleaner"]?.()}const F=v(!0),ut=v(!0),I=v(null);function _t(s,t){const e=localStorage.getItem(s),a=Xt(e===null?typeof t=="function"?t():t:JSON.parse(e));return q(a,()=>{localStorage.setItem(s,JSON.stringify(a))}),a}const Ue=pt(_t("href-lister-clicker-settings",{delay:1,count:0})),ct=pt(_t("href-lister-url-cleaner-settings",()=>{const s=["site:youtube.com","trim-search-params:feature t si","site:t.umblr.com","filter-start:https://t.umblr.com/redirect","search-param:z","recursive","site:deviantart.com","trim-start:https://www.deviantart.com/users/outgoing?","decode-url","recursive"];return{ucRuleStrings:s,ucCompiledRules:B.compileRuleStrings(s)}})),Ht=v(B.fromRuleRecords(ct.ucCompiledRules.value));q(ct.ucCompiledRules,()=>{Ht.value=B.fromRuleRecords(ct.ucCompiledRules.value)});const dt=pt(_t("href-lister-url-origin-settings",()=>{const s=["site:cdn.discordapp.com","trim-search-params:ex is hm"];return{ucRuleStrings:s,ucCompiledRules:B.compileRuleStrings(s)}})),Jt=v(B.fromRuleRecords(dt.ucCompiledRules.value));q(dt.ucCompiledRules,()=>{Jt.value=B.fromRuleRecords(dt.ucCompiledRules.value)});const tt=pt(_t("href-lister-common-settings",{useCleaner:!0,useOriginer:!0})),{useCleaner:xe,useOriginer:Ee}=tt,Yt=v([]);mt(async()=>{const s=Ie(U.value),t=[];for(const e of s){e.url=xe.value?Ht.value.clean(e.url):e.url;const a=Ee.value?Jt.value.clean(e.url):e.url;a!==e.url&&(e.urlOrigin=a),t.push(await Wt.getInstance(e))}Yt.value=t});const zt=w(()=>Yt.value.filter(s=>fe.value(s.url))),H=w(()=>{const s=zt.value.map(t=>t.url);return globalThis.__urls=s,s});location.href==="http://localhost:5173/"&&(U.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
http://localhost:5173/#www
https://www.youtube.com/watch?feature=player_embedded&v=Qwert123`);function Le(s,t=100){const e=i=>`${i.length?'["'+i.join('", "')+'"]':"[]"}`;if(s.length<=t)return`/* ${s.length.toString().padStart(3)} */ ${e(s)},`;const a=i=>i.toString().length,o=Math.trunc(s.length/t),d=[`/* ${s.length.toString().padStart(1+a(s.length))+" ".repeat(3+a(o))} */`];for(let i=0;i<=o;i++){const r=s.slice(t*i,t+t*i),p=`(${i+1})`.padStart(2+a(o)),C=r.length.toString().padStart(1+a(s.length));d.push(`/* ${C} ${p} */ ${e(r)},`)}return d.join(`
`)}function Pe(s){const t=Date.now(),e=Math.trunc((t-s)/1e3);if(e<60)return`${e} second${e>1?"s":""} ago`;if(e<60*60){const a=Math.trunc(e/60);return`${a} minute${a>1?"s":""} ago`}if(e<60*60*24){const a=Math.trunc(e/60%60).toString().padStart(2,"0");return`${Math.trunc(e/60/60)}:${a} ago`}return Math.trunc(e/60/60/24)+" days ago"}const xt=["1st","2nd","3rd"];function Re(s){return s=Number(s),xt[s]?xt[s]:s+1+"th"}function Oe(s,t,e){const a=document.createElement("a");a.setAttribute("download",t||"");const o=URL.createObjectURL(s);a.href=o+(e?"#"+e:""),a.click(),setTimeout(()=>URL.revokeObjectURL(o),15e3)}Object.assign(globalThis,{downloadBlob:Oe});const gt=s=>(Y("data-v-5a515753"),s=s(),z(),s),Me={class:"row row-cols-lg-3 g-3 align-items-end","data-component":"InputControls"},Ae={class:"input col-12"},De=gt(()=>n("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),Ve=["disabled"],Ne={class:"input col-12"},qe={class:"row"},Be={class:"line m-1"},je=gt(()=>n("span",{class:"btn-group"},[n("span",{class:"input-group-text me-1"},"Clipboard")],-1)),Fe=["disabled"],We=["disabled"],He={class:"line m-1"},Je=gt(()=>n("span",{class:"btn-group"},[n("span",{class:"input-group-text me-1 text-center"},"Controls")],-1)),Ye=["disabled"],ze={class:"input col-12",style:{"align-self":"end"}},Ke={class:"row"},Qe={class:"line m-1"},Ge=gt(()=>n("span",{class:"btn-group"},[n("span",{class:"input-group-text me-1 text-center"},"Popups")],-1)),Xe=k({__name:"InputControls",setup(s){const t=new WeakMap;async function e(u,{klass:g="btn-active",time:h=180}={}){u.classList.add(g);const A=vt(h);t.set(u,A),await A,t.get(u)===A&&u.classList.remove(g)}const a=v(null);function o(u){U.value="",a.value?.focus(),p(),e(u.currentTarget)}function l(u){navigator.clipboard.writeText(H.value.join(" ")),e(u.currentTarget)}function d(u){u.preventDefault(),navigator.clipboard.writeText(H.value.join(`
`)),e(u.currentTarget)}function i(u){u.button===1&&(u.preventDefault(),navigator.clipboard.writeText(Le(H.value)),e(u.currentTarget))}let r=null;function p(){r=null}function C(u,g){const h=r,{hash:A,size:Q}={hash:Mt(u),size:u.length};return r={hash:A,size:Q,type:g},h?h.type==="append"&&g==="replace"?U.value===u:Q===h.size&&A===h.hash:!1}async function R(u){const{currentTarget:g}=u,h=await navigator.clipboard.readText();if(C(h,"append")){e(g,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",h),U.value&&!U.value.endsWith(`
`)&&(U.value+=`
`),U.value+=h,e(g)}async function M(u){const{currentTarget:g}=u,h=await navigator.clipboard.readText();if(C(h,"replace")){e(g,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",h),U.value=h,e(g)}const{useCleaner:f,useOriginer:y}=tt;return(u,g)=>(m(),b("div",Me,[n("div",Ae,[De,N(n("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":g[0]||(g[0]=h=>et(U)?U.value=h:null),ref_key:"textareaEl",ref:a,onInput:p,disabled:!c(F)},null,40,Ve),[[J,c(U)]])]),n("div",Ne,[n("span",qe,[n("span",Be,[je,n("button",{class:"btn btn-outline-primary",onClick:M,disabled:!c(F)},"Replace",8,Fe),n("button",{class:"btn btn-outline-primary",onClick:R,disabled:!(c(F)||c(ut))},"Append",8,We)]),n("span",He,[Je,n("button",{class:"btn btn-outline-danger",onClick:o,disabled:!c(F)},"Clear",8,Ye),n("button",{class:"btn btn-primary",title:"Copy URLs",onClick:l,onContextmenu:d,onPointerdown:i},"Copy",32)])])]),n("div",ze,[n("span",Ke,[n("span",Qe,[Ge,n("button",{class:"btn btn-outline-primary",title:"Toggle Auto Clicker Popup",onClick:g[1]||(g[1]=h=>yt.value=!c(yt)),onContextmenu:g[2]||(g[2]=nt((...h)=>c(St)&&c(St)(...h),["prevent"]))},"Auto Clicker",32),n("button",{class:D(["btn btn-outline-primary",{"turned-off":!c(f)&&!c(y)}]),title:"Toggle Url Cleaner Popup",onClick:g[3]||(g[3]=h=>Ct.value=!c(Ct)),onContextmenu:g[4]||(g[4]=nt((...h)=>c(Ut)&&c(Ut)(...h),["prevent"]))},"Url Magic",34)])])])]))}}),Ze=S(Xe,[["__scopeId","data-v-5a515753"]]),Et=w(()=>{const s=[...new Set(H.value)].sort().join(" ");return Math.abs(Mt(s)).toString(16).slice(-8).padStart(8,"0").toUpperCase()}),G=w(()=>{const s=H.value,t=s.length,e=new Set(s).size;return{count:t,uniqueCount:e}}),V=w(()=>{let s=0;const t=new Set;for(const e of H.value)it.value.has(e)&&(s++,t.add(e));return{count:s,uniqueCount:t.size}}),K=s=>(Y("data-v-fd34ce57"),s=s(),z(),s),tn={"data-component":"URLsInfoLine"},en={title:"URLs count"},nn={key:0,title:"URLs count (unique)"},sn=K(()=>n("span",{class:"grey"}," — ",-1)),on={title:"URLs hash"},an=K(()=>n("span",{class:"grey"},"#",-1)),ln={class:"urls-hash"},rn={key:0},un=K(()=>n("span",{class:"grey"}," — ",-1)),cn=K(()=>n("span",{class:"grey"},"[",-1)),dn={class:"clicked-count"},pn={title:"Clicked URLs count"},mn={key:0,title:"Clicked URLs count (unique)"},fn=K(()=>n("span",{class:"grey"},"]",-1)),vn=K(()=>n("span",{class:"grey"}," — ",-1)),_n=["title"],gn=k({__name:"URLsInfoLine",setup(s){mt(()=>{const{count:l,uniqueCount:d}=G.value;if(!l){document.title="HrefLister";return}if(document.title=`HrefLister — ${t(l,d)} — #${Et.value}`,V.value.count){const{count:i,uniqueCount:r}=V.value;document.title=`${document.title} — [ ${t(i,r)} ]`}});function t(l,d){let i=l.toString();return l!==d&&(i=`${i} (${d})`),i}async function e(){if(!I.value)return;const l=I.value.elem;l.scrollIntoView({block:"center"}),l.classList.add("highlighted-2"),await vt(800),l.classList.remove("highlighted-2")}function a(){I.value&&I.value.elem.classList.add("highlighted-1")}function o(){I.value&&I.value.elem.classList.remove("highlighted-1")}return(l,d)=>(m(),b("div",tn,[n("span",null,[n("span",en,T(c(G).count),1),c(G).count!==c(G).uniqueCount?(m(),b("span",nn," ("+T(c(G).uniqueCount)+")",1)):E("",!0)]),sn,n("span",on,[an,n("span",ln,T(c(Et)),1)]),c(V).count?(m(),b("span",rn,[un,n("span",null,[cn,n("span",dn,[n("span",pn,T(c(V).count),1),c(V).count!==c(V).uniqueCount?(m(),b("span",mn," ("+T(c(V).uniqueCount)+")",1)):E("",!0)]),fn])])):E("",!0),c(I)?(m(),b("span",{key:1,onClick:e,onPointerenter:a,onPointerleave:o},[vn,n("span",{class:"grey",title:`Last clicked URL index
`+c(I).entry.url},T(c(Re)(c(I).index)),9,_n)],32)):E("",!0)]))}}),hn=S(gn,[["__scopeId","data-v-fd34ce57"]]),kt=1e3*60,Lt=kt*10,$t=kt*60,bn=$t*24;class yn{constructor(t){this.timeRef=t,q(t,e=>{e>0&&this.setTimer()}),Zt(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let e;if(t<Lt)e=kt;else if(t<$t)e=Lt;else if(t<bn)e=$t;else return;this.timerId=window.setTimeout(()=>{It(this.timeRef),this.setTimer()},e)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){It(this.timeRef),this.setTimer()}}const Cn=s=>(Y("data-v-c5b164a1"),s=s(),z(),s),$n={class:"tags"},wn={class:"tag-master","data-component":"EntryTags"},Tn=["data-tag"],kn={key:0,class:"tag add-tag"},In=Cn(()=>n("span",{class:"plus"},"+",-1)),Sn=[In],Un=k({__name:"UrlListItemTags",props:{ue:{}},setup(s){const t=s;function e(){W(O.value)===W(t.ue)?O.value=null:O.value=t.ue,console.log(W(O.value))}return(a,o)=>(m(),b("div",{class:"tags-wrapper",onClick:e,"data-component":"UrlListItemTags"},[n("div",$n,[n("div",wn,[(m(!0),b(st,null,ft(a.ue.tags,l=>(m(),b("div",{class:"tag","data-tag":l},T(l),9,Tn))),256))])]),a.ue.tags?.length?E("",!0):(m(),b("div",kn,Sn))]))}}),xn=S(Un,[["__scopeId","data-v-c5b164a1"]]),En=["data-index"],Ln={class:"col-9 nowrap-text-ceil url url-cell"},Pn={class:"nowrap-text-ceil-content"},Rn=["title"],On=["href","title","data-url-origin"],Mn={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},An=k({__name:"UrlListItem",props:{ue:{},index:{}},setup(s){const t=s,e=w(()=>t.ue.visited||Se);function a(){t.ue.delVisited()}function o(){const _=Date.now();t.ue.setVisited(_)}function l(_){_.button===1&&(_.preventDefault(),a())}const d=w(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),i=w(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function r(){W(L.value)===W(t.ue)?L.value=null:L.value=t.ue}const p=v(),C=w(()=>it.value.has(t.ue.url));function R(){it.value.add(t.ue.url),o(),I.value={entry:t.ue,index:t.index,elem:p.value}}function M(_){_.button!==1||document.getRootNode().activeElement!==_.currentTarget||R()}function f(){it.value.delete(t.ue.url)}const y=w(()=>{const _=I.value;return _?t.index===_.index&&t.ue.isEquals(_.entry):!1});te(()=>{y.value&&(I.value=null)});const u=new yn(e);function g(){u.forceTrigger()}const h=le(g,2e3),A=w(()=>{let _=`№ ${t.index+1}.
`;return e.value<0?_+="never clicked":_+=Q(e.value),t.ue.initialVisited&&t.ue.initialVisited!==e.value?`${_}
${Q(t.ue.initialVisited)}`:_});function Q(_){return Pe(_)+" — "+ae(_,"YYYY.MM.DD HH:mm:SS",!1)}const Qt=w(()=>Gt(e.value));function Gt(_){if(_<0)return"never-clicked";const j=Date.now(),$=Math.trunc((j-_)/1e3);return $<60?"minute-1":$<60*2?"minute-2":$<60*5?"minute-5":$<60*10?"minute-10":$<60*30?"minute-30":$<60*45?"minute-45":$<60*60?"minute-60":$<3600*2?"hour-2":$<3600*4?"hour-4":$<3600*8?"hour-8":$<3600*14?"hour-14":$<3600*24?"day-1":$<86400*7?"day-7":$<86400*30?"month-1":$<2592e3*3?"month-3":$<2592e3*6?"month-6":"long-ago"}return(_,j)=>(m(),b("tr",{onPointerenter:j[0]||(j[0]=(...$)=>c(h)&&c(h)(...$)),"data-index":_.index+1,class:D([{clicked:C.value,"last-clicked":y.value},"list-item-row"]),"data-component":"UrlListItem",ref_key:"htmlCompRef",ref:p},[n("td",Ln,[n("span",Pn,[n("span",{class:D(["info-dot",{"has-comment":_.ue.inputComment,visited:e.value>0,[Qt.value]:!0}]),title:A.value,onContextmenu:nt(f,["prevent"]),onPointerdown:l},null,42,Rn),n("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:_.ue.url,title:_.ue.inputComment||_.ue.urlOrigin,"data-url-origin":_.ue.urlOrigin,onClick:R,onPointerup:M},T(_.ue.url),41,On)]),x(xn,{class:"tags",ue:_.ue},null,8,["ue"])]),n("td",{class:D(["col-3 comment nowrap-text-ceil",{[d.value]:d.value}]),onDblclick:r},[n("span",Mn,T(i.value||" "),1)],34)],42,En))}}),Dn=S(An,[["__scopeId","data-v-132a8e8c"]]),Vn={"data-component":"UrlList"},Nn={class:"table table-borderless"},qn=k({__name:"UrlList",setup(s){return(t,e)=>(m(),b("div",Vn,[n("table",Nn,[n("tbody",null,[(m(!0),b(st,null,ft(c(zt),(a,o)=>(m(),P(Dn,{ue:a,index:o,key:o+a.url},null,8,["ue","index"]))),128))])])]))}}),Bn={class:"popup-content"},jn={class:"modal-content"},Fn={class:"modal-header"},Wn={class:"modal-title"},Hn={class:"modal-body"},Jn=["value"],Yn=k({__name:"MessageEditPopup",setup(s){const t=w(()=>{const r=L.value;return r.comment===void 0?r.inputComment:r.comment});function e(r){r.currentTarget===r.target&&(L.value=null)}function a(r){r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),L.value=null)}const o=v(null);Ot(()=>{o.value?.focus()});function d(r){const p=r.currentTarget.value;L.value?.setComment(p)}function i(){L.value?.delComment()}return(r,p)=>c(L)?(m(),b("div",{key:0,class:"modal message-edit-popup","data-component":"MessageEditPopup",onPointerdown:e},[n("div",Bn,[n("div",jn,[n("div",Fn,[n("h5",Wn,T(c(L).url),1),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e})]),n("div",Hn,[n("textarea",{rows:"5",value:t.value,onInput:d,ref_key:"textareaElem",ref:o,onKeydown:a},null,40,Jn)]),n("div",{class:"modal-footer"},[n("button",{type:"button",class:"btn btn-secondary",onClick:i},"Reset")])])])],32)):E("",!0)}}),zn=S(Yn,[["__scopeId","data-v-a287ee09"]]),Kn={"data-component":"FancyPopup",class:"popup-root"},Qn=k({__name:"FancyPopup",props:{id:{},header:{}},setup(s){const{makeMovableEx:t}=ie("href-lister"),e=s,a=v(),o=mt(()=>{if(!a.value||!e.header)return;const l=a.value,d=e.header,{reset:i}=t(l,e.id,{handle:d});Tt[e.id]=i,re(l,d),o()});return(l,d)=>(m(),b("div",Kn,[n("div",{class:"popup",ref_key:"popupElem",ref:a},[Rt(l.$slots,"default",{},void 0,!0)],512)]))}}),Kt=S(Qn,[["__scopeId","data-v-643dc050"]]),Gn={"data-component":"UrlCleanerConfig",class:"url-cleaner"},Xn={class:"warning"},Zn=k({__name:"UrlCleanerConfig",props:{ucSettings:{},btnInsertPlace:{}},setup(s){const t=s,{ucRuleStrings:e,ucCompiledRules:a}=t.ucSettings,o=v(null),l=v(!0),d=v(!0),i=v(""),r=v("");let p="";const C=ue(M,220);q(e,()=>{r.value=f(e.value),p=r.value,q(r,C)},{immediate:!0});async function R(){const y=o.value;y.blur(),e.value=JSON.parse(r.value),a.value=B.compileRuleStrings(e.value),p=r.value,y.classList.add("btn-outline-success"),await vt(800),l.value=!0,y.classList.remove("btn-outline-success")}function M(){if(o.value){if(r.value===p){l.value=!0,d.value=!0,i.value="";return}d.value=!1,l.value=!1;try{const u=JSON.parse(r.value);if(!Array.isArray(u)){i.value="Not an array";return}if(u.length!==u.flat().length){i.value="Array is not flat";return}if(!u.every(ce)){i.value="Array is not string one";return}if(!de(u)){i.value="Wrong data in the rule string array";return}d.value=!0,i.value=""}catch{i.value="Incorrect JSON"}}}function f(y){let u=JSON.stringify(y,null,4);return u=u.replaceAll('    "site','"site'),u}return(y,u)=>(m(),b("div",Gn,[N(n("textarea",{spellcheck:"false",id:"editor",class:"form-control","onUpdate:modelValue":u[0]||(u[0]=g=>r.value=g)},null,512),[[J,r.value]]),(m(),P(wt,{to:y.btnInsertPlace},[n("button",{ref_key:"saveBtn",ref:o,id:"save",class:D(["btn btn-outline-primary",{disabled:l.value||!d.value}]),onClick:R},"Save",2)],8,["to"])),n("span",Xn,T(i.value),1)]))}}),Pt=S(Zn,[["__scopeId","data-v-15078068"]]),ts=s=>(Y("data-v-b968c8ad"),s=s(),z(),s),es={class:"popup-content"},ns={class:"p-1 flex"},ss=ts(()=>n("span",{class:"btn-group"},[n("span",{class:"input-group-text me-1 text-center"},"Configs")],-1)),os={class:"btn-group"},as={key:0,class:"ready-required"},ls={key:0},rs={key:1},is=k({__name:"PopupUrlCleaner",setup(s){const t=v(null),e=v("cleaner"),a=v(null),o=v(!1);mt(()=>{a.value&&(o.value=!0)});const{useCleaner:l,useOriginer:d}=tt;function i(r){tt[r].value=!tt[r].value}return(r,p)=>N((m(),P(Kt,{"data-slot-component":"PopupUrlCleaner",id:"url-cleaner",header:t.value},{default:Z(()=>[n("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Url Magic Transforms",512),n("div",es,[n("div",ns,[ss,n("span",os,[n("button",{title:"Rule String Array based config",class:D(["btn btn-outline-primary",{active:e.value==="cleaner","turned-off":!c(l)}]),onClick:p[0]||(p[0]=C=>e.value="cleaner"),onContextmenu:p[1]||(p[1]=nt(()=>i("useCleaner"),["prevent"]))},"Url Cleaner",34),n("button",{title:"Rule String Array based config",class:D(["btn btn-outline-primary",{active:e.value==="originer","turned-off":!c(d)}]),onClick:p[2]||(p[2]=C=>e.value="originer"),onContextmenu:p[3]||(p[3]=nt(()=>i("useOriginer"),["prevent"]))},"Url Origin",34)]),n("span",{style:{"margin-left":"auto"},class:"btn-insert-place",ref_key:"btnInsertPlace",ref:a},null,512)]),o.value?(m(),b("div",as,[e.value==="cleaner"?(m(),b("div",ls,[x(Pt,{ucSettings:c(ct),btnInsertPlace:a.value},null,8,["ucSettings","btnInsertPlace"])])):(m(),b("div",rs,[x(Pt,{ucSettings:c(dt),btnInsertPlace:a.value},null,8,["ucSettings","btnInsertPlace"])]))])):E("",!0)])]),_:1},8,["header"])),[[ee,o.value]])}}),us=S(is,[["__scopeId","data-v-b968c8ad"]]),cs={class:"popup-content"},ds={class:"btn-group p-1 container"},ps=["disabled"],ms=["disabled"],fs=["disabled"],vs={class:"div-wrap"},_s={class:"p-1 pt-0 col-12"},gs={class:"input-group"},hs=n("span",{class:"input-group-text col-3"},"Delay",-1),bs={class:"div-wrap"},ys={class:"p-1 pt-0 col-12"},Cs={class:"input-group"},$s=n("span",{class:"input-group-text col-3"},"Count",-1),ws=k({__name:"PopupAutoClicker",setup(s){const t=v(null),{delay:e,count:a}=Ue,o=v("ready"),l=v(0);let d=new AbortController;q(o,()=>{o.value==="ready"?ut.value=F.value=!0:o.value==="started"?ut.value=F.value=!1:o.value==="paused"&&(ut.value=!0)});async function i(){console.log("startClicking");const f=[...document.querySelectorAll("a.url")],y=a.value===0?f.length:Math.min(f.length,a.value+l.value),u=y<f.length;for(o.value="started";l.value<y;){const g=f[l.value],h=g.closest('[data-component="UrlListItem"]');if(h.classList.add("hover"),await pe(e.value*1e3,d.signal),h.classList.remove("hover"),o.value==="started")l.value++,g.dispatchEvent(new MouseEvent("click")),await vt();else if(o.value==="paused"){o.value="paused";return}else if(o.value==="stopped"){l.value=0,o.value="ready";return}}u?o.value="paused":(l.value=0,o.value="ready")}function r(f){l.value===0&&(f="stopped"),o.value=f,d.abort(f),d=new AbortController}function p(){if(o.value==="started"){r("stopped");return}l.value=0,o.value="ready"}let C;function R(){if(I.value&&o.value!=="ready"){const f=I.value.elem.nextElementSibling;f&&(f.classList.add("highlighted-1"),C=f)}else{const f=document.querySelector('[data-component="UrlListItem"]');f&&(f.classList.add("highlighted-1"),C=f)}}function M(){C&&(C.classList.remove("highlighted-1"),C=null)}return(f,y)=>(m(),P(Kt,{"data-slot-component":"PopupAutoClicker",id:"auto-clicker",header:t.value},{default:Z(()=>[n("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Auto Clicker",512),n("div",cs,[n("div",ds,[n("button",{class:"btn btn-primary col-4",onClick:i,onPointerenter:R,onPointerleave:M,disabled:!(o.value==="ready"||o.value==="paused")},T(o.value==="ready"||!l.value?"Start":"Next"),41,ps),n("button",{class:"btn btn-secondary col-4",disabled:o.value!=="started",onClick:y[0]||(y[0]=u=>r("paused"))},"Pause",8,ms),n("button",{class:"btn btn-secondary col-4",disabled:!l.value,onClick:p},T(o.value==="paused"?"Reset":"Stop"),9,fs)]),n("div",vs,[n("label",_s,[n("span",gs,[hs,N(n("input",{title:"Click delay (seconds)",class:"form-control",type:"number","onUpdate:modelValue":y[1]||(y[1]=u=>et(e)?e.value=u:null)},null,512),[[J,c(e)]])])])]),n("div",bs,[n("label",ys,[n("span",Cs,[$s,N(n("input",{title:"Count",class:"form-control",type:"number","onUpdate:modelValue":y[2]||(y[2]=u=>et(a)?a.value=u:null)},null,512),[[J,c(a)]])])])])])]),_:1},8,["header"]))}}),Ts={class:"selected-tags","data-component":"SelectedTags"},ks=["data-tag"],Is={class:"input-wrapper"},Ss=["value"],Us=k({__name:"SelectedTags",props:{entry:{},modelValue:{}},emits:["update:modelValue","tabPressed"],setup(s,{emit:t}){const e=s,a=t;function o(f){const u=f.target.dataset.tag;u&&e.entry?.delTag(u)}const l=v(null),i=document.createElement("canvas").getContext("2d");Ot(()=>{l.value&&(i.font=window.getComputedStyle(l.value).font)});function r(){if(!l.value)return;const f=i.measureText(l.value.value).width;l.value.style.width=f+6+"px"}function p(){l.value&&(l.value.selectionStart=l.value.selectionEnd,l.value.focus())}function C(){l.value?.select()}function R(f){a("update:modelValue",f.target.value)}function M(f){console.log(f),f.code==="Tab"&&(f.preventDefault(),a("tabPressed"))}return(f,y)=>(m(),b("div",Ts,[n("div",{class:"tag-master",onClick:o},[(m(!0),b(st,null,ft(f.entry.tags,u=>(m(),b("div",{class:"tag","data-tag":u},T(u),9,ks))),256))]),n("span",{class:"label",onDblclick:C,onClick:p},[n("span",Is,[n("input",ne({type:"text",ref_key:"tagInput",ref:l,value:f.modelValue},se({input:[r,R]}),{onKeydown:M}),null,16,Ss)])],32)]))}}),xs=S(Us,[["__scopeId","data-v-40fab9e9"]]),Es=["data-tag"],Ls=k({__name:"SuggestedTag",props:{tagWrap:{}},setup(s){const t=s,{entry:e,tag:a}=t.tagWrap,o=w(()=>!!e.tags?.includes(a));function l(){o.value?e.delTag(a):e.addTag(a)}return(d,i)=>(m(),b("div",{class:D(["tag",{selected:o.value}]),onClick:l,"data-tag":d.tagWrap.tag,"data-component":"SuggestedTag"},T(d.tagWrap.tag),11,Es))}}),Ps=S(Ls,[["__scopeId","data-v-5d66b337"]]);function Rs(){return JSON.parse(localStorage.getItem("href_lister_all_tags")||"[]")}const Os=v(Rs()),Ms={class:"popup-content"},As={class:"modal-content"},Ds={class:"modal-header"},Vs={class:"modal-title"},Ns={class:"modal-body"},qs={class:"tags selected-tags-group"},Bs={class:"tags all-tags-group"},js={class:"tag-master"},Fs=k({__name:"UrlEntryTagsEditPopup",setup(s){const t=v(""),e=O,a=w(()=>Os.value.map(i=>({tag:i,entry:e.value}))),o=w(()=>{const i=[],r=[];for(const p of a.value){const C=p.tag.indexOf(t.value);C!==-1&&(C===0?i.push(p):r.push(p))}return[i,r].flat()});function l(){t.value=""}function d(i){i.currentTarget===i.target&&(O.value=null)}return(i,r)=>(m(),P(wt,{to:"body"},[c(O)?(m(),b("div",{key:0,class:"modal tags-edit-popup",onPointerdown:d,"data-component":"URLsInfoLine"},[n("div",Ms,[n("div",As,[n("div",Ds,[n("h5",Vs,T(c(O).url),1)]),n("div",Ns,[n("div",qs,[x(xs,{entry:c(O),modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=p=>t.value=p),onTabPressed:l},null,8,["entry","modelValue"])]),n("div",Bs,[n("div",js,[(m(!0),b(st,null,ft(o.value,p=>(m(),P(Ps,{"tag-wrap":p},null,8,["tag-wrap"]))),256))])])])])])],32)):E("",!0)]))}}),Ws=S(Fs,[["__scopeId","data-v-7874f8fe"]]),Hs={"data-component":"Main"},Js=n("hr",null,null,-1),Ys=n("hr",null,null,-1),zs=n("hr",null,null,-1),Ks=n("hr",null,null,-1),Qs=k({__name:"Main",setup(s){return(t,e)=>(m(),b("div",Hs,[Js,x(we),Ys,x(Ze),zs,x(hn),Ks,x(qn),c(O)?(m(),P(Ws,{key:0})):E("",!0),c(L)?(m(),P(ht,{key:1},{default:Z(()=>[x(zn)]),_:1})):E("",!0),c(yt)?(m(),P(ht,{key:2},{default:Z(()=>[x(ws)]),_:1})):E("",!0),c(Ct)?(m(),P(ht,{key:3},{default:Z(()=>[x(us)]),_:1})):E("",!0)]))}}),Gs=s=>(Y("data-v-679e969c"),s=s(),z(),s),Xs=Gs(()=>n("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister",target:"_blank"},[n("i",null,"i")],-1)),Zs=k({__name:"App",setup(s){return(t,e)=>(m(),b(st,null,[x(Qs),Xs],64))}}),to=S(Zs,[["__scopeId","data-v-679e969c"]]);oe(to).mount("#app");
//# sourceMappingURL=index.js.map
