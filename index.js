import{ref as v,computed as w,defineComponent as S,openBlock as m,createElementBlock as b,createBaseVNode as s,withDirectives as N,vModelText as z,unref as p,isRef as ot,pushScopeId as K,popScopeId as X,createBlock as O,renderSlot as Rt,Teleport as Tt,toRaw as W,toRefs as gt,watch as q,watchEffect as at,reactive as Gt,withModifiers as lt,normalizeClass as A,toDisplayString as T,createCommentVNode as E,onUnmounted as Zt,triggerRef as It,Fragment as rt,renderList as _t,onBeforeUnmount as te,createVNode as L,onMounted as Ot,vShow as ee,withCtx as nt,mergeProps as ne,toHandlers as se,createApp as oe}from"./vue.js";import{UrlCleaner as B,sleep as Q,hashString as Mt,formatDate as ae,throttle as le,debounce as re,isString as ie,isUCRuleStringArray as ue,sleepEx as ce}from"./util.js";import{createStore as At,del as Dt,get as Vt,set as Nt,entries as qt}from"./idb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=e(o);fetch(o.href,l)}})();const Bt={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},it=v(Bt.input_only),ut=v(Bt.input_ignore),de=w(()=>{let n=it.value.trim().split(/\s+/g).filter(o=>o),t=ut.value.trim().split(/\s+/g).filter(o=>o);n=n.map(o=>o.toLowerCase()),t=t.map(o=>o.toLowerCase());let e,a;return e=o=>n.some(l=>o.toLowerCase().includes(l)),a=o=>t.some(l=>o.toLowerCase().includes(l)),{matchOnly:e,matchIgnore:a,onlyParts:n,ignoreParts:t}}),pe=w(()=>{const{matchOnly:n,matchIgnore:t,onlyParts:e}=de.value;return e.length?a=>n(a):a=>!t(a)}),jt=n=>(K("data-v-9c460a67"),n=n(),X(),n),fe={class:"row row-cols-lg-3 g-3 align-items-center","data-component":"Filters"},me={class:"col-12"},ve={class:"input-group"},ge=jt(()=>s("span",{class:"input-group-text"},"Only",-1)),_e={class:"col-12"},he={class:"input-group"},ye=jt(()=>s("span",{class:"input-group-text"},"Ignore",-1)),be=S({__name:"Filters",setup(n){return(t,e)=>(m(),b("div",fe,[s("div",me,[s("label",null,[s("span",ve,[ge,N(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=a=>ot(it)?it.value=a:null)},null,512),[[z,p(it)]])])])]),s("div",_e,[s("label",null,[s("span",he,[ye,N(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=a=>ot(ut)?ut.value=a:null)},null,512),[[z,p(ut)]])])])])]))}}),U=(n,t)=>{const e=n.__vccOpts||n;for(const[a,o]of t)e[a]=o;return e},Ce=U(be,[["__scopeId","data-v-9c460a67"]]),$e={};function we(n,t){return m(),O(Tt,{to:"body"},[Rt(n.$slots,"default")])}const bt=U($e,[["render",we]]);function Te(n){const t=n.split(`
`).map(a=>a.trim()).filter(a=>a),e=[];for(const a of t){const[o,...l]=a.split(/\s+(#|\/\/)/),[c,...r]=o.trim().split(/\s+/);if(c.startsWith("http")){const i=Ct(c);if(i&&r.every(d=>!Ct(d))){e.push({url:i,inputComment:[...r,...l].join(" ")});continue}i&&e.push({url:i})}else r.unshift(c);for(const i of r){const d=Ct(i);d&&e.push({url:d})}}return e}function Ct(n){const t=n.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t?.groups)return t.groups.url}const ct={createStore:At,del:Dt,get:Vt,set:Nt,entries:qt},dt=ct.createStore("HrefListerUrlInfo","UrlInfo"),Ft=class et{constructor({url:t,inputComment:e,urlOrigin:a},o){this.url=t,this.state=o,e&&(this.inputComment=e),o.visited&&(this.initialVisited=o.visited),a&&(this.urlOrigin=a)}static async getInstance(t){const e=t.urlOrigin||t.url;let a=et.stateMap.get(e);return a?new et(t,a):(a=await ct.get(e,dt),a===void 0&&(a={}),et.stateMap.set(e,a),new et(t,a))}isEquals(t){return t?this.state===t.state&&this.inputComment===t.inputComment:!1}get comment(){return this.state.comment}get visited(){return this.state.visited}get tags(){return this.state.tags}async setComment(t){this.state.comment=t,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(t){this.state.visited=t,await this.update()}async delVisited(){delete this.state.visited,await this.update()}async addTag(t){this.state.tags||(this.state.tags=[]),!this.state.tags.includes(t)&&(this.state.tags.push(t),await this.update())}async delTag(t){if(!this.state.tags)return;const e=this.state.tags.indexOf(t);e!=-1&&(this.state.tags.splice(e,1),this.state.tags.length===0&&delete this.state.tags,await this.update())}update(){return Object.keys(this.state).length?ct.set(this.urlOrigin||this.url,W(this.state),dt):ct.del(this.urlOrigin||this.url,dt)}};Ft.stateMap=new Map;let Wt=Ft;Object.assign(globalThis,{idb:{createStore:At,del:Dt,get:Vt,set:Nt,entries:qt,urlInfoStore:dt},UrlEntry:Wt});const Se=-1,x=v(""),R=v(null),M=v(null),pt=v(new Set),J=v(!1),Y=v(!1),$t=v(!1),Ie=v(!1);async function kt(){$t.value=!0,J.value&&(J.value=!1,await Q(),J.value=!0)}async function Ut(){Ie.value=!0,Y.value&&(Y.value=!1,await Q(),Y.value=!0)}const F=v(!0),ft=v(!0),k=v(null);function ht(n,t){const e=localStorage.getItem(n),a=Gt(e===null?typeof t=="function"?t():t:JSON.parse(e));return q(a,()=>{localStorage.setItem(n,JSON.stringify(a))}),a}const ke=gt(ht("href-lister-clicker-settings",{delay:1,count:0})),mt=gt(ht("href-lister-url-cleaner-settings",()=>{const n=["site:youtube.com","trim-search-params:feature t si","site:t.umblr.com","filter-start:https://t.umblr.com/redirect","search-param:z","recursive","site:deviantart.com","trim-start:https://www.deviantart.com/users/outgoing?","decode-url","recursive"];return{ucRuleStrings:n,ucCompiledRules:B.compileRuleStrings(n)}})),Jt=v(B.fromRuleRecords(mt.ucCompiledRules.value));q(mt.ucCompiledRules,()=>{Jt.value=B.fromRuleRecords(mt.ucCompiledRules.value)});const vt=gt(ht("href-lister-url-origin-settings",()=>{const n=["site:cdn.discordapp.com","trim-search-params:ex is hm"];return{ucRuleStrings:n,ucCompiledRules:B.compileRuleStrings(n)}})),Yt=v(B.fromRuleRecords(vt.ucCompiledRules.value));q(vt.ucCompiledRules,()=>{Yt.value=B.fromRuleRecords(vt.ucCompiledRules.value)});const st=gt(ht("href-lister-common-settings",{useCleaner:!0,useOriginer:!0})),{useCleaner:Ue,useOriginer:xe}=st,Ht=v([]);at(async()=>{const n=Te(x.value),t=[];for(const e of n){e.url=Ue.value?Jt.value.clean(e.url):e.url;const a=xe.value?Yt.value.clean(e.url):e.url;a!==e.url&&(e.urlOrigin=a),t.push(await Wt.getInstance(e))}Ht.value=t});const zt=w(()=>Ht.value.filter(n=>pe.value(n.url))),H=w(()=>{const n=zt.value.map(t=>t.url);return globalThis.__urls=n,n});location.href==="http://localhost:5173/"&&(x.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
http://localhost:5173/#www
https://www.youtube.com/watch?feature=player_embedded&v=Qwert123`);function Le(n,t=100){const e=r=>`${r.length?'["'+r.join('", "')+'"]':"[]"}`;if(n.length<=t)return`/* ${n.length.toString().padStart(3)} */ ${e(n)},`;const a=r=>r.toString().length,o=Math.trunc(n.length/t),c=[`/* ${n.length.toString().padStart(1+a(n.length))+" ".repeat(3+a(o))} */`];for(let r=0;r<=o;r++){const i=n.slice(t*r,t+t*r),d=`(${r+1})`.padStart(2+a(o)),_=i.length.toString().padStart(1+a(n.length));c.push(`/* ${_} ${d} */ ${e(i)},`)}return c.join(`
`)}function Ee(n){const t=Date.now(),e=Math.trunc((t-n)/1e3);if(e<60)return`${e} second${e>1?"s":""} ago`;if(e<60*60){const a=Math.trunc(e/60);return`${a} minute${a>1?"s":""} ago`}if(e<60*60*24){const a=Math.trunc(e/60%60).toString().padStart(2,"0");return`${Math.trunc(e/60/60)}:${a} ago`}return Math.trunc(e/60/60/24)+" days ago"}const xt=["1st","2nd","3rd"];function Pe(n){return n=Number(n),xt[n]?xt[n]:n+1+"th"}function Re(n,t,e){const a=document.createElement("a");a.setAttribute("download",t||"");const o=URL.createObjectURL(n);a.href=o+(e?"#"+e:""),a.click(),setTimeout(()=>URL.revokeObjectURL(o),15e3)}Object.assign(globalThis,{downloadBlob:Re});const yt=n=>(K("data-v-5a515753"),n=n(),X(),n),Oe={class:"row row-cols-lg-3 g-3 align-items-end","data-component":"InputControls"},Me={class:"input col-12"},Ae=yt(()=>s("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),De=["disabled"],Ve={class:"input col-12"},Ne={class:"row"},qe={class:"line m-1"},Be=yt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1"},"Clipboard")],-1)),je=["disabled"],Fe=["disabled"],We={class:"line m-1"},Je=yt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Controls")],-1)),Ye=["disabled"],He={class:"input col-12",style:{"align-self":"end"}},ze={class:"row"},Ke={class:"line m-1"},Xe=yt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Popups")],-1)),Qe=S({__name:"InputControls",setup(n){const t=new WeakMap;async function e(u,{klass:h="btn-active",time:y=180}={}){u.classList.add(h);const D=Q(y);t.set(u,D),await D,t.get(u)===D&&u.classList.remove(h)}const a=v(null);function o(u){x.value="",a.value?.focus(),d(),e(u.currentTarget)}function l(u){navigator.clipboard.writeText(H.value.join(" ")),e(u.currentTarget)}function c(u){u.preventDefault(),navigator.clipboard.writeText(H.value.join(`
`)),e(u.currentTarget)}function r(u){u.button===1&&(u.preventDefault(),navigator.clipboard.writeText(Le(H.value)),e(u.currentTarget))}let i=null;function d(){i=null}function _(u,h){const y=i,{hash:D,size:Z}={hash:Mt(u),size:u.length};return i={hash:D,size:Z,type:h},y?y.type==="append"&&h==="replace"?x.value===u:Z===y.size&&D===y.hash:!1}async function I(u){const{currentTarget:h}=u,y=await navigator.clipboard.readText();if(_(y,"append")){e(h,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",y),x.value&&!x.value.endsWith(`
`)&&(x.value+=`
`),x.value+=y,e(h)}async function P(u){const{currentTarget:h}=u,y=await navigator.clipboard.readText();if(_(y,"replace")){e(h,{klass:"same-data-warning",time:300});return}console.log("[clipboard] readText:",y),x.value=y,e(h)}const{useCleaner:f,useOriginer:C}=st;return(u,h)=>(m(),b("div",Oe,[s("div",Me,[Ae,N(s("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":h[0]||(h[0]=y=>ot(x)?x.value=y:null),ref_key:"textareaEl",ref:a,onInput:d,disabled:!p(F)},null,40,De),[[z,p(x)]])]),s("div",Ve,[s("span",Ne,[s("span",qe,[Be,s("button",{class:"btn btn-outline-primary",onClick:P,disabled:!p(F)},"Replace",8,je),s("button",{class:"btn btn-outline-primary",onClick:I,disabled:!(p(F)||p(ft))},"Append",8,Fe)]),s("span",We,[Je,s("button",{class:"btn btn-outline-danger",onClick:o,disabled:!p(F)},"Clear",8,Ye),s("button",{class:"btn btn-primary",title:"Copy URLs",onClick:l,onContextmenu:c,onPointerdown:r},"Copy",32)])])]),s("div",He,[s("span",ze,[s("span",Ke,[Xe,s("button",{class:"btn btn-outline-primary",title:"Toggle Auto Clicker Popup",onClick:h[1]||(h[1]=y=>J.value=!p(J)),onContextmenu:h[2]||(h[2]=lt((...y)=>p(kt)&&p(kt)(...y),["prevent"]))},"Auto Clicker",32),s("button",{class:A(["btn btn-outline-primary",{"turned-off":!p(f)&&!p(C)}]),title:"Toggle Url Cleaner Popup",onClick:h[3]||(h[3]=y=>Y.value=!p(Y)),onContextmenu:h[4]||(h[4]=lt((...y)=>p(Ut)&&p(Ut)(...y),["prevent"]))},"Url Magic",34)])])])]))}}),Ge=U(Qe,[["__scopeId","data-v-5a515753"]]),Lt=w(()=>{const n=[...new Set(H.value)].sort().join(" ");return Math.abs(Mt(n)).toString(16).slice(-8).padStart(8,"0").toUpperCase()}),tt=w(()=>{const n=H.value,t=n.length,e=new Set(n).size;return{count:t,uniqueCount:e}}),V=w(()=>{let n=0;const t=new Set;for(const e of H.value)pt.value.has(e)&&(n++,t.add(e));return{count:n,uniqueCount:t.size}}),G=n=>(K("data-v-fd34ce57"),n=n(),X(),n),Ze={"data-component":"URLsInfoLine"},tn={title:"URLs count"},en={key:0,title:"URLs count (unique)"},nn=G(()=>s("span",{class:"grey"}," — ",-1)),sn={title:"URLs hash"},on=G(()=>s("span",{class:"grey"},"#",-1)),an={class:"urls-hash"},ln={key:0},rn=G(()=>s("span",{class:"grey"}," — ",-1)),un=G(()=>s("span",{class:"grey"},"[",-1)),cn={class:"clicked-count"},dn={title:"Clicked URLs count"},pn={key:0,title:"Clicked URLs count (unique)"},fn=G(()=>s("span",{class:"grey"},"]",-1)),mn=G(()=>s("span",{class:"grey"}," — ",-1)),vn=["title"],gn=S({__name:"URLsInfoLine",setup(n){at(()=>{const{count:l,uniqueCount:c}=tt.value;if(!l){document.title="HrefLister";return}if(document.title=`HrefLister — ${t(l,c)} — #${Lt.value}`,V.value.count){const{count:r,uniqueCount:i}=V.value;document.title=`${document.title} — [ ${t(r,i)} ]`}});function t(l,c){let r=l.toString();return l!==c&&(r=`${r} (${c})`),r}async function e(){if(!k.value)return;const l=k.value.elem;l.scrollIntoView({block:"center"}),l.classList.add("highlighted-2"),await Q(800),l.classList.remove("highlighted-2")}function a(){k.value&&k.value.elem.classList.add("highlighted-1")}function o(){k.value&&k.value.elem.classList.remove("highlighted-1")}return(l,c)=>(m(),b("div",Ze,[s("span",null,[s("span",tn,T(p(tt).count),1),p(tt).count!==p(tt).uniqueCount?(m(),b("span",en," ("+T(p(tt).uniqueCount)+")",1)):E("",!0)]),nn,s("span",sn,[on,s("span",an,T(p(Lt)),1)]),p(V).count?(m(),b("span",ln,[rn,s("span",null,[un,s("span",cn,[s("span",dn,T(p(V).count),1),p(V).count!==p(V).uniqueCount?(m(),b("span",pn," ("+T(p(V).uniqueCount)+")",1)):E("",!0)]),fn])])):E("",!0),p(k)?(m(),b("span",{key:1,onClick:e,onPointerenter:a,onPointerleave:o},[mn,s("span",{class:"grey",title:`Last clicked URL index
`+p(k).entry.url},T(p(Pe)(p(k).index)),9,vn)],32)):E("",!0)]))}}),_n=U(gn,[["__scopeId","data-v-fd34ce57"]]),St=1e3*60,Et=St*10,wt=St*60,hn=wt*24;class yn{constructor(t){this.timeRef=t,q(t,e=>{e>0&&this.setTimer()}),Zt(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let e;if(t<Et)e=St;else if(t<wt)e=Et;else if(t<hn)e=wt;else return;this.timerId=window.setTimeout(()=>{It(this.timeRef),this.setTimer()},e)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){It(this.timeRef),this.setTimer()}}const bn=n=>(K("data-v-c5b164a1"),n=n(),X(),n),Cn={class:"tags"},$n={class:"tag-master","data-component":"EntryTags"},wn=["data-tag"],Tn={key:0,class:"tag add-tag"},Sn=bn(()=>s("span",{class:"plus"},"+",-1)),In=[Sn],kn=S({__name:"UrlListItemTags",props:{ue:{}},setup(n){const t=n;function e(){W(M.value)===W(t.ue)?M.value=null:M.value=t.ue,console.log(W(M.value))}return(a,o)=>(m(),b("div",{class:"tags-wrapper",onClick:e,"data-component":"UrlListItemTags"},[s("div",Cn,[s("div",$n,[(m(!0),b(rt,null,_t(a.ue.tags,l=>(m(),b("div",{class:"tag","data-tag":l},T(l),9,wn))),256))])]),a.ue.tags?.length?E("",!0):(m(),b("div",Tn,In))]))}}),Un=U(kn,[["__scopeId","data-v-c5b164a1"]]),xn=["data-index"],Ln={class:"col-9 nowrap-text-ceil url url-cell"},En={class:"nowrap-text-ceil-content"},Pn=["title"],Rn=["href","title","data-url-origin"],On={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},Mn=S({__name:"UrlListItem",props:{ue:{},index:{}},setup(n){const t=n,e=w(()=>t.ue.visited||Se);function a(){t.ue.delVisited()}function o(){const g=Date.now();t.ue.setVisited(g)}function l(g){g.button===1&&(g.preventDefault(),a())}const c=w(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),r=w(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function i(){W(R.value)===W(t.ue)?R.value=null:R.value=t.ue}const d=v(),_=w(()=>pt.value.has(t.ue.url));function I(){pt.value.add(t.ue.url),o(),k.value={entry:t.ue,index:t.index,elem:d.value}}function P(g){g.button!==1||document.getRootNode().activeElement!==g.currentTarget||I()}function f(){pt.value.delete(t.ue.url)}const C=w(()=>{const g=k.value;return g?t.index===g.index&&t.ue.isEquals(g.entry):!1});te(()=>{C.value&&(k.value=null)});const u=new yn(e);function h(){u.forceTrigger()}const y=le(h,2e3),D=w(()=>{let g=`№ ${t.index+1}.
`;return e.value<0?g+="never clicked":g+=Z(e.value),t.ue.initialVisited&&t.ue.initialVisited!==e.value?`${g}
${Z(t.ue.initialVisited)}`:g});function Z(g){return Ee(g)+" — "+ae(g,"YYYY.MM.DD HH:mm:SS",!1)}const Xt=w(()=>Qt(e.value));function Qt(g){if(g<0)return"never-clicked";const j=Date.now(),$=Math.trunc((j-g)/1e3);return $<60?"minute-1":$<60*2?"minute-2":$<60*5?"minute-5":$<60*10?"minute-10":$<60*30?"minute-30":$<60*45?"minute-45":$<60*60?"minute-60":$<3600*2?"hour-2":$<3600*4?"hour-4":$<3600*8?"hour-8":$<3600*14?"hour-14":$<3600*24?"day-1":$<86400*7?"day-7":$<86400*30?"month-1":$<2592e3*3?"month-3":$<2592e3*6?"month-6":"long-ago"}return(g,j)=>(m(),b("tr",{onPointerenter:j[0]||(j[0]=(...$)=>p(y)&&p(y)(...$)),"data-index":g.index+1,class:A([{clicked:_.value,"last-clicked":C.value},"list-item-row"]),"data-component":"UrlListItem",ref_key:"htmlCompRef",ref:d},[s("td",Ln,[s("span",En,[s("span",{class:A(["info-dot",{"has-comment":g.ue.inputComment,visited:e.value>0,[Xt.value]:!0}]),title:D.value,onContextmenu:lt(f,["prevent"]),onPointerdown:l},null,42,Pn),s("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:g.ue.url,title:g.ue.inputComment||g.ue.urlOrigin,"data-url-origin":g.ue.urlOrigin,onClick:I,onPointerup:P},T(g.ue.url),41,Rn)]),L(Un,{class:"tags",ue:g.ue},null,8,["ue"])]),s("td",{class:A(["col-3 comment nowrap-text-ceil",{[c.value]:c.value}]),onDblclick:i},[s("span",On,T(r.value||" "),1)],34)],42,xn))}}),An=U(Mn,[["__scopeId","data-v-132a8e8c"]]),Dn={"data-component":"UrlList"},Vn={class:"table table-borderless"},Nn=S({__name:"UrlList",setup(n){return(t,e)=>(m(),b("div",Dn,[s("table",Vn,[s("tbody",null,[(m(!0),b(rt,null,_t(p(zt),(a,o)=>(m(),O(An,{ue:a,index:o,key:o+a.url},null,8,["ue","index"]))),128))])])]))}}),qn={class:"popup-content"},Bn={class:"modal-content"},jn={class:"modal-header"},Fn={class:"modal-title"},Wn={class:"modal-body"},Jn=["value"],Yn=S({__name:"MessageEditPopup",setup(n){const t=w(()=>{const i=R.value;return i.comment===void 0?i.inputComment:i.comment});function e(i){i.currentTarget===i.target&&(R.value=null)}function a(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),R.value=null)}const o=v(null);Ot(()=>{o.value?.focus()});function c(i){const d=i.currentTarget.value;R.value?.setComment(d)}function r(){R.value?.delComment()}return(i,d)=>p(R)?(m(),b("div",{key:0,class:"modal message-edit-popup","data-component":"MessageEditPopup",onPointerdown:e},[s("div",qn,[s("div",Bn,[s("div",jn,[s("h5",Fn,T(p(R).url),1),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e})]),s("div",Wn,[s("textarea",{rows:"5",value:t.value,onInput:c,ref_key:"textareaElem",ref:o,onKeydown:a},null,40,Jn)]),s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary",onClick:r},"Reset")])])])],32)):E("",!0)}}),Hn=U(Yn,[["__scopeId","data-v-a287ee09"]]);function zn(n,t){for(const[e,a]of Object.entries(t))n.style[e]=a}function Kn(n,{handle:t,onStop:e,onMove:a,state:o}={}){const l=r=>{a?.(r),zn(n,r)};o&&(l(o),e?.(o));const c=t||n;c.style.userSelect="none",c.style.touchAction="none",n.style.position="absolute",c.addEventListener("pointerdown",r=>{r.preventDefault();const i=r.clientY-parseInt(getComputedStyle(n).top),d=r.clientX-parseInt(getComputedStyle(n).left);let _;function I(f){!c.hasPointerCapture(f.pointerId)&&c.setPointerCapture(f.pointerId),_={top:f.clientY-i+"px",left:f.clientX-d+"px"},l(_)}function P(){removeEventListener("pointermove",I),_&&e?.(_)}addEventListener("pointermove",I,{passive:!0}),addEventListener("pointerup",P,{once:!0})})}function Xn({id:n,onMove:t,onStop:e,reset:a,restore:o}){if(a&&n&&localStorage.removeItem(n),!o||!n)return{onMove:t,onStop:e};const l=localStorage.getItem(n);let c;l&&(c=JSON.parse(l));function r(d){localStorage.setItem(n,JSON.stringify(d))}let i;return e?i=function(d){e(d),r(d)}:i=r,{onMove:t,onStop:i,state:c}}const Qn={"data-component":"FancyPopup",class:"popup-root"},Gn=S({__name:"FancyPopup",props:{id:{},header:{}},setup(n){const t=n,e=v(),a=v();at(()=>{t.header&&(a.value=t.header)});const o=at(()=>{if(!e.value||!a.value)return;const d=e.value,_=a.value;Kn(e.value,{handle:_,...Xn({restore:!0,id:`href-lister-${t.id}-popup-move-state`,reset:$t.value})}),_.addEventListener("pointerdown",I=>{d.focus()},{passive:!0}),$t.value=!1,o()}),l=v(!1);let c=0;function r(){l.value=!0,setTimeout(()=>clearTimeout(c))}function i(){c=window.setTimeout(()=>{l.value=!1},250)}return(d,_)=>(m(),b("div",Qn,[s("div",{class:A(["popup",{focus:l.value}]),tabindex:"-1",ref_key:"popupElem",ref:e,onFocusin:r,onFocusout:i},[Rt(d.$slots,"default",{},void 0,!0)],34)]))}}),Kt=U(Gn,[["__scopeId","data-v-14642a95"]]),Zn={"data-component":"UrlCleanerConfig",class:"url-cleaner"},ts={class:"warning"},es=S({__name:"UrlCleanerConfig",props:{ucSettings:{},btnInsertPlace:{}},setup(n){const t=n,{ucRuleStrings:e,ucCompiledRules:a}=t.ucSettings,o=v(null),l=v(!0),c=v(!0),r=v(""),i=v("");let d="";const _=re(P,220);q(e,()=>{i.value=f(e.value),d=i.value,q(i,_)},{immediate:!0});async function I(){const C=o.value;C.blur(),e.value=JSON.parse(i.value),a.value=B.compileRuleStrings(e.value),d=i.value,C.classList.add("btn-outline-success"),await Q(800),l.value=!0,C.classList.remove("btn-outline-success")}function P(){if(o.value){if(i.value===d){l.value=!0,c.value=!0,r.value="";return}c.value=!1,l.value=!1;try{const u=JSON.parse(i.value);if(!Array.isArray(u)){r.value="Not an array";return}if(u.length!==u.flat().length){r.value="Array is not flat";return}if(!u.every(ie)){r.value="Array is not string one";return}if(!ue(u)){r.value="Wrong data in the rule string array";return}c.value=!0,r.value=""}catch{r.value="Incorrect JSON"}}}function f(C){let u=JSON.stringify(C,null,4);return u=u.replaceAll('    "site','"site'),u}return(C,u)=>(m(),b("div",Zn,[N(s("textarea",{spellcheck:"false",id:"editor",class:"form-control","onUpdate:modelValue":u[0]||(u[0]=h=>i.value=h)},null,512),[[z,i.value]]),(m(),O(Tt,{to:C.btnInsertPlace},[s("button",{ref_key:"saveBtn",ref:o,id:"save",class:A(["btn btn-outline-primary",{disabled:l.value||!c.value}]),onClick:I},"Save",2)],8,["to"])),s("span",ts,T(r.value),1)]))}}),Pt=U(es,[["__scopeId","data-v-15078068"]]),ns=n=>(K("data-v-b968c8ad"),n=n(),X(),n),ss={class:"popup-content"},os={class:"p-1 flex"},as=ns(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Configs")],-1)),ls={class:"btn-group"},rs={key:0,class:"ready-required"},is={key:0},us={key:1},cs=S({__name:"PopupUrlCleaner",setup(n){const t=v(null),e=v("cleaner"),a=v(null),o=v(!1);at(()=>{a.value&&(o.value=!0)});const{useCleaner:l,useOriginer:c}=st;function r(i){st[i].value=!st[i].value}return(i,d)=>N((m(),O(Kt,{"data-slot-component":"PopupUrlCleaner",id:"url-cleaner",header:t.value},{default:nt(()=>[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Url Magic Transforms",512),s("div",ss,[s("div",os,[as,s("span",ls,[s("button",{title:"Rule String Array based config",class:A(["btn btn-outline-primary",{active:e.value==="cleaner","turned-off":!p(l)}]),onClick:d[0]||(d[0]=_=>e.value="cleaner"),onContextmenu:d[1]||(d[1]=lt(()=>r("useCleaner"),["prevent"]))},"Url Cleaner",34),s("button",{title:"Rule String Array based config",class:A(["btn btn-outline-primary",{active:e.value==="originer","turned-off":!p(c)}]),onClick:d[2]||(d[2]=_=>e.value="originer"),onContextmenu:d[3]||(d[3]=lt(()=>r("useOriginer"),["prevent"]))},"Url Origin",34)]),s("span",{style:{"margin-left":"auto"},class:"btn-insert-place",ref_key:"btnInsertPlace",ref:a},null,512)]),o.value?(m(),b("div",rs,[e.value==="cleaner"?(m(),b("div",is,[L(Pt,{ucSettings:p(mt),btnInsertPlace:a.value},null,8,["ucSettings","btnInsertPlace"])])):(m(),b("div",us,[L(Pt,{ucSettings:p(vt),btnInsertPlace:a.value},null,8,["ucSettings","btnInsertPlace"])]))])):E("",!0)])]),_:1},8,["header"])),[[ee,o.value]])}}),ds=U(cs,[["__scopeId","data-v-b968c8ad"]]),ps={class:"popup-content"},fs={class:"btn-group p-1 container"},ms=["disabled"],vs=["disabled"],gs=["disabled"],_s={class:"div-wrap"},hs={class:"p-1 pt-0 col-12"},ys={class:"input-group"},bs=s("span",{class:"input-group-text col-3"},"Delay",-1),Cs={class:"div-wrap"},$s={class:"p-1 pt-0 col-12"},ws={class:"input-group"},Ts=s("span",{class:"input-group-text col-3"},"Count",-1),Ss=S({__name:"PopupAutoClicker",setup(n){const t=v(null),{delay:e,count:a}=ke,o=v("ready"),l=v(0);let c=new AbortController;q(o,()=>{o.value==="ready"?ft.value=F.value=!0:o.value==="started"?ft.value=F.value=!1:o.value==="paused"&&(ft.value=!0)});async function r(){console.log("startClicking");const f=[...document.querySelectorAll("a.url")],C=a.value===0?f.length:Math.min(f.length,a.value+l.value),u=C<f.length;for(o.value="started";l.value<C;){const h=f[l.value],y=h.closest('[data-component="UrlListItem"]');if(y.classList.add("hover"),await ce(e.value*1e3,c.signal),y.classList.remove("hover"),o.value==="started")l.value++,h.dispatchEvent(new MouseEvent("click")),await Q();else if(o.value==="paused"){o.value="paused";return}else if(o.value==="stopped"){l.value=0,o.value="ready";return}}u?o.value="paused":(l.value=0,o.value="ready")}function i(f){l.value===0&&(f="stopped"),o.value=f,c.abort(f),c=new AbortController}function d(){if(o.value==="started"){i("stopped");return}l.value=0,o.value="ready"}let _;function I(){if(k.value&&o.value!=="ready"){const f=k.value.elem.nextElementSibling;f&&(f.classList.add("highlighted-1"),_=f)}else{const f=document.querySelector('[data-component="UrlListItem"]');f&&(f.classList.add("highlighted-1"),_=f)}}function P(){_&&(_.classList.remove("highlighted-1"),_=null)}return(f,C)=>(m(),O(Kt,{"data-slot-component":"PopupAutoClicker",id:"auto-clicker",header:t.value},{default:nt(()=>[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Auto Clicker",512),s("div",ps,[s("div",fs,[s("button",{class:"btn btn-primary col-4",onClick:r,onPointerenter:I,onPointerleave:P,disabled:!(o.value==="ready"||o.value==="paused")},T(o.value==="ready"||!l.value?"Start":"Next"),41,ms),s("button",{class:"btn btn-secondary col-4",disabled:o.value!=="started",onClick:C[0]||(C[0]=u=>i("paused"))},"Pause",8,vs),s("button",{class:"btn btn-secondary col-4",disabled:!l.value,onClick:d},T(o.value==="paused"?"Reset":"Stop"),9,gs)]),s("div",_s,[s("label",hs,[s("span",ys,[bs,N(s("input",{title:"Click delay (seconds)",class:"form-control",type:"number","onUpdate:modelValue":C[1]||(C[1]=u=>ot(e)?e.value=u:null)},null,512),[[z,p(e)]])])])]),s("div",Cs,[s("label",$s,[s("span",ws,[Ts,N(s("input",{title:"Count",class:"form-control",type:"number","onUpdate:modelValue":C[2]||(C[2]=u=>ot(a)?a.value=u:null)},null,512),[[z,p(a)]])])])])])]),_:1},8,["header"]))}}),Is={class:"selected-tags","data-component":"SelectedTags"},ks=["data-tag"],Us={class:"input-wrapper"},xs=["value"],Ls=S({__name:"SelectedTags",props:{entry:{},modelValue:{}},emits:["update:modelValue","tabPressed"],setup(n,{emit:t}){const e=n,a=t;function o(f){const u=f.target.dataset.tag;u&&e.entry?.delTag(u)}const l=v(null),r=document.createElement("canvas").getContext("2d");Ot(()=>{l.value&&(r.font=window.getComputedStyle(l.value).font)});function i(){if(!l.value)return;const f=r.measureText(l.value.value).width;l.value.style.width=f+6+"px"}function d(){l.value&&(l.value.selectionStart=l.value.selectionEnd,l.value.focus())}function _(){l.value?.select()}function I(f){a("update:modelValue",f.target.value)}function P(f){console.log(f),f.code==="Tab"&&(f.preventDefault(),a("tabPressed"))}return(f,C)=>(m(),b("div",Is,[s("div",{class:"tag-master",onClick:o},[(m(!0),b(rt,null,_t(f.entry.tags,u=>(m(),b("div",{class:"tag","data-tag":u},T(u),9,ks))),256))]),s("span",{class:"label",onDblclick:_,onClick:d},[s("span",Us,[s("input",ne({type:"text",ref_key:"tagInput",ref:l,value:f.modelValue},se({input:[i,I]}),{onKeydown:P}),null,16,xs)])],32)]))}}),Es=U(Ls,[["__scopeId","data-v-40fab9e9"]]),Ps=["data-tag"],Rs=S({__name:"SuggestedTag",props:{tagWrap:{}},setup(n){const t=n,{entry:e,tag:a}=t.tagWrap,o=w(()=>!!e.tags?.includes(a));function l(){o.value?e.delTag(a):e.addTag(a)}return(c,r)=>(m(),b("div",{class:A(["tag",{selected:o.value}]),onClick:l,"data-tag":c.tagWrap.tag,"data-component":"SuggestedTag"},T(c.tagWrap.tag),11,Ps))}}),Os=U(Rs,[["__scopeId","data-v-5d66b337"]]);function Ms(){return JSON.parse(localStorage.getItem("href_lister_all_tags")||"[]")}const As=v(Ms()),Ds={class:"popup-content"},Vs={class:"modal-content"},Ns={class:"modal-header"},qs={class:"modal-title"},Bs={class:"modal-body"},js={class:"tags selected-tags-group"},Fs={class:"tags all-tags-group"},Ws={class:"tag-master"},Js=S({__name:"UrlEntryTagsEditPopup",setup(n){const t=v(""),e=M,a=w(()=>As.value.map(r=>({tag:r,entry:e.value}))),o=w(()=>{const r=[],i=[];for(const d of a.value){const _=d.tag.indexOf(t.value);_!==-1&&(_===0?r.push(d):i.push(d))}return[r,i].flat()});function l(){t.value=""}function c(r){r.currentTarget===r.target&&(M.value=null)}return(r,i)=>(m(),O(Tt,{to:"body"},[p(M)?(m(),b("div",{key:0,class:"modal tags-edit-popup",onPointerdown:c,"data-component":"URLsInfoLine"},[s("div",Ds,[s("div",Vs,[s("div",Ns,[s("h5",qs,T(p(M).url),1)]),s("div",Bs,[s("div",js,[L(Es,{entry:p(M),modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=d=>t.value=d),onTabPressed:l},null,8,["entry","modelValue"])]),s("div",Fs,[s("div",Ws,[(m(!0),b(rt,null,_t(o.value,d=>(m(),O(Os,{"tag-wrap":d},null,8,["tag-wrap"]))),256))])])])])])],32)):E("",!0)]))}}),Ys=U(Js,[["__scopeId","data-v-7874f8fe"]]),Hs={"data-component":"Main"},zs=s("hr",null,null,-1),Ks=s("hr",null,null,-1),Xs=s("hr",null,null,-1),Qs=s("hr",null,null,-1),Gs=S({__name:"Main",setup(n){return(t,e)=>(m(),b("div",Hs,[zs,L(Ce),Ks,L(Ge),Xs,L(_n),Qs,L(Nn),p(M)?(m(),O(Ys,{key:0})):E("",!0),p(R)?(m(),O(bt,{key:1},{default:nt(()=>[L(Hn)]),_:1})):E("",!0),p(J)?(m(),O(bt,{key:2},{default:nt(()=>[L(Ss)]),_:1})):E("",!0),p(Y)?(m(),O(bt,{key:3},{default:nt(()=>[L(ds)]),_:1})):E("",!0)]))}}),Zs=n=>(K("data-v-679e969c"),n=n(),X(),n),to=Zs(()=>s("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister",target:"_blank"},[s("i",null,"i")],-1)),eo=S({__name:"App",setup(n){return(t,e)=>(m(),b(rt,null,[L(Gs),to],64))}}),no=U(eo,[["__scopeId","data-v-679e969c"]]);oe(no).mount("#app");
//# sourceMappingURL=index.js.map
