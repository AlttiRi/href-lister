import{ref as _,computed as w,defineComponent as k,openBlock as v,createElementBlock as y,createBaseVNode as s,withDirectives as j,vModelText as F,unref as d,isRef as Z,pushScopeId as J,popScopeId as Y,createBlock as R,renderSlot as It,Teleport as Ut,toRaw as tt,toRefs as xt,watch as W,watchEffect as ut,reactive as Ht,withModifiers as vt,toDisplayString as T,createCommentVNode as E,onUnmounted as Kt,triggerRef as Ct,Fragment as et,renderList as dt,onBeforeUnmount as Xt,normalizeClass as D,createVNode as I,onMounted as Lt,withCtx as G,mergeProps as zt,toHandlers as Gt,createApp as Qt}from"./vue-js.js";import{UrlCleaner as gt,sleep as H,hashString as Zt,sleepEx as te,formatDate as ee,throttle as ne,debounce as se,isString as oe,isUCRuleStringArray as ae}from"./util.js";import{createStore as Et,del as Pt,get as Rt,set as Mt,entries as At}from"./idb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=e(l);fetch(l.href,a)}})();const Ot={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},st=_(Ot.input_only),ot=_(Ot.input_ignore),le=w(()=>{let n=st.value.trim().split(/\s+/g).filter(l=>l),t=ot.value.trim().split(/\s+/g).filter(l=>l);n=n.map(l=>l.toLowerCase()),t=t.map(l=>l.toLowerCase());let e,o;return e=l=>n.some(a=>l.toLowerCase().includes(a)),o=l=>t.some(a=>l.toLowerCase().includes(a)),{matchOnly:e,matchIgnore:o,onlyParts:n,ignoreParts:t}}),re=w(()=>{const{matchOnly:n,matchIgnore:t,onlyParts:e}=le.value;return e.length?o=>n(o):o=>!t(o)}),Vt=n=>(J("data-v-40d2bd48"),n=n(),Y(),n),ie={class:"row row-cols-lg-3 g-3 align-items-center","data-comp":"Filters"},ue={class:"col-12"},ce={class:"input-group"},de=Vt(()=>s("span",{class:"input-group-text"},"Only",-1)),pe={class:"col-12"},fe={class:"input-group"},me=Vt(()=>s("span",{class:"input-group-text"},"Ignore",-1)),ve=k({__name:"Filters",setup(n){return(t,e)=>(v(),y("div",ie,[s("div",ue,[s("label",null,[s("span",ce,[de,j(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=o=>Z(st)?st.value=o:null)},null,512),[[F,d(st)]])])])]),s("div",pe,[s("label",null,[s("span",fe,[me,j(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=o=>Z(ot)?ot.value=o:null)},null,512),[[F,d(ot)]])])])])]))}}),U=(n,t)=>{const e=n.__vccOpts||n;for(const[o,l]of t)e[o]=l;return e},_e=U(ve,[["__scopeId","data-v-40d2bd48"]]),he={};function ge(n,t){return v(),R(Ut,{to:"body"},[It(n.$slots,"default")])}const ft=U(he,[["render",ge]]);function ye(n){const t=n.split(`
`).map(o=>o.trim()).filter(o=>o),e=[];for(const o of t){const[l,...a]=o.split(/\s+(#|\/\/)/),[i,...r]=l.trim().split(/\s+/);if(i.startsWith("http")){const u=mt(i);if(u&&r.every(f=>!mt(f))){e.push({url:u,inputComment:[...r,...a].join(" ")});continue}u&&e.push({url:u})}else r.unshift(i);for(const u of r){const f=mt(u);f&&e.push({url:f})}}return e}function mt(n){const t=n.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t?.groups)return t.groups.url}const at={createStore:Et,del:Pt,get:Rt,set:Mt,entries:At},lt=at.createStore("HrefListerUrlInfo","UrlInfo"),Dt=class Q{constructor(t,e,o){this.url=t,this.state=e,o&&(this.inputComment=o),e.visited&&(this.initialVisited=e.visited)}static async getInstance({url:t,inputComment:e}){let o=Q.stateMap.get(t);return o?new Q(t,o,e):(o=await at.get(t,lt),o===void 0&&(o={}),Q.stateMap.set(t,o),new Q(t,o,e))}isEquals(t){return t?this.state===t.state&&this.inputComment===t.inputComment:!1}get comment(){return this.state.comment}get visited(){return this.state.visited}get tags(){return this.state.tags}async setComment(t){this.state.comment=t,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(t){this.state.visited=t,await this.update()}async delVisited(){delete this.state.visited,await this.update()}async addTag(t){this.state.tags||(this.state.tags=[]),!this.state.tags.includes(t)&&(this.state.tags.push(t),await this.update())}async delTag(t){if(!this.state.tags)return;const e=this.state.tags.indexOf(t);e!=-1&&(this.state.tags.splice(e,1),this.state.tags.length===0&&delete this.state.tags,await this.update())}update(){return Object.keys(this.state).length?at.set(this.url,tt(this.state),lt):at.del(this.url,lt)}};Dt.stateMap=new Map;let Nt=Dt;Object.assign(globalThis,{idb:{createStore:Et,del:Pt,get:Rt,set:Mt,entries:At,urlInfoStore:lt},UrlEntry:Nt});const be=-1,x=_(""),L=_(null),P=_(null),rt=_(new Set),N=_(!1),q=_(!1),_t=_(!1),Ce=_(!1);async function $t(){_t.value=!0,N.value&&(N.value=!1,await H(),N.value=!0)}async function wt(){Ce.value=!0,q.value&&(q.value=!1,await H(),q.value=!0)}const V=_(!0),it=_(!0),S=_(null);function qt(n,t){const e=localStorage.getItem(n),o=Ht(e===null?t:JSON.parse(e));return W(o,()=>{localStorage.setItem(n,JSON.stringify(o))}),o}const $e=xt(qt("href-lister-clicker-settings",{delay:1,count:0})),ct=xt(qt("href-lister-url-cleaner-settings",{ucRuleStrings:[],ucCompiledRules:{}})),Bt=_(gt.fromRuleRecords(ct.ucCompiledRules.value));W(ct.ucCompiledRules,()=>{Bt.value=gt.fromRuleRecords(ct.ucCompiledRules.value)});const jt=_([]);ut(async()=>{const n=ye(x.value),t=[];for(const e of n)e.url=Bt.value.clean(e.url),t.push(await Nt.getInstance(e));jt.value=t});const Ft=w(()=>jt.value.filter(n=>re.value(n.url))),B=w(()=>{const n=Ft.value.map(t=>t.url);return globalThis.__urls=n,n});location.href==="http://localhost:5173/"&&(x.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
http://localhost:5173/#www
`);function we(n,t=100){const e=r=>`${r.length?'["'+r.join('", "')+'"]':"[]"}`;if(n.length<=t)return`/* ${n.length.toString().padStart(3)} */ ${e(n)},`;const o=r=>r.toString().length,l=Math.trunc(n.length/t),i=[`/* ${n.length.toString().padStart(1+o(n.length))+" ".repeat(3+o(l))} */`];for(let r=0;r<=l;r++){const u=n.slice(t*r,t+t*r),f=`(${r+1})`.padStart(2+o(l)),c=u.length.toString().padStart(1+o(n.length));i.push(`/* ${c} ${f} */ ${e(u)},`)}return i.join(`
`)}function Te(n){const t=Date.now(),e=Math.trunc((t-n)/1e3);if(e<60)return`${e} second${e>1?"s":""} ago`;if(e<60*60){const o=Math.trunc(e/60);return`${o} minute${o>1?"s":""} ago`}if(e<60*60*24){const o=Math.trunc(e/60%60).toString().padStart(2,"0");return`${Math.trunc(e/60/60)}:${o} ago`}return Math.trunc(e/60/60/24)+" days ago"}const Tt=["1st","2nd","3rd"];function ke(n){return n=Number(n),Tt[n]?Tt[n]:n+1+"th"}function Se(n,t,e){const o=document.createElement("a");o.setAttribute("download",t||"");const l=URL.createObjectURL(n);o.href=l+(e?"#"+e:""),o.click(),setTimeout(()=>URL.revokeObjectURL(l),15e3)}Object.assign(globalThis,{downloadBlob:Se});const pt=n=>(J("data-v-f4ca3244"),n=n(),Y(),n),Ie={class:"row row-cols-lg-3 g-3 align-items-end","data-comp":"InputControls"},Ue={class:"input col-12"},xe=pt(()=>s("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),Le=["disabled"],Ee={class:"input col-12"},Pe={class:"row"},Re={class:"line m-1"},Me=pt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1"},"Clipboard")],-1)),Ae=["disabled"],Oe=["disabled"],Ve={class:"line m-1"},De=pt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Controls")],-1)),Ne=["disabled"],qe={class:"input col-12",style:{"align-self":"end"}},Be={class:"row"},je={class:"line m-1"},Fe=pt(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Popups")],-1)),We=k({__name:"InputControls",setup(n){const t=new WeakMap;async function e(c){c.classList.add("btn-active");const p=H(150);t.set(c,p),await p,t.get(c)===p&&c.classList.remove("btn-active")}const o=_(null);function l(c){x.value="",o.value?.focus(),e(c.currentTarget)}function a(c){navigator.clipboard.writeText(B.value.join(" ")),e(c.currentTarget)}function i(c){c.preventDefault(),navigator.clipboard.writeText(B.value.join(`
`)),e(c.currentTarget)}function r(c){c.button===1&&(c.preventDefault(),navigator.clipboard.writeText(we(B.value)),e(c.currentTarget))}async function u(c){const{currentTarget:p}=c,b=await navigator.clipboard.readText();console.log("[clipboard] readText:",b),x.value&&!x.value.endsWith(`
`)&&(x.value+=`
`),x.value+=b,e(p)}async function f(c){const{currentTarget:p}=c,b=await navigator.clipboard.readText();console.log("[clipboard] readText:",b),x.value=b,e(p)}return(c,p)=>(v(),y("div",Ie,[s("div",Ue,[xe,j(s("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":p[0]||(p[0]=b=>Z(x)?x.value=b:null),ref_key:"textareaEl",ref:o,disabled:!d(V)},null,8,Le),[[F,d(x)]])]),s("div",Ee,[s("span",Pe,[s("span",Re,[Me,s("button",{class:"btn btn-outline-primary",onClick:f,disabled:!d(V)},"Replace",8,Ae),s("button",{class:"btn btn-outline-primary",onClick:u,disabled:!(d(V)||d(it))},"Append",8,Oe)]),s("span",Ve,[De,s("button",{class:"btn btn-outline-danger",onClick:l,disabled:!d(V)},"Clear",8,Ne),s("button",{class:"btn btn-primary",title:"Copy URLs",onClick:a,onContextmenu:i,onPointerdown:r},"Copy",32)])])]),s("div",qe,[s("span",Be,[s("span",je,[Fe,s("button",{class:"btn btn-outline-primary",title:"Toggle Auto Clicker Popup",onClick:p[1]||(p[1]=b=>N.value=!d(N)),onContextmenu:p[2]||(p[2]=vt((...b)=>d($t)&&d($t)(...b),["prevent"]))},"Auto Clicker",32),s("button",{class:"btn btn-outline-primary",title:"Toggle Url Cleaner Popup",onClick:p[3]||(p[3]=b=>q.value=!d(q)),onContextmenu:p[4]||(p[4]=vt((...b)=>d(wt)&&d(wt)(...b),["prevent"]))},"Url Cleaner",32)])])])]))}}),Je=U(We,[["__scopeId","data-v-f4ca3244"]]),kt=w(()=>{const n=[...new Set(B.value)].sort().join(" ");return Math.abs(Zt(n)).toString(16).slice(-8).padStart(8,"0").toUpperCase()}),z=w(()=>{const n=B.value,t=n.length,e=new Set(n).size;return{count:t,uniqueCount:e}}),A=w(()=>{let n=0;const t=new Set;for(const e of B.value)rt.value.has(e)&&(n++,t.add(e));return{count:n,uniqueCount:t.size}}),K=n=>(J("data-v-456c13e6"),n=n(),Y(),n),Ye={"data-comp":"URLsInfoLine"},He={title:"URLs count"},Ke={key:0,title:"URLs count (unique)"},Xe=K(()=>s("span",{class:"grey"}," — ",-1)),ze={title:"URLs hash"},Ge=K(()=>s("span",{class:"grey"},"#",-1)),Qe={class:"urls-hash"},Ze={key:0},tn=K(()=>s("span",{class:"grey"}," — ",-1)),en=K(()=>s("span",{class:"grey"},"[",-1)),nn={class:"clicked-count"},sn={title:"Clicked URLs count"},on={key:0,title:"Clicked URLs count (unique)"},an=K(()=>s("span",{class:"grey"},"]",-1)),ln=K(()=>s("span",{class:"grey"}," — ",-1)),rn=["title"],un=k({__name:"URLsInfoLine",setup(n){ut(()=>{const{count:a,uniqueCount:i}=z.value;if(!a){document.title="HrefLister";return}if(document.title=`HrefLister — ${t(a,i)} — #${kt.value}`,A.value.count){const{count:r,uniqueCount:u}=A.value;document.title=`${document.title} — [ ${t(r,u)} ]`}});function t(a,i){let r=a.toString();return a!==i&&(r=`${r} (${i})`),r}async function e(){if(!S.value)return;const a=S.value.elem;a.scrollIntoView({block:"center"}),a.classList.add("highlighted-2"),await H(800),a.classList.remove("highlighted-2")}function o(){S.value&&S.value.elem.classList.add("highlighted-1")}function l(){S.value&&S.value.elem.classList.remove("highlighted-1")}return(a,i)=>(v(),y("div",Ye,[s("span",null,[s("span",He,T(d(z).count),1),d(z).count!==d(z).uniqueCount?(v(),y("span",Ke," ("+T(d(z).uniqueCount)+")",1)):E("",!0)]),Xe,s("span",ze,[Ge,s("span",Qe,T(d(kt)),1)]),d(A).count?(v(),y("span",Ze,[tn,s("span",null,[en,s("span",nn,[s("span",sn,T(d(A).count),1),d(A).count!==d(A).uniqueCount?(v(),y("span",on," ("+T(d(A).uniqueCount)+")",1)):E("",!0)]),an])])):E("",!0),d(S)?(v(),y("span",{key:1,onClick:e,onPointerenter:o,onPointerleave:l},[ln,s("span",{class:"grey",title:`Last clicked URL index
`+d(S).entry.url},T(d(ke)(d(S).index)),9,rn)],32)):E("",!0)]))}}),cn=U(un,[["__scopeId","data-v-456c13e6"]]),dn={"data-component":"AutoClickPopup"},pn={class:"popup-content"},fn={class:"btn-group p-1 container"},mn=["disabled"],vn=["disabled"],_n=["disabled"],hn={class:"div-wrap"},gn={class:"p-1 pt-0 col-12"},yn={class:"input-group"},bn=s("span",{class:"input-group-text col-3"},"Delay",-1),Cn={class:"div-wrap"},$n={class:"p-1 pt-0 col-12"},wn={class:"input-group"},Tn=s("span",{class:"input-group-text col-3"},"Count",-1),kn=k({__name:"AutoClickPopup",props:["fancyPopupSlotProps"],setup(n){const t=n,{headerElem:e}=t.fancyPopupSlotProps,{delay:o,count:l}=$e,a=_("ready"),i=_(0);let r=new AbortController;W(a,()=>{a.value==="ready"?it.value=V.value=!0:a.value==="started"?it.value=V.value=!1:a.value==="paused"&&(it.value=!0)});async function u(){console.log("startClicking");const m=[...document.querySelectorAll("a.url")],C=l.value===0?m.length:Math.min(m.length,l.value+i.value),M=C<m.length;for(a.value="started";i.value<C;){const X=m[i.value],nt=X.closest('[data-comp="UrlListItem"]');if(nt.classList.add("hover"),await te(o.value*1e3,r.signal),nt.classList.remove("hover"),a.value==="started")i.value++,X.dispatchEvent(new MouseEvent("click")),await H();else if(a.value==="paused"){a.value="paused";return}else if(a.value==="stopped"){i.value=0,a.value="ready";return}}M?a.value="paused":(i.value=0,a.value="ready")}function f(m){i.value===0&&(m="stopped"),a.value=m,r.abort(m),r=new AbortController}function c(){if(a.value==="started"){f("stopped");return}i.value=0,a.value="ready"}let p;function b(){if(S.value&&a.value!=="ready"){const m=S.value.elem.nextElementSibling;m&&(m.classList.add("highlighted-1"),p=m)}else{const m=document.querySelector('[data-comp="UrlListItem"]');m&&(m.classList.add("highlighted-1"),p=m)}}function h(){p&&(p.classList.remove("highlighted-1"),p=null)}return(m,C)=>(v(),y("div",dn,[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:e},"Auto Clicker",512),s("div",pn,[s("div",fn,[s("button",{class:"btn btn-primary col-4",onClick:u,onPointerenter:b,onPointerleave:h,disabled:!(a.value==="ready"||a.value==="paused")},T(a.value==="ready"||!i.value?"Start":"Next"),41,mn),s("button",{class:"btn btn-secondary col-4",disabled:a.value!=="started",onClick:C[0]||(C[0]=M=>f("paused"))},"Pause",8,vn),s("button",{class:"btn btn-secondary col-4",disabled:!i.value,onClick:c},T(a.value==="paused"?"Reset":"Stop"),9,_n)]),s("div",hn,[s("label",gn,[s("span",yn,[bn,j(s("input",{title:"Click delay (seconds)",class:"form-control",type:"number","onUpdate:modelValue":C[1]||(C[1]=M=>Z(o)?o.value=M:null)},null,512),[[F,d(o)]])])])]),s("div",Cn,[s("label",$n,[s("span",wn,[Tn,j(s("input",{title:"Count",class:"form-control",type:"number","onUpdate:modelValue":C[2]||(C[2]=M=>Z(l)?l.value=M:null)},null,512),[[F,d(l)]])])])])])]))}}),yt=1e3*60,St=yt*10,ht=yt*60,Sn=ht*24;class In{constructor(t){this.timeRef=t,W(t,e=>{e>0&&this.setTimer()}),Kt(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let e;if(t<St)e=yt;else if(t<ht)e=St;else if(t<Sn)e=ht;else return;this.timerId=setTimeout(()=>{Ct(this.timeRef),this.setTimer()},e)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){Ct(this.timeRef),this.setTimer()}}const Un=n=>(J("data-v-47825c5d"),n=n(),Y(),n),xn={class:"tags"},Ln={class:"tag-master","data-comp":"EntryTags"},En=["data-tag"],Pn={key:0,class:"tag add-tag"},Rn=Un(()=>s("span",{class:"plus"},"+",-1)),Mn=[Rn],An=k({__name:"UrlListItemTags",props:{ue:{}},setup(n){const t=n;function e(){tt(P.value)===tt(t.ue)?P.value=null:P.value=t.ue,console.log(P.value)}return(o,l)=>(v(),y("div",{class:"tags-wrapper",onClick:e,"data-comp":"UrlListItemTags"},[s("div",xn,[s("div",Ln,[(v(!0),y(et,null,dt(o.ue.tags,a=>(v(),y("div",{class:"tag","data-tag":a},T(a),9,En))),256))])]),o.ue.tags?.length?E("",!0):(v(),y("div",Pn,Mn))]))}}),On=U(An,[["__scopeId","data-v-47825c5d"]]),Vn=["data-index"],Dn={class:"col-9 nowrap-text-ceil url url-cell"},Nn={class:"nowrap-text-ceil-content"},qn=["title"],Bn=["href","title"],jn={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},Fn=k({__name:"UrlListItem",props:{ue:{},index:{}},setup(n){const t=n,e=w(()=>t.ue.visited||be);function o(){t.ue.delVisited()}function l(){const g=Date.now();t.ue.setVisited(g)}function a(g){g.button===1&&(g.preventDefault(),o())}const i=w(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),r=w(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function u(){tt(L.value)===tt(t.ue)?L.value=null:L.value=t.ue}const f=_(),c=w(()=>rt.value.has(t.ue.url));function p(){rt.value.add(t.ue.url),l(),S.value={entry:t.ue,index:t.index,elem:f.value}}function b(g){g.button!==1||document.getRootNode().activeElement!==g.currentTarget||p()}function h(){rt.value.delete(t.ue.url)}const m=w(()=>{const g=S.value;return g?t.index===g.index&&t.ue.isEquals(g.entry):!1});Xt(()=>{m.value&&(S.value=null)});const C=new In(e);function M(){C.forceTrigger()}const X=ne(M,2e3),nt=w(()=>{let g=`№ ${t.index+1}.
`;return e.value<0?g+="never clicked":g+=bt(e.value),t.ue.initialVisited&&t.ue.initialVisited!==e.value?`${g}
${bt(t.ue.initialVisited)}`:g});function bt(g){return Te(g)+" — "+ee(g,"YYYY.MM.DD HH:mm:SS",!1)}const Jt=w(()=>Yt(e.value));function Yt(g){if(g<0)return"never-clicked";const O=Date.now(),$=Math.trunc((O-g)/1e3);return $<60?"minute-1":$<60*2?"minute-2":$<60*5?"minute-5":$<60*10?"minute-10":$<60*30?"minute-30":$<60*45?"minute-45":$<60*60?"minute-60":$<3600*2?"hour-2":$<3600*4?"hour-4":$<3600*8?"hour-8":$<3600*14?"hour-14":$<3600*24?"day-1":$<86400*7?"day-7":$<86400*30?"month-1":$<2592e3*3?"month-3":$<2592e3*6?"month-6":"long-ago"}return(g,O)=>(v(),y("tr",{onPointerenter:O[0]||(O[0]=(...$)=>d(X)&&d(X)(...$)),"data-index":g.index+1,class:D([{clicked:c.value,"last-clicked":m.value},"list-item-row"]),"data-comp":"UrlListItem",ref_key:"htmlCompRef",ref:f},[s("td",Dn,[s("span",Nn,[s("span",{class:D(["info-dot",{"has-comment":g.ue.inputComment,visited:e.value>0,[Jt.value]:!0}]),title:nt.value,onContextmenu:vt(h,["prevent"]),onPointerdown:a},null,42,qn),s("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:g.ue.url,title:g.ue.inputComment,onClick:p,onPointerup:b},T(g.ue.url),41,Bn)]),I(On,{class:"tags",ue:g.ue},null,8,["ue"])]),s("td",{class:D(["col-3 comment nowrap-text-ceil",{[i.value]:i.value}]),onDblclick:u},[s("span",jn,T(r.value||" "),1)],34)],42,Vn))}}),Wn=U(Fn,[["__scopeId","data-v-6b8480c3"]]),Jn={"data-comp":"UrlList"},Yn={class:"table table-borderless"},Hn=k({__name:"UrlList",setup(n){return(t,e)=>(v(),y("div",Jn,[s("table",Yn,[s("tbody",null,[(v(!0),y(et,null,dt(d(Ft),(o,l)=>(v(),R(Wn,{ue:o,index:l,key:l+o.url},null,8,["ue","index"]))),128))])])]))}}),Kn={class:"popup-content"},Xn={class:"modal-content"},zn={class:"modal-header"},Gn={class:"modal-title"},Qn={class:"modal-body"},Zn=["value"],ts=k({__name:"MessageEditPopup",setup(n){const t=w(()=>{const u=L.value;return u.comment===void 0?u.inputComment:u.comment});function e(u){u.currentTarget===u.target&&(L.value=null)}function o(u){u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),L.value=null)}const l=_(null);Lt(()=>{l.value?.focus()});function i(u){const f=u.currentTarget.value;L.value?.setComment(f)}function r(){L.value?.delComment()}return(u,f)=>d(L)?(v(),y("div",{key:0,class:"modal message-edit-popup","data-comp":"MessageEditPopup",onPointerdown:e},[s("div",Kn,[s("div",Xn,[s("div",zn,[s("h5",Gn,T(d(L).url),1),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e})]),s("div",Qn,[s("textarea",{rows:"5",value:t.value,onInput:i,ref_key:"textareaElem",ref:l,onKeydown:o},null,40,Zn)]),s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary",onClick:r},"Reset")])])])],32)):E("",!0)}}),es=U(ts,[["__scopeId","data-v-4d7ba857"]]);function ns(n,t){for(const[e,o]of Object.entries(t))n.style[e]=o}function ss(n,{handle:t,onStop:e,onMove:o,state:l}={}){const a=r=>{o?.(r),ns(n,r)};l&&(a(l),e?.(l));const i=t||n;i.style.userSelect="none",i.style.touchAction="none",n.style.position="absolute",i.addEventListener("pointerdown",r=>{r.preventDefault();const u=r.clientY-parseInt(getComputedStyle(n).top),f=r.clientX-parseInt(getComputedStyle(n).left);let c;function p(h){!i.hasPointerCapture(h.pointerId)&&i.setPointerCapture(h.pointerId),c={top:h.clientY-u+"px",left:h.clientX-f+"px"},a(c)}function b(){removeEventListener("pointermove",p),c&&e?.(c)}addEventListener("pointermove",p,{passive:!0}),addEventListener("pointerup",b,{once:!0})})}function os({id:n,onMove:t,onStop:e,reset:o,restore:l}){if(o&&n&&localStorage.removeItem(n),!l||!n)return{onMove:t,onStop:e};const a=localStorage.getItem(n);let i;a&&(i=JSON.parse(a));function r(f){localStorage.setItem(n,JSON.stringify(f))}let u;return e?u=function(f){e(f),r(f)}:u=r,{onMove:t,onStop:u,state:i}}const as={"data-component":"FancyPopup",class:"popup-root"},Wt=k({__name:"FancyPopup",props:{id:{},header:{}},setup(n){const t=n,e=_(),o=_(),l={headerElem:o};ut(()=>{t.header&&(o.value=t.header)});const a=ut(()=>{if(console.log(e.value,o.value),!e.value||!o.value)return;const c=e.value,p=o.value;ss(e.value,{handle:p,...os({restore:!0,id:`href-lister-${t.id}-popup-move-state`,reset:_t.value})}),p.addEventListener("pointerdown",b=>{c.focus()},{passive:!0}),_t.value=!1,a()}),i=_(!1);let r=0;function u(){i.value=!0,setTimeout(()=>clearTimeout(r))}function f(){r=setTimeout(()=>{i.value=!1},250)}return(c,p)=>(v(),y("div",as,[s("div",{class:D(["popup",{focus:i.value}]),tabindex:"-1",ref_key:"popupElem",ref:e,onFocusin:u,onFocusout:f},[It(c.$slots,"default",{fancyPopupSlotProps:l})],34)]))}}),ls=n=>(J("data-v-679838bb"),n=n(),Y(),n),rs={"data-comp":"UrlCleanerConfig",class:"url-cleaner"},is=ls(()=>s("h4",{title:"Rule String Array based config"},"Url Cleaner Config",-1)),us={class:"warning"},cs=k({__name:"UrlCleanerConfig",setup(n){const{ucRuleStrings:t,ucCompiledRules:e}=ct,o=_(null),l=_(!0),a=_(!0),i=_(""),r=_("");let u="";const f=se(p,220);W(t,()=>{r.value=b(t.value),u=r.value,W(r,f)},{immediate:!0});async function c(){const h=o.value;h.blur(),t.value=JSON.parse(r.value),e.value=gt.compileRuleStrings(t.value),u=r.value,h.classList.add("btn-outline-success"),await H(800),l.value=!0,h.classList.remove("btn-outline-success")}function p(){if(o.value){if(r.value===u){l.value=!0,a.value=!0,i.value="";return}a.value=!1,l.value=!1;try{const m=JSON.parse(r.value);if(!Array.isArray(m)){i.value="Not an array";return}if(m.length!==m.flat().length){i.value="Array is not flat";return}if(!m.every(oe)){i.value="Array is not string one";return}if(!ae(m)){i.value="Wrong data in the rule string array";return}a.value=!0,i.value=""}catch{i.value="Incorrect JSON"}}}function b(h){let m=JSON.stringify(h,null,4);return m=m.replaceAll('    "site','"site'),m}return(h,m)=>(v(),y("div",rs,[is,j(s("textarea",{spellcheck:"false",id:"editor",class:"form-control","onUpdate:modelValue":m[0]||(m[0]=C=>r.value=C)},null,512),[[F,r.value]]),s("button",{ref_key:"saveBtn",ref:o,id:"save",class:D(["btn btn-outline-primary",{disabled:l.value||!a.value}]),onClick:c},"Save",2),s("span",us,T(i.value),1)]))}}),ds=U(cs,[["__scopeId","data-v-679838bb"]]),ps={class:"popup-content"},fs=k({__name:"UrlCleanerPopup",setup(n){const t=_(null);return(e,o)=>(v(),R(Wt,{"data-slot-component":"UrlCleanerPopup",id:"url-cleaner",header:t.value},{default:G(()=>[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Url Cleaner",512),s("div",ps,[I(ds)])]),_:1},8,["header"]))}}),ms={class:"selected-tags","data-comp":"SelectedTags"},vs=["data-tag"],_s={class:"input-wrapper"},hs=["value"],gs=k({__name:"SelectedTags",props:{entry:{},modelValue:{}},emits:["update:modelValue","tabPressed"],setup(n,{emit:t}){const e=n,o=t;function l(h){const C=h.target.dataset.tag;C&&e.entry?.delTag(C)}const a=_(null),r=document.createElement("canvas").getContext("2d");Lt(()=>{a.value&&(r.font=window.getComputedStyle(a.value).font)});function u(){if(!a.value)return;const h=r.measureText(a.value.value).width;a.value.style.width=h+6+"px"}function f(){a.value&&(a.value.selectionStart=a.value.selectionEnd,a.value.focus())}function c(){a.value?.select()}function p(h){o("update:modelValue",h.target.value)}function b(h){console.log(h),h.code==="Tab"&&(h.preventDefault(),o("tabPressed"))}return(h,m)=>(v(),y("div",ms,[s("div",{class:"tag-master",onClick:l},[(v(!0),y(et,null,dt(h.entry.tags,C=>(v(),y("div",{class:"tag","data-tag":C},T(C),9,vs))),256))]),s("span",{class:"label",onDblclick:c,onClick:f},[s("span",_s,[s("input",zt({type:"text",ref_key:"tagInput",ref:a,value:h.modelValue},Gt({input:[u,p]}),{onKeydown:b}),null,16,hs)])],32)]))}}),ys=U(gs,[["__scopeId","data-v-9d97319f"]]),bs=["data-tag"],Cs=k({__name:"SuggestedTag",props:{tagWrap:{}},setup(n){const t=n,{entry:e,tag:o}=t.tagWrap,l=w(()=>!!e.tags?.includes(o));function a(){l.value?e.delTag(o):e.addTag(o)}return(i,r)=>(v(),y("div",{class:D(["tag",{selected:l.value}]),onClick:a,"data-tag":i.tagWrap.tag,"data-comp":"SuggestedTag"},T(i.tagWrap.tag),11,bs))}}),$s=U(Cs,[["__scopeId","data-v-40287b21"]]);function ws(){return JSON.parse(localStorage.getItem("href_lister_all_tags")||"[]")}const Ts=_(ws()),ks={class:"popup-content"},Ss={class:"modal-content"},Is={class:"modal-header"},Us={class:"modal-title"},xs={class:"modal-body"},Ls={class:"tags selected-tags-group"},Es={class:"tags all-tags-group"},Ps={class:"tag-master"},Rs=k({__name:"UrlEntryTagsEditPopup",setup(n){const t=_(""),e=P,o=w(()=>Ts.value.map(r=>({tag:r,entry:e.value}))),l=w(()=>{const r=[],u=[];for(const f of o.value){const c=f.tag.indexOf(t.value);c!==-1&&(c===0?r.push(f):u.push(f))}return[r,u].flat()});function a(){t.value=""}function i(r){r.currentTarget===r.target&&(P.value=null)}return(r,u)=>(v(),R(Ut,{to:"body"},[d(P)?(v(),y("div",{key:0,class:"modal tags-edit-popup",onPointerdown:i,"data-comp":"URLsInfoLine"},[s("div",ks,[s("div",Ss,[s("div",Is,[s("h5",Us,T(d(P).url),1)]),s("div",xs,[s("div",Ls,[I(ys,{entry:d(P),modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=f=>t.value=f),onTabPressed:a},null,8,["entry","modelValue"])]),s("div",Es,[s("div",Ps,[(v(!0),y(et,null,dt(l.value,f=>(v(),R($s,{"tag-wrap":f},null,8,["tag-wrap"]))),256))])])])])])],32)):E("",!0)]))}}),Ms=U(Rs,[["__scopeId","data-v-b9b3916d"]]),As={"data-component":"Main"},Os=s("hr",null,null,-1),Vs=s("hr",null,null,-1),Ds=s("hr",null,null,-1),Ns=s("hr",null,null,-1),qs=k({__name:"Main",setup(n){return(t,e)=>(v(),y("div",As,[Os,I(_e),Vs,I(Je),Ds,I(cn),Ns,I(Hn),d(P)?(v(),R(Ms,{key:0})):E("",!0),d(L)?(v(),R(ft,{key:1},{default:G(()=>[I(es)]),_:1})):E("",!0),d(N)?(v(),R(ft,{key:2},{default:G(()=>[I(Wt,{id:"auto-clicker"},{default:G(({fancyPopupSlotProps:o})=>[I(kn,{fancyPopupSlotProps:o},null,8,["fancyPopupSlotProps"])]),_:1})]),_:1})):E("",!0),d(q)?(v(),R(ft,{key:3},{default:G(()=>[I(fs)]),_:1})):E("",!0)]))}}),Bs=n=>(J("data-v-80fad6c5"),n=n(),Y(),n),js=Bs(()=>s("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister#keeplister",target:"_blank"},[s("i",null,"i")],-1)),Fs=k({__name:"App",setup(n){return(t,e)=>(v(),y(et,null,[I(qs),js],64))}}),Ws=U(Fs,[["__scopeId","data-v-80fad6c5"]]);Qt(Ws).mount("#app");
//# sourceMappingURL=index.js.map
