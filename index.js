import{r as C,c as h,d as w,o as y,a as T,b as s,w as P,v as N,u as m,i as R,e as L,f as Z,g as z,s as tt,h as mt,t as $,j as ft,p as et,k as nt,l as _t,m as ht,n as vt,q as J,x as gt,y as S,z as yt,A as B,F as q,B as bt,C as F,D as Ct,E as st,T as Tt,G as M,H as wt}from"./vendor.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function e(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=e(o);fetch(o.href,l)}})();const ot={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},k=C(ot.input_only),E=C(ot.input_ignore),xt=h(()=>{let n=k.value.trim().split(/\s+/g).filter(o=>o),t=E.value.trim().split(/\s+/g).filter(o=>o);n=n.map(o=>o.toLowerCase()),t=t.map(o=>o.toLowerCase());let e,r;return e=o=>n.some(l=>o.toLowerCase().includes(l)),r=o=>t.some(l=>o.toLowerCase().includes(l)),{matchOnly:e,matchIgnore:r,onlyParts:n,ignoreParts:t}}),$t=h(()=>{const{matchOnly:n,matchIgnore:t,onlyParts:e}=xt.value;return e.length?r=>n(r):r=>!t(r)}),It={class:"row row-cols-lg-3 g-3 align-items-center"},Mt={class:"col-12"},kt={style:{display:"contents"}},Et={class:"input-group"},Ut=s("span",{class:"input-group-text"},"Only",-1),Lt={class:"col-12"},Dt={style:{display:"contents"}},St={class:"input-group"},Ot=s("span",{class:"input-group-text"},"Ignore",-1),Vt=w({__name:"Filters",setup(n){return(t,e)=>(y(),T("div",It,[s("div",Mt,[s("label",kt,[s("span",Et,[Ut,P(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=r=>R(k)?k.value=r:null)},null,512),[[N,m(k)]])])])]),s("div",Lt,[s("label",Dt,[s("span",St,[Ot,P(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=r=>R(E)?E.value=r:null)},null,512),[[N,m(E)]])])])])]))}});function At(n){const t=n.split(`
`).map(r=>r.trim()).filter(r=>r),e=[];for(const r of t){const[o,...l]=r.split(/\s+(#|\/\/)/),[u,...c]=o.trim().split(/\s+/);if(u.startsWith("http")){const i=O(u);if(i&&c.every(_=>!O(_))){e.push({url:i,inputComment:[...c,...l].join(" ")});continue}i&&e.push({url:i})}else c.unshift(u);for(const i of c){const _=O(i);_&&e.push({url:_})}}return e}function O(n){const t=n.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t!=null&&t.groups)return t.groups.url}const U=L("HrefListerUrlInfo","UrlInfo"),I=class{constructor(n,t,e){this.url=n,this.state=t,e&&(this.inputComment=e),t.visited&&(this.initialVisited=t.visited)}static async getInstance({url:n,inputComment:t}){let e=I.stateMap.get(n);return e?new I(n,e,t):(e=await z(n,U),e===void 0&&(e={}),I.stateMap.set(n,e),new I(n,e,t))}get comment(){return this.state.comment}get visited(){return this.state.visited}async setComment(n){this.state.comment=n,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(n){this.state.visited=n,await this.update()}async delVisited(){delete this.state.visited,await this.update()}update(){return Object.keys(this.state).length?tt(this.url,$(this.state),U):Z(this.url,U)}};let H=I;H.stateMap=new Map;const Pt=L("HrefListerComments","Comments"),Nt=L("HrefLister","Visits");Object.assign(globalThis,{idb:{createStore:L,del:Z,get:z,set:tt,entries:mt,commentsStore:Pt,visitsStore:Nt,urlInfoStore:U},UrlInfo:H});const Rt=-1,v=C(""),g=C(null),Q=C(null),V=C(new Set),rt=C([]);ft(async()=>{const n=At(v.value),t=[];for(const e of n)t.push(await H.getInstance(e));rt.value=t});const it=h(()=>rt.value.filter(n=>$t.value(n.url))),A=h(()=>it.value.map(n=>n.url));location.href==="http://localhost:5173/"&&(v.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
`);function Bt(n,t=50){let e=!1,r=!1,o,l;function u(){r?(setTimeout(u,t),n.apply(o,l)):e=!1,r=!1}return function(...c){e?(o=this,l=c,r=!0):(e=!0,setTimeout(u,t),n.apply(this,c))}}function jt(n,t=100){const e=c=>`${c.length?'["'+c.join('", "')+'"]':"[]"}`;if(n.length<=t)return`/* ${n.length.toString().padStart(3)} */ ${e(n)},`;const r=c=>c.toString().length,o=Math.trunc(n.length/t),u=[`/* ${n.length.toString().padStart(1+r(n.length))+" ".repeat(3+r(o))} */`];for(let c=0;c<=o;c++){const i=n.slice(t*c,t+t*c),_=`(${c+1})`.padStart(2+r(o)),a=i.length.toString().padStart(1+r(n.length));u.push(`/* ${a} ${_} */ ${e(i)},`)}return u.join(`
`)}function qt(n){const t=Date.now(),e=Math.trunc((t-n)/1e3);if(e<60)return`${e} second${e>1?"s":""} ago`;if(e<60*60){const r=Math.trunc(e/60);return`${r} minute${r>1?"s":""} ago`}if(e<60*60*24){const r=Math.trunc(e/60%60).toString().padStart(2,"0");return`${Math.trunc(e/60/60)}:${r} ago`}return Math.trunc(e/60/60/24)+" days ago"}const Y=n=>(et("data-v-ca1aa4d1"),n=n(),nt(),n),Ft={class:"row row-cols-lg-3 g-3 align-items-end"},Ht={class:"input col-12"},Yt=Y(()=>s("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),Wt={class:"input col-12"},Kt={class:"row"},Gt=Y(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-2"},"Clipboard")],-1)),Jt={class:".col m-1"},Qt=Y(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-2 text-center"},"Controls")],-1)),Xt=w({__name:"InputControls",setup(n){const t=new WeakMap;async function e(a){a.classList.add("btn-active");const f=_t(150);t.set(a,f),await f,t.get(a)===f&&a.classList.remove("btn-active")}const r=C(null);function o(a){var f;v.value="",(f=r.value)==null||f.focus(),e(a.currentTarget)}function l(a){navigator.clipboard.writeText(A.value.join(" ")),e(a.currentTarget)}function u(a){a.preventDefault(),navigator.clipboard.writeText(A.value.join(`
`)),e(a.currentTarget)}function c(a){a.button===1&&(a.preventDefault(),navigator.clipboard.writeText(jt(A.value)),e(a.currentTarget))}async function i(a){const{currentTarget:f}=a,b=await navigator.clipboard.readText();console.log("[clipboard] readText:",b),v.value&&!v.value.endsWith(`
`)&&(v.value+=`
`),v.value+=b,e(f)}async function _(a){const{currentTarget:f}=a,b=await navigator.clipboard.readText();console.log("[clipboard] readText:",b),v.value=b,e(f)}return(a,f)=>(y(),T("div",Ft,[s("div",Ht,[Yt,P(s("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":f[0]||(f[0]=b=>R(v)?v.value=b:null),ref_key:"textareaEl",ref:r},null,512),[[N,m(v)]])]),s("div",Wt,[s("span",Kt,[s("span",{class:".col m-1"},[Gt,s("button",{class:"btn btn-outline-primary me-1",onClick:_},"Replace"),s("button",{class:"btn btn-outline-primary me-1",onClick:i},"Append")]),s("span",Jt,[Qt,s("button",{class:"btn btn-outline-primary me-1",onClick:o},"Clear"),s("button",{class:"btn btn-primary me-1",title:"Copy URLs",onClick:l,onContextmenu:u,onPointerdown:c},"Copy",32)])])])]))}});const D=(n,t)=>{const e=n.__vccOpts||n;for(const[r,o]of t)e[r]=o;return e},Zt=D(Xt,[["__scopeId","data-v-ca1aa4d1"]]),W=1e3*60,X=W*10,j=W*60,zt=j*24;class te{constructor(t){this.timeRef=t,ht(t,e=>{e>0&&this.setTimer()}),vt(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let e;if(t<X)e=W;else if(t<j)e=X;else if(t<zt)e=j;else return;this.timerId=setTimeout(()=>{J(this.timeRef),this.setTimer()},e)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){J(this.timeRef),this.setTimer()}}const ee={class:"col-9 nowrap-text-ceil url"},ne={class:"nowrap-text-ceil-content"},se=["title","onContextmenu"],oe=["href","title"],re={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},ie=w({__name:"UrlListItem",props:{ue:null},setup(n){const t=n,e=h(()=>t.ue.visited||Rt);function r(){t.ue.delVisited()}function o(){const d=Date.now();t.ue.setVisited(d)}function l(d){d.button===1&&(d.preventDefault(),r())}const u=h(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),c=h(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function i(){$(g.value)===$(t.ue)?g.value=null:g.value=t.ue}const _=h(()=>V.value.has(t.ue.url));function a(){V.value.add(t.ue.url),o(),Q.value=$(t.ue)}function f(d){d.button!==1||document.getRootNode().activeElement!==d.currentTarget||a()}function b(){V.value.delete(t.ue.url)}const at=h(()=>$(Q.value)===$(t.ue)),lt=new te(e);function ct(){lt.forceTrigger()}const K=Bt(ct,2e3),ut=h(()=>{let d="";return e.value<0?d="never clicked":d=G(e.value),t.ue.initialVisited&&t.ue.initialVisited!==e.value?`${d}
${G(t.ue.initialVisited)}`:d});function G(d){return qt(d)+" — "+gt(d,"YYYY.MM.DD HH:mm:SS",!1)}const dt=h(()=>pt(e.value));function pt(d){if(d<0)return"never-clicked";const x=Date.now(),p=Math.trunc((x-d)/1e3);return p<60?"minute-1":p<60*2?"minute-2":p<60*5?"minute-5":p<60*10?"minute-10":p<60*30?"minute-30":p<60*45?"minute-45":p<60*60?"minute-60":p<3600*2?"hour-2":p<3600*4?"hour-4":p<3600*8?"hour-8":p<3600*14?"hour-14":p<3600*24?"day-1":p<86400*7?"day-7":p<86400*30?"month-1":p<2592e3*3?"month-3":p<2592e3*6?"month-6":"long-ago"}return(d,x)=>(y(),T("tr",{onPointerenter:x[0]||(x[0]=(...p)=>m(K)&&m(K)(...p)),class:S({clicked:m(_),"last-clicked":m(at)})},[s("td",ee,[s("span",ne,[s("span",{class:S(["info-dot",{["has-comment"]:n.ue.inputComment,visited:m(e)>0,[m(dt)]:!0}]),title:m(ut),onContextmenu:yt(b,["prevent"]),onPointerdown:l},null,42,se),s("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:n.ue.url,title:n.ue.inputComment,onClick:a,onPointerup:f},B(n.ue.url),41,oe)])]),s("td",{class:S(["col-3 comment nowrap-text-ceil",{[m(u)]:m(u)}]),onDblclick:i},[s("span",re,B(m(c)||" "),1)],34)],34))}});const ae=D(ie,[["__scopeId","data-v-37ed7dd8"]]),le={class:"table table-borderless"},ce=w({__name:"UrlList",setup(n){return(t,e)=>(y(),T("div",null,[s("table",le,[s("tbody",null,[(y(!0),T(q,null,bt(m(it),r=>(y(),F(ae,{ue:r},null,8,["ue"]))),256))])])]))}}),ue={class:"popup-content"},de={class:"modal-content"},pe={class:"modal-header"},me={class:"modal-title"},fe={class:"modal-body"},_e=["value"],he=w({__name:"MessageEditPopup",setup(n){const t=h(()=>{const i=g.value;return i.comment===void 0?i.inputComment:i.comment});function e(i){i.currentTarget===i.target&&(g.value=null)}function r(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),g.value=null)}const o=C(null);Ct(()=>{var i;(i=o.value)==null||i.focus()});function u(i){var a;const _=i.currentTarget.value;(a=g.value)==null||a.setComment(_)}function c(){var i;(i=g.value)==null||i.delComment()}return(i,_)=>(y(),F(Tt,{to:"body"},[m(g)?(y(),T("div",{key:0,class:"message-edit-popup modal",onPointerdown:e},[s("div",ue,[s("div",de,[s("div",pe,[s("h5",me,B(m(g).url),1),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e})]),s("div",fe,[s("textarea",{rows:"5",value:m(t),onInput:u,ref_key:"textareaElem",ref:o,onKeydown:r},null,40,_e)]),s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary",onClick:c},"Reset")])])])],32)):st("",!0)]))}});const ve=D(he,[["__scopeId","data-v-18fd4d81"]]),ge=s("hr",null,null,-1),ye=s("hr",null,null,-1),be=s("hr",null,null,-1),Ce=w({__name:"Main",setup(n){return(t,e)=>(y(),T(q,null,[ge,M(Vt),ye,M(Zt),be,M(ce),m(g)?(y(),F(ve,{key:0})):st("",!0)],64))}}),Te=n=>(et("data-v-80fad6c5"),n=n(),nt(),n),we=Te(()=>s("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister#keeplister",target:"_blank"},[s("i",null,"i")],-1)),xe=w({__name:"App",setup(n){return(t,e)=>(y(),T(q,null,[M(Ce),we],64))}});const $e=D(xe,[["__scopeId","data-v-80fad6c5"]]);wt($e).mount("#app");
//# sourceMappingURL=index.js.map
