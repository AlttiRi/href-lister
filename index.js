import{ref as v,computed as w,defineComponent as T,openBlock as m,createElementBlock as y,createBaseVNode as s,withDirectives as D,vModelText as J,unref as d,isRef as et,pushScopeId as Y,popScopeId as H,createBlock as O,renderSlot as Rt,Teleport as wt,toRaw as nt,toRefs as vt,watch as V,watchEffect as st,reactive as Qt,withModifiers as ot,normalizeClass as M,toDisplayString as S,createCommentVNode as x,onUnmounted as Gt,triggerRef as kt,Fragment as at,renderList as gt,onBeforeUnmount as Zt,createVNode as I,onMounted as Ot,vShow as te,withCtx as G,mergeProps as ee,toHandlers as ne,createApp as se}from"./vue.js";import{UrlCleaner as N,sleep as K,hashString as oe,sleepEx as ae,formatDate as le,throttle as re,debounce as ie,isString as ue,isUCRuleStringArray as ce}from"./util.js";import{createStore as Mt,del as At,get as Dt,set as Vt,entries as Nt}from"./idb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function e(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=e(l);fetch(l.href,a)}})();const qt={input_only:"",input_only_disabled:!1,input_ignore:"",input_ignore_disabled:!1,reverse_input_only:!1,case_sensitive:!1},rt=v(qt.input_only),it=v(qt.input_ignore),de=w(()=>{let n=rt.value.trim().split(/\s+/g).filter(l=>l),t=it.value.trim().split(/\s+/g).filter(l=>l);n=n.map(l=>l.toLowerCase()),t=t.map(l=>l.toLowerCase());let e,o;return e=l=>n.some(a=>l.toLowerCase().includes(a)),o=l=>t.some(a=>l.toLowerCase().includes(a)),{matchOnly:e,matchIgnore:o,onlyParts:n,ignoreParts:t}}),pe=w(()=>{const{matchOnly:n,matchIgnore:t,onlyParts:e}=de.value;return e.length?o=>n(o):o=>!t(o)}),Bt=n=>(Y("data-v-534dce17"),n=n(),H(),n),fe={class:"row row-cols-lg-3 g-3 align-items-center","data-component":"Filters"},me={class:"col-12"},ve={class:"input-group"},ge=Bt(()=>s("span",{class:"input-group-text"},"Only",-1)),_e={class:"col-12"},he={class:"input-group"},ye=Bt(()=>s("span",{class:"input-group-text"},"Ignore",-1)),be=T({__name:"Filters",setup(n){return(t,e)=>(m(),y("div",fe,[s("div",me,[s("label",null,[s("span",ve,[ge,D(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=o=>et(rt)?rt.value=o:null)},null,512),[[J,d(rt)]])])])]),s("div",_e,[s("label",null,[s("span",he,[ye,D(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=o=>et(it)?it.value=o:null)},null,512),[[J,d(it)]])])])])]))}}),U=(n,t)=>{const e=n.__vccOpts||n;for(const[o,l]of t)e[o]=l;return e},Ce=U(be,[["__scopeId","data-v-534dce17"]]),$e={};function we(n,t){return m(),O(wt,{to:"body"},[Rt(n.$slots,"default")])}const yt=U($e,[["render",we]]);function Se(n){const t=n.split(`
`).map(o=>o.trim()).filter(o=>o),e=[];for(const o of t){const[l,...a]=o.split(/\s+(#|\/\/)/),[u,...r]=l.trim().split(/\s+/);if(u.startsWith("http")){const i=bt(u);if(i&&r.every(c=>!bt(c))){e.push({url:i,inputComment:[...r,...a].join(" ")});continue}i&&e.push({url:i})}else r.unshift(u);for(const i of r){const c=bt(i);c&&e.push({url:c})}}return e}function bt(n){const t=n.match(/(['"]?)(?<url>https?:\/\/[^\s"]+)(\1)/);if(console.log(t),t?.groups)return t.groups.url}const ut={createStore:Mt,del:At,get:Dt,set:Vt,entries:Nt},ct=ut.createStore("HrefListerUrlInfo","UrlInfo"),jt=class Z{constructor({url:t,inputComment:e,urlOrigin:o},l){this.url=t,this.state=l,e&&(this.inputComment=e),l.visited&&(this.initialVisited=l.visited),o&&(this.urlOrigin=o)}static async getInstance(t){const e=t.urlOrigin||t.url;let o=Z.stateMap.get(e);return o?new Z(t,o):(o=await ut.get(e,ct),o===void 0&&(o={}),Z.stateMap.set(e,o),new Z(t,o))}isEquals(t){return t?this.state===t.state&&this.inputComment===t.inputComment:!1}get comment(){return this.state.comment}get visited(){return this.state.visited}get tags(){return this.state.tags}async setComment(t){this.state.comment=t,await this.update()}async delComment(){delete this.state.comment,await this.update()}async setVisited(t){this.state.visited=t,await this.update()}async delVisited(){delete this.state.visited,await this.update()}async addTag(t){this.state.tags||(this.state.tags=[]),!this.state.tags.includes(t)&&(this.state.tags.push(t),await this.update())}async delTag(t){if(!this.state.tags)return;const e=this.state.tags.indexOf(t);e!=-1&&(this.state.tags.splice(e,1),this.state.tags.length===0&&delete this.state.tags,await this.update())}update(){return Object.keys(this.state).length?ut.set(this.urlOrigin||this.url,nt(this.state),ct):ut.del(this.urlOrigin||this.url,ct)}};jt.stateMap=new Map;let Ft=jt;Object.assign(globalThis,{idb:{createStore:Mt,del:At,get:Dt,set:Vt,entries:Nt,urlInfoStore:ct},UrlEntry:Ft});const Te=-1,L=v(""),E=v(null),R=v(null),dt=v(new Set),j=v(!1),F=v(!1),Ct=v(!1),ke=v(!1);async function It(){Ct.value=!0,j.value&&(j.value=!1,await K(),j.value=!0)}async function Ut(){ke.value=!0,F.value&&(F.value=!1,await K(),F.value=!0)}const B=v(!0),pt=v(!0),k=v(null);function _t(n,t){const e=localStorage.getItem(n),o=Qt(e===null?typeof t=="function"?t():t:JSON.parse(e));return V(o,()=>{localStorage.setItem(n,JSON.stringify(o))}),o}const Ie=vt(_t("href-lister-clicker-settings",{delay:1,count:0})),ft=vt(_t("href-lister-url-cleaner-settings",()=>{const n=["site:youtube.com","trim-search-params:feature t si","site:t.umblr.com","filter-start:https://t.umblr.com/redirect","search-param:z","recursive","site:deviantart.com","trim-start:https://www.deviantart.com/users/outgoing?","decode-url","recursive"];return{ucRuleStrings:n,ucCompiledRules:N.compileRuleStrings(n)}})),Wt=v(N.fromRuleRecords(ft.ucCompiledRules.value));V(ft.ucCompiledRules,()=>{Wt.value=N.fromRuleRecords(ft.ucCompiledRules.value)});const mt=vt(_t("href-lister-url-origin-settings",()=>{const n=["site:cdn.discordapp.com","trim-search-params:ex is hm"];return{ucRuleStrings:n,ucCompiledRules:N.compileRuleStrings(n)}})),Jt=v(N.fromRuleRecords(mt.ucCompiledRules.value));V(mt.ucCompiledRules,()=>{Jt.value=N.fromRuleRecords(mt.ucCompiledRules.value)});const tt=vt(_t("href-lister-common-settings",{useCleaner:!0,useOriginer:!0})),{useCleaner:Ue,useOriginer:xe}=tt,Yt=v([]);st(async()=>{const n=Se(L.value),t=[];for(const e of n){e.url=Ue.value?Wt.value.clean(e.url):e.url;const o=xe.value?Jt.value.clean(e.url):e.url;o!==e.url&&(e.urlOrigin=o),t.push(await Ft.getInstance(e))}Yt.value=t});const Ht=w(()=>Yt.value.filter(n=>pe.value(n.url))),W=w(()=>{const n=Ht.value.map(t=>t.url);return globalThis.__urls=n,n});location.href==="http://localhost:5173/"&&(L.value=`http://localhost:5173/ asdf
http://localhost:5173/#qqq
http://localhost:5173/#qqq
http://localhost:5173/#www
https://www.youtube.com/watch?feature=player_embedded&v=Qwert123`);function Le(n,t=100){const e=r=>`${r.length?'["'+r.join('", "')+'"]':"[]"}`;if(n.length<=t)return`/* ${n.length.toString().padStart(3)} */ ${e(n)},`;const o=r=>r.toString().length,l=Math.trunc(n.length/t),u=[`/* ${n.length.toString().padStart(1+o(n.length))+" ".repeat(3+o(l))} */`];for(let r=0;r<=l;r++){const i=n.slice(t*r,t+t*r),c=`(${r+1})`.padStart(2+o(l)),b=i.length.toString().padStart(1+o(n.length));u.push(`/* ${b} ${c} */ ${e(i)},`)}return u.join(`
`)}function Ee(n){const t=Date.now(),e=Math.trunc((t-n)/1e3);if(e<60)return`${e} second${e>1?"s":""} ago`;if(e<60*60){const o=Math.trunc(e/60);return`${o} minute${o>1?"s":""} ago`}if(e<60*60*24){const o=Math.trunc(e/60%60).toString().padStart(2,"0");return`${Math.trunc(e/60/60)}:${o} ago`}return Math.trunc(e/60/60/24)+" days ago"}const xt=["1st","2nd","3rd"];function Pe(n){return n=Number(n),xt[n]?xt[n]:n+1+"th"}function Re(n,t,e){const o=document.createElement("a");o.setAttribute("download",t||"");const l=URL.createObjectURL(n);o.href=l+(e?"#"+e:""),o.click(),setTimeout(()=>URL.revokeObjectURL(l),15e3)}Object.assign(globalThis,{downloadBlob:Re});const ht=n=>(Y("data-v-73a0432d"),n=n(),H(),n),Oe={class:"row row-cols-lg-3 g-3 align-items-end","data-component":"InputControls"},Me={class:"input col-12"},Ae=ht(()=>s("label",{for:"urls-textarea",class:"fuck-off-lighthouse"},null,-1)),De=["disabled"],Ve={class:"input col-12"},Ne={class:"row"},qe={class:"line m-1"},Be=ht(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1"},"Clipboard")],-1)),je=["disabled"],Fe=["disabled"],We={class:"line m-1"},Je=ht(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Controls")],-1)),Ye=["disabled"],He={class:"input col-12",style:{"align-self":"end"}},Ke={class:"row"},Xe={class:"line m-1"},ze=ht(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Popups")],-1)),Qe=T({__name:"InputControls",setup(n){const t=new WeakMap;async function e(g){g.classList.add("btn-active");const f=K(150);t.set(g,f),await f,t.get(g)===f&&g.classList.remove("btn-active")}const o=v(null);function l(g){L.value="",o.value?.focus(),e(g.currentTarget)}function a(g){navigator.clipboard.writeText(W.value.join(" ")),e(g.currentTarget)}function u(g){g.preventDefault(),navigator.clipboard.writeText(W.value.join(`
`)),e(g.currentTarget)}function r(g){g.button===1&&(g.preventDefault(),navigator.clipboard.writeText(Le(W.value)),e(g.currentTarget))}async function i(g){const{currentTarget:f}=g,p=await navigator.clipboard.readText();console.log("[clipboard] readText:",p),L.value&&!L.value.endsWith(`
`)&&(L.value+=`
`),L.value+=p,e(f)}async function c(g){const{currentTarget:f}=g,p=await navigator.clipboard.readText();console.log("[clipboard] readText:",p),L.value=p,e(f)}const{useCleaner:b,useOriginer:C}=tt;return(g,f)=>(m(),y("div",Oe,[s("div",Me,[Ae,D(s("textarea",{id:"urls-textarea",spellcheck:"false","onUpdate:modelValue":f[0]||(f[0]=p=>et(L)?L.value=p:null),ref_key:"textareaEl",ref:o,disabled:!d(B)},null,8,De),[[J,d(L)]])]),s("div",Ve,[s("span",Ne,[s("span",qe,[Be,s("button",{class:"btn btn-outline-primary",onClick:c,disabled:!d(B)},"Replace",8,je),s("button",{class:"btn btn-outline-primary",onClick:i,disabled:!(d(B)||d(pt))},"Append",8,Fe)]),s("span",We,[Je,s("button",{class:"btn btn-outline-danger",onClick:l,disabled:!d(B)},"Clear",8,Ye),s("button",{class:"btn btn-primary",title:"Copy URLs",onClick:a,onContextmenu:u,onPointerdown:r},"Copy",32)])])]),s("div",He,[s("span",Ke,[s("span",Xe,[ze,s("button",{class:"btn btn-outline-primary",title:"Toggle Auto Clicker Popup",onClick:f[1]||(f[1]=p=>j.value=!d(j)),onContextmenu:f[2]||(f[2]=ot((...p)=>d(It)&&d(It)(...p),["prevent"]))},"Auto Clicker",32),s("button",{class:M(["btn btn-outline-primary",{"turned-off":!d(b)&&!d(C)}]),title:"Toggle Url Cleaner Popup",onClick:f[3]||(f[3]=p=>F.value=!d(F)),onContextmenu:f[4]||(f[4]=ot((...p)=>d(Ut)&&d(Ut)(...p),["prevent"]))},"Url Magic",34)])])])]))}}),Ge=U(Qe,[["__scopeId","data-v-73a0432d"]]),Lt=w(()=>{const n=[...new Set(W.value)].sort().join(" ");return Math.abs(oe(n)).toString(16).slice(-8).padStart(8,"0").toUpperCase()}),Q=w(()=>{const n=W.value,t=n.length,e=new Set(n).size;return{count:t,uniqueCount:e}}),A=w(()=>{let n=0;const t=new Set;for(const e of W.value)dt.value.has(e)&&(n++,t.add(e));return{count:n,uniqueCount:t.size}}),X=n=>(Y("data-v-5a4c63d0"),n=n(),H(),n),Ze={"data-component":"URLsInfoLine"},tn={title:"URLs count"},en={key:0,title:"URLs count (unique)"},nn=X(()=>s("span",{class:"grey"}," — ",-1)),sn={title:"URLs hash"},on=X(()=>s("span",{class:"grey"},"#",-1)),an={class:"urls-hash"},ln={key:0},rn=X(()=>s("span",{class:"grey"}," — ",-1)),un=X(()=>s("span",{class:"grey"},"[",-1)),cn={class:"clicked-count"},dn={title:"Clicked URLs count"},pn={key:0,title:"Clicked URLs count (unique)"},fn=X(()=>s("span",{class:"grey"},"]",-1)),mn=X(()=>s("span",{class:"grey"}," — ",-1)),vn=["title"],gn=T({__name:"URLsInfoLine",setup(n){st(()=>{const{count:a,uniqueCount:u}=Q.value;if(!a){document.title="HrefLister";return}if(document.title=`HrefLister — ${t(a,u)} — #${Lt.value}`,A.value.count){const{count:r,uniqueCount:i}=A.value;document.title=`${document.title} — [ ${t(r,i)} ]`}});function t(a,u){let r=a.toString();return a!==u&&(r=`${r} (${u})`),r}async function e(){if(!k.value)return;const a=k.value.elem;a.scrollIntoView({block:"center"}),a.classList.add("highlighted-2"),await K(800),a.classList.remove("highlighted-2")}function o(){k.value&&k.value.elem.classList.add("highlighted-1")}function l(){k.value&&k.value.elem.classList.remove("highlighted-1")}return(a,u)=>(m(),y("div",Ze,[s("span",null,[s("span",tn,S(d(Q).count),1),d(Q).count!==d(Q).uniqueCount?(m(),y("span",en," ("+S(d(Q).uniqueCount)+")",1)):x("",!0)]),nn,s("span",sn,[on,s("span",an,S(d(Lt)),1)]),d(A).count?(m(),y("span",ln,[rn,s("span",null,[un,s("span",cn,[s("span",dn,S(d(A).count),1),d(A).count!==d(A).uniqueCount?(m(),y("span",pn," ("+S(d(A).uniqueCount)+")",1)):x("",!0)]),fn])])):x("",!0),d(k)?(m(),y("span",{key:1,onClick:e,onPointerenter:o,onPointerleave:l},[mn,s("span",{class:"grey",title:`Last clicked URL index
`+d(k).entry.url},S(d(Pe)(d(k).index)),9,vn)],32)):x("",!0)]))}}),_n=U(gn,[["__scopeId","data-v-5a4c63d0"]]),hn={"data-component":"AutoClickPopup"},yn={class:"popup-content"},bn={class:"btn-group p-1 container"},Cn=["disabled"],$n=["disabled"],wn=["disabled"],Sn={class:"div-wrap"},Tn={class:"p-1 pt-0 col-12"},kn={class:"input-group"},In=s("span",{class:"input-group-text col-3"},"Delay",-1),Un={class:"div-wrap"},xn={class:"p-1 pt-0 col-12"},Ln={class:"input-group"},En=s("span",{class:"input-group-text col-3"},"Count",-1),Pn=T({__name:"AutoClickPopup",props:["fancyPopupSlotProps"],setup(n){const t=n,{headerElem:e}=t.fancyPopupSlotProps,{delay:o,count:l}=Ie,a=v("ready"),u=v(0);let r=new AbortController;V(a,()=>{a.value==="ready"?pt.value=B.value=!0:a.value==="started"?pt.value=B.value=!1:a.value==="paused"&&(pt.value=!0)});async function i(){console.log("startClicking");const p=[...document.querySelectorAll("a.url")],_=l.value===0?p.length:Math.min(p.length,l.value+u.value),P=_<p.length;for(a.value="started";u.value<_;){const z=p[u.value],lt=z.closest('[data-comp="UrlListItem"]');if(lt.classList.add("hover"),await ae(o.value*1e3,r.signal),lt.classList.remove("hover"),a.value==="started")u.value++,z.dispatchEvent(new MouseEvent("click")),await K();else if(a.value==="paused"){a.value="paused";return}else if(a.value==="stopped"){u.value=0,a.value="ready";return}}P?a.value="paused":(u.value=0,a.value="ready")}function c(p){u.value===0&&(p="stopped"),a.value=p,r.abort(p),r=new AbortController}function b(){if(a.value==="started"){c("stopped");return}u.value=0,a.value="ready"}let C;function g(){if(k.value&&a.value!=="ready"){const p=k.value.elem.nextElementSibling;p&&(p.classList.add("highlighted-1"),C=p)}else{const p=document.querySelector('[data-comp="UrlListItem"]');p&&(p.classList.add("highlighted-1"),C=p)}}function f(){C&&(C.classList.remove("highlighted-1"),C=null)}return(p,_)=>(m(),y("div",hn,[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:e},"Auto Clicker",512),s("div",yn,[s("div",bn,[s("button",{class:"btn btn-primary col-4",onClick:i,onPointerenter:g,onPointerleave:f,disabled:!(a.value==="ready"||a.value==="paused")},S(a.value==="ready"||!u.value?"Start":"Next"),41,Cn),s("button",{class:"btn btn-secondary col-4",disabled:a.value!=="started",onClick:_[0]||(_[0]=P=>c("paused"))},"Pause",8,$n),s("button",{class:"btn btn-secondary col-4",disabled:!u.value,onClick:b},S(a.value==="paused"?"Reset":"Stop"),9,wn)]),s("div",Sn,[s("label",Tn,[s("span",kn,[In,D(s("input",{title:"Click delay (seconds)",class:"form-control",type:"number","onUpdate:modelValue":_[1]||(_[1]=P=>et(o)?o.value=P:null)},null,512),[[J,d(o)]])])])]),s("div",Un,[s("label",xn,[s("span",Ln,[En,D(s("input",{title:"Count",class:"form-control",type:"number","onUpdate:modelValue":_[2]||(_[2]=P=>et(l)?l.value=P:null)},null,512),[[J,d(l)]])])])])])]))}}),St=1e3*60,Et=St*10,$t=St*60,Rn=$t*24;class On{constructor(t){this.timeRef=t,V(t,e=>{e>0&&this.setTimer()}),Gt(()=>{this.clearTimer()})}setTimer(){this.clearTimer();const t=Date.now()-this.timeRef.value;let e;if(t<Et)e=St;else if(t<$t)e=Et;else if(t<Rn)e=$t;else return;this.timerId=setTimeout(()=>{kt(this.timeRef),this.setTimer()},e)}clearTimer(){clearTimeout(this.timerId)}forceTrigger(){kt(this.timeRef),this.setTimer()}}const Mn=n=>(Y("data-v-f9c4189c"),n=n(),H(),n),An={class:"tags"},Dn={class:"tag-master","data-comp":"EntryTags"},Vn=["data-tag"],Nn={key:0,class:"tag add-tag"},qn=Mn(()=>s("span",{class:"plus"},"+",-1)),Bn=[qn],jn=T({__name:"UrlListItemTags",props:{ue:{}},setup(n){const t=n;function e(){nt(R.value)===nt(t.ue)?R.value=null:R.value=t.ue,console.log(R.value)}return(o,l)=>(m(),y("div",{class:"tags-wrapper",onClick:e,"data-component":"UrlListItemTags"},[s("div",An,[s("div",Dn,[(m(!0),y(at,null,gt(o.ue.tags,a=>(m(),y("div",{class:"tag","data-tag":a},S(a),9,Vn))),256))])]),o.ue.tags?.length?x("",!0):(m(),y("div",Nn,Bn))]))}}),Fn=U(jn,[["__scopeId","data-v-f9c4189c"]]),Wn=["data-index"],Jn={class:"col-9 nowrap-text-ceil url url-cell"},Yn={class:"nowrap-text-ceil-content"},Hn=["title"],Kn=["href","title","data-url-origin"],Xn={class:"comment-content nowrap-text-ceil-content no-dbl-click-select"},zn=T({__name:"UrlListItem",props:{ue:{},index:{}},setup(n){const t=n,e=w(()=>t.ue.visited||Te);function o(){t.ue.delVisited()}function l(){const h=Date.now();t.ue.setVisited(h)}function a(h){h.button===1&&(h.preventDefault(),o())}const u=w(()=>{if(t.ue.comment!==void 0){if(!t.ue.inputComment)return"comment-from-store";if(t.ue.comment!==t.ue.inputComment)return"comment-from-store-over"}return""}),r=w(()=>t.ue.comment!==void 0?t.ue.comment.trim():t.ue.inputComment);function i(){nt(E.value)===nt(t.ue)?E.value=null:E.value=t.ue}const c=v(),b=w(()=>dt.value.has(t.ue.url));function C(){dt.value.add(t.ue.url),l(),k.value={entry:t.ue,index:t.index,elem:c.value}}function g(h){h.button!==1||document.getRootNode().activeElement!==h.currentTarget||C()}function f(){dt.value.delete(t.ue.url)}const p=w(()=>{const h=k.value;return h?t.index===h.index&&t.ue.isEquals(h.entry):!1});Zt(()=>{p.value&&(k.value=null)});const _=new On(e);function P(){_.forceTrigger()}const z=re(P,2e3),lt=w(()=>{let h=`№ ${t.index+1}.
`;return e.value<0?h+="never clicked":h+=Tt(e.value),t.ue.initialVisited&&t.ue.initialVisited!==e.value?`${h}
${Tt(t.ue.initialVisited)}`:h});function Tt(h){return Ee(h)+" — "+le(h,"YYYY.MM.DD HH:mm:SS",!1)}const Xt=w(()=>zt(e.value));function zt(h){if(h<0)return"never-clicked";const q=Date.now(),$=Math.trunc((q-h)/1e3);return $<60?"minute-1":$<60*2?"minute-2":$<60*5?"minute-5":$<60*10?"minute-10":$<60*30?"minute-30":$<60*45?"minute-45":$<60*60?"minute-60":$<3600*2?"hour-2":$<3600*4?"hour-4":$<3600*8?"hour-8":$<3600*14?"hour-14":$<3600*24?"day-1":$<86400*7?"day-7":$<86400*30?"month-1":$<2592e3*3?"month-3":$<2592e3*6?"month-6":"long-ago"}return(h,q)=>(m(),y("tr",{onPointerenter:q[0]||(q[0]=(...$)=>d(z)&&d(z)(...$)),"data-index":h.index+1,class:M([{clicked:b.value,"last-clicked":p.value},"list-item-row"]),"data-component":"UrlListItem",ref_key:"htmlCompRef",ref:c},[s("td",Jn,[s("span",Yn,[s("span",{class:M(["info-dot",{"has-comment":h.ue.inputComment,visited:e.value>0,[Xt.value]:!0}]),title:lt.value,onContextmenu:ot(f,["prevent"]),onPointerdown:a},null,42,Hn),s("a",{class:"url link-primary",target:"_blank",rel:"noreferrer noopener",href:h.ue.url,title:h.ue.inputComment||h.ue.urlOrigin,"data-url-origin":h.ue.urlOrigin,onClick:C,onPointerup:g},S(h.ue.url),41,Kn)]),I(Fn,{class:"tags",ue:h.ue},null,8,["ue"])]),s("td",{class:M(["col-3 comment nowrap-text-ceil",{[u.value]:u.value}]),onDblclick:i},[s("span",Xn,S(r.value||" "),1)],34)],42,Wn))}}),Qn=U(zn,[["__scopeId","data-v-c707c6b2"]]),Gn={"data-component":"UrlList"},Zn={class:"table table-borderless"},ts=T({__name:"UrlList",setup(n){return(t,e)=>(m(),y("div",Gn,[s("table",Zn,[s("tbody",null,[(m(!0),y(at,null,gt(d(Ht),(o,l)=>(m(),O(Qn,{ue:o,index:l,key:l+o.url},null,8,["ue","index"]))),128))])])]))}}),es={class:"popup-content"},ns={class:"modal-content"},ss={class:"modal-header"},os={class:"modal-title"},as={class:"modal-body"},ls=["value"],rs=T({__name:"MessageEditPopup",setup(n){const t=w(()=>{const i=E.value;return i.comment===void 0?i.inputComment:i.comment});function e(i){i.currentTarget===i.target&&(E.value=null)}function o(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),E.value=null)}const l=v(null);Ot(()=>{l.value?.focus()});function u(i){const c=i.currentTarget.value;E.value?.setComment(c)}function r(){E.value?.delComment()}return(i,c)=>d(E)?(m(),y("div",{key:0,class:"modal message-edit-popup","data-component":"MessageEditPopup",onPointerdown:e},[s("div",es,[s("div",ns,[s("div",ss,[s("h5",os,S(d(E).url),1),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e})]),s("div",as,[s("textarea",{rows:"5",value:t.value,onInput:u,ref_key:"textareaElem",ref:l,onKeydown:o},null,40,ls)]),s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary",onClick:r},"Reset")])])])],32)):x("",!0)}}),is=U(rs,[["__scopeId","data-v-df3d2981"]]);function us(n,t){for(const[e,o]of Object.entries(t))n.style[e]=o}function cs(n,{handle:t,onStop:e,onMove:o,state:l}={}){const a=r=>{o?.(r),us(n,r)};l&&(a(l),e?.(l));const u=t||n;u.style.userSelect="none",u.style.touchAction="none",n.style.position="absolute",u.addEventListener("pointerdown",r=>{r.preventDefault();const i=r.clientY-parseInt(getComputedStyle(n).top),c=r.clientX-parseInt(getComputedStyle(n).left);let b;function C(f){!u.hasPointerCapture(f.pointerId)&&u.setPointerCapture(f.pointerId),b={top:f.clientY-i+"px",left:f.clientX-c+"px"},a(b)}function g(){removeEventListener("pointermove",C),b&&e?.(b)}addEventListener("pointermove",C,{passive:!0}),addEventListener("pointerup",g,{once:!0})})}function ds({id:n,onMove:t,onStop:e,reset:o,restore:l}){if(o&&n&&localStorage.removeItem(n),!l||!n)return{onMove:t,onStop:e};const a=localStorage.getItem(n);let u;a&&(u=JSON.parse(a));function r(c){localStorage.setItem(n,JSON.stringify(c))}let i;return e?i=function(c){e(c),r(c)}:i=r,{onMove:t,onStop:i,state:u}}const ps={"data-component":"FancyPopup",class:"popup-root"},Kt=T({__name:"FancyPopup",props:{id:{},header:{}},setup(n){const t=n,e=v(),o=v(),l={headerElem:o};st(()=>{t.header&&(o.value=t.header)});const a=st(()=>{if(!e.value||!o.value)return;const b=e.value,C=o.value;cs(e.value,{handle:C,...ds({restore:!0,id:`href-lister-${t.id}-popup-move-state`,reset:Ct.value})}),C.addEventListener("pointerdown",g=>{b.focus()},{passive:!0}),Ct.value=!1,a()}),u=v(!1);let r=0;function i(){u.value=!0,setTimeout(()=>clearTimeout(r))}function c(){r=setTimeout(()=>{u.value=!1},250)}return(b,C)=>(m(),y("div",ps,[s("div",{class:M(["popup",{focus:u.value}]),tabindex:"-1",ref_key:"popupElem",ref:e,onFocusin:i,onFocusout:c},[Rt(b.$slots,"default",{fancyPopupSlotProps:l})],34)]))}}),fs={"data-component":"UrlCleanerConfig",class:"url-cleaner"},ms={class:"warning"},vs=T({__name:"UrlCleanerConfig",props:{ucSettings:{},btnInsertPlace:{}},setup(n){const t=n,{ucRuleStrings:e,ucCompiledRules:o}=t.ucSettings,l=v(null),a=v(!0),u=v(!0),r=v(""),i=v("");let c="";const b=ie(g,220);V(e,()=>{i.value=f(e.value),c=i.value,V(i,b)},{immediate:!0});async function C(){const p=l.value;p.blur(),e.value=JSON.parse(i.value),o.value=N.compileRuleStrings(e.value),c=i.value,p.classList.add("btn-outline-success"),await K(800),a.value=!0,p.classList.remove("btn-outline-success")}function g(){if(l.value){if(i.value===c){a.value=!0,u.value=!0,r.value="";return}u.value=!1,a.value=!1;try{const _=JSON.parse(i.value);if(!Array.isArray(_)){r.value="Not an array";return}if(_.length!==_.flat().length){r.value="Array is not flat";return}if(!_.every(ue)){r.value="Array is not string one";return}if(!ce(_)){r.value="Wrong data in the rule string array";return}u.value=!0,r.value=""}catch{r.value="Incorrect JSON"}}}function f(p){let _=JSON.stringify(p,null,4);return _=_.replaceAll('    "site','"site'),_}return(p,_)=>(m(),y("div",fs,[D(s("textarea",{spellcheck:"false",id:"editor",class:"form-control","onUpdate:modelValue":_[0]||(_[0]=P=>i.value=P)},null,512),[[J,i.value]]),(m(),O(wt,{to:p.btnInsertPlace},[s("button",{ref_key:"saveBtn",ref:l,id:"save",class:M(["btn btn-outline-primary",{disabled:a.value||!u.value}]),onClick:C},"Save",2)],8,["to"])),s("span",ms,S(r.value),1)]))}}),Pt=U(vs,[["__scopeId","data-v-3a85e8c2"]]),gs=n=>(Y("data-v-3131c85d"),n=n(),H(),n),_s={class:"popup-content"},hs={class:"p-1 flex"},ys=gs(()=>s("span",{class:"btn-group"},[s("span",{class:"input-group-text me-1 text-center"},"Configs")],-1)),bs={class:"btn-group"},Cs={key:0,class:"ready-required"},$s={key:0},ws={key:1},Ss=T({__name:"UrlMagicPopup",setup(n){const t=v(null),e=v("cleaner"),o=v(null),l=v(!1);st(()=>{o.value&&(l.value=!0)});const{useCleaner:a,useOriginer:u}=tt;function r(i){tt[i].value=!tt[i].value}return(i,c)=>D((m(),O(Kt,{"data-slot-component":"UrlCleanerPopup",id:"url-cleaner",header:t.value},{default:G(()=>[s("div",{class:"popup-header p-1",ref_key:"headerElem",ref:t},"Url Magic Transforms",512),s("div",_s,[s("div",hs,[ys,s("span",bs,[s("button",{title:"Rule String Array based config",class:M(["btn btn-outline-primary",{active:e.value==="cleaner","turned-off":!d(a)}]),onClick:c[0]||(c[0]=b=>e.value="cleaner"),onContextmenu:c[1]||(c[1]=ot(()=>r("useCleaner"),["prevent"]))},"Url Cleaner",34),s("button",{title:"Rule String Array based config",class:M(["btn btn-outline-primary",{active:e.value==="originer","turned-off":!d(u)}]),onClick:c[2]||(c[2]=b=>e.value="originer"),onContextmenu:c[3]||(c[3]=ot(()=>r("useOriginer"),["prevent"]))},"Url Origin",34)]),s("span",{style:{"margin-left":"auto"},class:"btn-insert-place",ref_key:"btnInsertPlace",ref:o},null,512)]),l.value?(m(),y("div",Cs,[e.value==="cleaner"?(m(),y("div",$s,[I(Pt,{ucSettings:d(ft),btnInsertPlace:o.value},null,8,["ucSettings","btnInsertPlace"])])):(m(),y("div",ws,[I(Pt,{ucSettings:d(mt),btnInsertPlace:o.value},null,8,["ucSettings","btnInsertPlace"])]))])):x("",!0)])]),_:1},8,["header"])),[[te,l.value]])}}),Ts=U(Ss,[["__scopeId","data-v-3131c85d"]]),ks={class:"selected-tags","data-component":"SelectedTags"},Is=["data-tag"],Us={class:"input-wrapper"},xs=["value"],Ls=T({__name:"SelectedTags",props:{entry:{},modelValue:{}},emits:["update:modelValue","tabPressed"],setup(n,{emit:t}){const e=n,o=t;function l(f){const _=f.target.dataset.tag;_&&e.entry?.delTag(_)}const a=v(null),r=document.createElement("canvas").getContext("2d");Ot(()=>{a.value&&(r.font=window.getComputedStyle(a.value).font)});function i(){if(!a.value)return;const f=r.measureText(a.value.value).width;a.value.style.width=f+6+"px"}function c(){a.value&&(a.value.selectionStart=a.value.selectionEnd,a.value.focus())}function b(){a.value?.select()}function C(f){o("update:modelValue",f.target.value)}function g(f){console.log(f),f.code==="Tab"&&(f.preventDefault(),o("tabPressed"))}return(f,p)=>(m(),y("div",ks,[s("div",{class:"tag-master",onClick:l},[(m(!0),y(at,null,gt(f.entry.tags,_=>(m(),y("div",{class:"tag","data-tag":_},S(_),9,Is))),256))]),s("span",{class:"label",onDblclick:b,onClick:c},[s("span",Us,[s("input",ee({type:"text",ref_key:"tagInput",ref:a,value:f.modelValue},ne({input:[i,C]}),{onKeydown:g}),null,16,xs)])],32)]))}}),Es=U(Ls,[["__scopeId","data-v-561f126c"]]),Ps=["data-tag"],Rs=T({__name:"SuggestedTag",props:{tagWrap:{}},setup(n){const t=n,{entry:e,tag:o}=t.tagWrap,l=w(()=>!!e.tags?.includes(o));function a(){l.value?e.delTag(o):e.addTag(o)}return(u,r)=>(m(),y("div",{class:M(["tag",{selected:l.value}]),onClick:a,"data-tag":u.tagWrap.tag,"data-component":"SuggestedTag"},S(u.tagWrap.tag),11,Ps))}}),Os=U(Rs,[["__scopeId","data-v-6a5a5388"]]);function Ms(){return JSON.parse(localStorage.getItem("href_lister_all_tags")||"[]")}const As=v(Ms()),Ds={class:"popup-content"},Vs={class:"modal-content"},Ns={class:"modal-header"},qs={class:"modal-title"},Bs={class:"modal-body"},js={class:"tags selected-tags-group"},Fs={class:"tags all-tags-group"},Ws={class:"tag-master"},Js=T({__name:"UrlEntryTagsEditPopup",setup(n){const t=v(""),e=R,o=w(()=>As.value.map(r=>({tag:r,entry:e.value}))),l=w(()=>{const r=[],i=[];for(const c of o.value){const b=c.tag.indexOf(t.value);b!==-1&&(b===0?r.push(c):i.push(c))}return[r,i].flat()});function a(){t.value=""}function u(r){r.currentTarget===r.target&&(R.value=null)}return(r,i)=>(m(),O(wt,{to:"body"},[d(R)?(m(),y("div",{key:0,class:"modal tags-edit-popup",onPointerdown:u,"data-component":"URLsInfoLine"},[s("div",Ds,[s("div",Vs,[s("div",Ns,[s("h5",qs,S(d(R).url),1)]),s("div",Bs,[s("div",js,[I(Es,{entry:d(R),modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=c=>t.value=c),onTabPressed:a},null,8,["entry","modelValue"])]),s("div",Fs,[s("div",Ws,[(m(!0),y(at,null,gt(l.value,c=>(m(),O(Os,{"tag-wrap":c},null,8,["tag-wrap"]))),256))])])])])])],32)):x("",!0)]))}}),Ys=U(Js,[["__scopeId","data-v-da70caf4"]]),Hs={"data-component":"Main"},Ks=s("hr",null,null,-1),Xs=s("hr",null,null,-1),zs=s("hr",null,null,-1),Qs=s("hr",null,null,-1),Gs=T({__name:"Main",setup(n){return(t,e)=>(m(),y("div",Hs,[Ks,I(Ce),Xs,I(Ge),zs,I(_n),Qs,I(ts),d(R)?(m(),O(Ys,{key:0})):x("",!0),d(E)?(m(),O(yt,{key:1},{default:G(()=>[I(is)]),_:1})):x("",!0),d(j)?(m(),O(yt,{key:2},{default:G(()=>[I(Kt,{id:"auto-clicker"},{default:G(({fancyPopupSlotProps:o})=>[I(Pn,{fancyPopupSlotProps:o},null,8,["fancyPopupSlotProps"])]),_:1})]),_:1})):x("",!0),d(F)?(m(),O(yt,{key:3},{default:G(()=>[I(Ts)]),_:1})):x("",!0)]))}}),Zs=n=>(Y("data-v-679e969c"),n=n(),H(),n),to=Zs(()=>s("a",{class:"readme",title:"Open Readme",href:"https://github.com/AlttiRi/href-lister",target:"_blank"},[s("i",null,"i")],-1)),eo=T({__name:"App",setup(n){return(t,e)=>(m(),y(at,null,[I(Gs),to],64))}}),no=U(eo,[["__scopeId","data-v-679e969c"]]);se(no).mount("#app");
//# sourceMappingURL=index.js.map
